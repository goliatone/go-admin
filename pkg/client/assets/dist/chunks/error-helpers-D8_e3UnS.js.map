{"version":3,"file":"error-helpers-D8_e3UnS.js","sources":["../../src/toast/toast-manager.ts","../../src/toast/error-helpers.ts"],"sourcesContent":["import type { ToastNotifier, ToastOptions, ConfirmOptions } from './types.js';\n\ntype ToastPosition = 'top-right' | 'top-center' | 'bottom-right' | 'bottom-center';\n\ninterface ToastManagerOptions {\n  position?: ToastPosition;\n}\n\n/**\n * Toast notification manager\n * Manages toast notifications with auto-dismiss and stacking\n */\nexport class ToastManager implements ToastNotifier {\n  private container: HTMLElement;\n  private toasts: Map<string, HTMLElement> = new Map();\n  private position: ToastPosition;\n\n  constructor(options: ToastManagerOptions = {}) {\n    this.position = options.position || 'top-right';\n    this.container = this.getOrCreateContainer();\n    this.applyContainerClasses(this.container);\n  }\n\n  private getOrCreateContainer(): HTMLElement {\n    const existing = document.getElementById('toast-container');\n    if (existing) return existing;\n\n    const container = document.createElement('div');\n    container.id = 'toast-container';\n    document.body.appendChild(container);\n    return container;\n  }\n\n  private applyContainerClasses(container: HTMLElement): void {\n    const positionClasses: Array<`toast-${ToastPosition}`> = [\n      'toast-top-right',\n      'toast-top-center',\n      'toast-bottom-right',\n      'toast-bottom-center',\n    ];\n\n    container.classList.add('toast-container');\n    positionClasses.forEach((cls) => container.classList.remove(cls));\n    container.classList.add(`toast-${this.position}`);\n  }\n\n  show(options: ToastOptions): void {\n    const id = `toast-${Date.now()}-${Math.random().toString(36).substring(2, 9)}`;\n    const toast = this.createToastElement(id, options);\n\n    this.container.appendChild(toast);\n    this.toasts.set(id, toast);\n\n    // Trigger enter animation\n    requestAnimationFrame(() => {\n      toast.classList.add('toast-enter-active');\n    });\n\n    // Auto-dismiss after duration (default 5 seconds)\n    const duration = options.duration !== undefined ? options.duration : 5000;\n    if (duration > 0) {\n      setTimeout(() => this.dismiss(id), duration);\n    }\n  }\n\n  success(message: string, duration?: number): void {\n    this.show({ message, type: 'success', duration, dismissible: true });\n  }\n\n  error(message: string, duration?: number): void {\n    this.show({ message, type: 'error', duration: duration || 0, dismissible: true });\n  }\n\n  warning(message: string, duration?: number): void {\n    this.show({ message, type: 'warning', duration, dismissible: true });\n  }\n\n  info(message: string, duration?: number): void {\n    this.show({ message, type: 'info', duration, dismissible: true });\n  }\n\n  async confirm(message: string, options: ConfirmOptions = {}): Promise<boolean> {\n    return new Promise((resolve) => {\n      const modal = this.createConfirmModal(message, options, resolve);\n      document.body.appendChild(modal);\n\n      // Animate in\n      requestAnimationFrame(() => {\n        modal.classList.add('confirm-modal-active');\n      });\n    });\n  }\n\n  private createToastElement(id: string, options: ToastOptions): HTMLElement {\n    const toast = document.createElement('div');\n    toast.className = `toast toast-${options.type}`;\n    toast.setAttribute('data-toast-id', id);\n\n    const icon = this.getIconForType(options.type);\n\n    toast.innerHTML = `\n      <div class=\"toast-header\">\n        <div class=\"toast-header-left\">\n          <div class=\"toast-icon toast-icon-${options.type}\">\n            ${icon}\n          </div>\n          <svg class=\"toast-pin-icon w-4 h-4\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\n            <path stroke-linecap=\"round\" stroke-linejoin=\"round\" stroke-width=\"2\" d=\"M5 5a2 2 0 012-2h10a2 2 0 012 2v16l-7-3.5L5 21V5z\"/>\n          </svg>\n          <div class=\"toast-title\">${this.escapeHtml(options.title || this.getDefaultTitle(options.type))}</div>\n        </div>\n        ${options.dismissible !== false ? `\n          <button class=\"toast-dismiss\" aria-label=\"Dismiss\">\n            <svg class=\"w-4 h-4\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\n              <path stroke-linecap=\"round\" stroke-linejoin=\"round\" stroke-width=\"2\" d=\"M6 18L18 6M6 6l12 12\"/>\n            </svg>\n          </button>\n        ` : ''}\n      </div>\n      <div class=\"toast-content\">\n        <div class=\"toast-message\">${this.escapeHtml(options.message)}</div>\n      </div>\n    `;\n\n    // Bind dismiss button\n    if (options.dismissible !== false) {\n      const dismissBtn = toast.querySelector('.toast-dismiss');\n      if (dismissBtn) {\n        dismissBtn.addEventListener('click', () => this.dismiss(id));\n      }\n    }\n\n    return toast;\n  }\n\n  private createConfirmModal(message: string, options: ConfirmOptions, resolve: (value: boolean) => void): HTMLElement {\n    const overlay = document.createElement('div');\n    overlay.className = 'confirm-modal-overlay';\n\n    const modal = document.createElement('div');\n    modal.className = 'confirm-modal';\n\n    modal.innerHTML = `\n      <div class=\"confirm-modal-header\">\n        <h3 class=\"confirm-modal-title\">${this.escapeHtml(options.title || 'Confirm')}</h3>\n      </div>\n      <div class=\"confirm-modal-body\">\n        <p class=\"confirm-modal-message\">${this.escapeHtml(message)}</p>\n      </div>\n      <div class=\"confirm-modal-footer\">\n        <button class=\"confirm-modal-btn confirm-modal-btn-cancel\">\n          ${this.escapeHtml(options.cancelText || 'Cancel')}\n        </button>\n        <button class=\"confirm-modal-btn confirm-modal-btn-confirm\">\n          ${this.escapeHtml(options.confirmText || 'Confirm')}\n        </button>\n      </div>\n    `;\n\n    overlay.appendChild(modal);\n\n    let isDone = false;\n\n    const cleanup = () => {\n      overlay.classList.add('confirm-modal-leaving');\n      setTimeout(() => {\n        overlay.remove();\n      }, 200);\n    };\n\n    const escHandler = (e: KeyboardEvent) => {\n      if (e.key === 'Escape') {\n        finish(false);\n      }\n    };\n\n    const finish = (confirmed: boolean) => {\n      if (isDone) return;\n      isDone = true;\n      document.removeEventListener('keydown', escHandler);\n      cleanup();\n      resolve(confirmed);\n    };\n\n    // Bind buttons\n    const cancelBtn = modal.querySelector('.confirm-modal-btn-cancel');\n    const confirmBtn = modal.querySelector('.confirm-modal-btn-confirm');\n\n    if (cancelBtn) {\n      cancelBtn.addEventListener('click', () => {\n        finish(false);\n      });\n    }\n\n    if (confirmBtn) {\n      confirmBtn.addEventListener('click', () => {\n        finish(true);\n      });\n    }\n\n    // Click overlay to cancel\n    overlay.addEventListener('click', (e) => {\n      if (e.target === overlay) {\n        finish(false);\n      }\n    });\n\n    // ESC key to cancel\n    document.addEventListener('keydown', escHandler);\n\n    return overlay;\n  }\n\n  private dismiss(id: string): void {\n    const toast = this.toasts.get(id);\n    if (!toast) return;\n\n    toast.classList.remove('toast-enter-active');\n    toast.classList.add('toast-leave-active');\n\n    setTimeout(() => {\n      toast.remove();\n      this.toasts.delete(id);\n    }, 300); // Match CSS transition duration\n  }\n\n  private getDefaultTitle(type: string): string {\n    const titles: Record<string, string> = {\n      success: 'Success notification',\n      error: 'Error notification',\n      warning: 'Warning notification',\n      info: 'Informational notification'\n    };\n    return titles[type] || 'Notification';\n  }\n\n  private getIconForType(type: string): string {\n    const icons: Record<string, string> = {\n      success: `<svg class=\"w-5 h-5\" fill=\"currentColor\" viewBox=\"0 0 20 20\">\n        <path fill-rule=\"evenodd\" d=\"M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z\" clip-rule=\"evenodd\"/>\n      </svg>`,\n      error: `<svg class=\"w-5 h-5\" fill=\"currentColor\" viewBox=\"0 0 20 20\">\n        <path fill-rule=\"evenodd\" d=\"M10 18a8 8 0 100-16 8 8 0 000 16zM8.707 7.293a1 1 0 00-1.414 1.414L8.586 10l-1.293 1.293a1 1 0 101.414 1.414L10 11.414l1.293 1.293a1 1 0 001.414-1.414L11.414 10l1.293-1.293a1 1 0 00-1.414-1.414L10 8.586 8.707 7.293z\" clip-rule=\"evenodd\"/>\n      </svg>`,\n      warning: `<svg class=\"w-5 h-5\" fill=\"currentColor\" viewBox=\"0 0 20 20\">\n        <path fill-rule=\"evenodd\" d=\"M8.257 3.099c.765-1.36 2.722-1.36 3.486 0l5.58 9.92c.75 1.334-.213 2.98-1.742 2.98H4.42c-1.53 0-2.493-1.646-1.743-2.98l5.58-9.92zM11 13a1 1 0 11-2 0 1 1 0 012 0zm-1-8a1 1 0 00-1 1v3a1 1 0 002 0V6a1 1 0 00-1-1z\" clip-rule=\"evenodd\"/>\n      </svg>`,\n      info: `<svg class=\"w-5 h-5\" fill=\"currentColor\" viewBox=\"0 0 20 20\">\n        <path fill-rule=\"evenodd\" d=\"M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7-4a1 1 0 11-2 0 1 1 0 012 0zM9 9a1 1 0 000 2v3a1 1 0 001 1h1a1 1 0 100-2v-3a1 1 0 00-1-1H9z\" clip-rule=\"evenodd\"/>\n      </svg>`\n    };\n    return icons[type] || icons.info;\n  }\n\n  private escapeHtml(text: string): string {\n    const div = document.createElement('div');\n    div.textContent = text;\n    return div.innerHTML;\n  }\n}\n\n/**\n * Fallback notifier that uses native alert/confirm\n * Used when no ToastManager is configured (backwards compatibility)\n */\nexport class FallbackNotifier implements ToastNotifier {\n  show(options: ToastOptions): void {\n    const prefix = options.title ? `${options.title}: ` : '';\n    alert(prefix + options.message);\n  }\n\n  success(message: string): void {\n    alert(message);\n  }\n\n  error(message: string): void {\n    alert('Error: ' + message);\n  }\n\n  warning(message: string): void {\n    alert('Warning: ' + message);\n  }\n\n  info(message: string): void {\n    alert(message);\n  }\n\n  async confirm(message: string, options?: ConfirmOptions): Promise<boolean> {\n    const prefix = options?.title ? `${options.title}\\n\\n` : '';\n    return Promise.resolve(confirm(prefix + message));\n  }\n}\n","/**\n * Error message extraction helpers\n * Matches the repository's actual backend error formats\n */\n\n/**\n * Extract user-friendly error message from fetch Response\n * Handles multiple backend formats used in this repo:\n * 1. /admin/api/* format: {status, error} (quickstart/error_fiber.go)\n * 2. /admin/crud/* format: Problem+JSON {detail, title} (go-crud)\n * 3. go-users errors: Text with \"go-users:\" prefix\n */\nexport async function extractErrorMessage(response: Response): Promise<string> {\n  const contentType = response.headers.get('content-type') || '';\n  const isJson =\n    contentType.includes('application/json') ||\n    contentType.includes('application/problem+json');\n\n  const bodyText = await response.clone().text().catch(() => '');\n\n  if (bodyText) {\n    // Try JSON payloads first (including Problem Details)\n    if (isJson || bodyText.trim().startsWith('{')) {\n      try {\n        const data = JSON.parse(bodyText) as Record<string, unknown>;\n\n        // Priority 1: /admin/api/* format (quickstart/error_fiber.go:18)\n        if (typeof data.error === 'string' && data.error.trim()) return data.error.trim();\n        if (data.error && typeof data.error === 'object') {\n          const errObj = data.error as Record<string, unknown>;\n          const message =\n            typeof errObj.message === 'string' ? errObj.message.trim() : '';\n          const fieldMessages: string[] = [];\n\n          if (Array.isArray(errObj.validation_errors)) {\n            for (const entry of errObj.validation_errors) {\n              if (!entry || typeof entry !== 'object') continue;\n              const field = (entry as Record<string, unknown>).field;\n              const msg = (entry as Record<string, unknown>).message;\n              if (typeof field === 'string' && typeof msg === 'string') {\n                fieldMessages.push(`${field}: ${msg}`);\n              }\n            }\n          }\n\n          const metadata = errObj.metadata;\n          if (metadata && typeof metadata === 'object') {\n            const fields = (metadata as Record<string, unknown>).fields;\n            if (fields && typeof fields === 'object' && !Array.isArray(fields)) {\n              for (const [field, msg] of Object.entries(fields)) {\n                if (typeof msg === 'string') {\n                  fieldMessages.push(`${field}: ${msg}`);\n                }\n              }\n            }\n          }\n\n          if (fieldMessages.length > 0) {\n            const prefix =\n              message && message.toLowerCase() !== 'validation failed'\n                ? `${message}: `\n                : 'Validation failed: ';\n            return `${prefix}${fieldMessages.join('; ')}`;\n          }\n          if (message) return message;\n        }\n\n        // Priority 2: Problem+JSON (go-crud)\n        if (typeof data.detail === 'string' && data.detail.trim()) return data.detail.trim();\n        if (typeof data.title === 'string' && data.title.trim()) return data.title.trim();\n\n        // Priority 3: Generic message field\n        if (typeof data.message === 'string' && data.message.trim()) return data.message.trim();\n      } catch {\n        // Not JSON (or parse failed) - fall through to text handling\n      }\n    }\n\n    // Extract go-users errors: \"... | go-users: lifecycle transition not allowed\"\n    if (bodyText.includes('go-users:')) {\n      const match = bodyText.match(/go-users:\\s*([^|]+)/);\n      if (match) return match[1].trim();\n    }\n\n    // Extract pipe-separated errors (common pattern)\n    const pipeMatch = bodyText.match(/\\|\\s*([^|]+)$/);\n    if (pipeMatch) return pipeMatch[1].trim();\n\n    // If text is short enough, return it directly\n    if (bodyText.trim().length > 0 && bodyText.length < 200) return bodyText.trim();\n  }\n\n  // Fallback to status code\n  return `Request failed (${response.status})`;\n}\n\n/**\n * Extract error message from various error types\n */\nexport function getErrorMessage(error: unknown): string {\n  if (error instanceof Error) {\n    return error.message;\n  }\n\n  if (typeof error === 'string') {\n    return error;\n  }\n\n  return 'An unexpected error occurred';\n}\n"],"names":["ToastManager","options","existing","container","positionClasses","cls","id","toast","duration","message","resolve","modal","icon","dismissBtn","overlay","isDone","cleanup","escHandler","e","finish","confirmed","cancelBtn","confirmBtn","type","icons","text","div","FallbackNotifier","prefix","extractErrorMessage","response","contentType","isJson","bodyText","data","errObj","fieldMessages","entry","field","msg","metadata","fields","match","pipeMatch","getErrorMessage","error"],"mappings":"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"}