{"version":3,"file":"icon-renderer-CRbgoQtj.js","sources":["../../src/shared/icon-renderer.ts"],"sourcesContent":["/**\n * Shared Icon Renderer Utility\n *\n * Centralizes icon HTML generation across the admin UI for dynamic JS surfaces.\n * Parses qualified icon references (iconoir:, lucide:, emoji:, svg:, url:) and\n * generates safe HTML output.\n *\n * Usage patterns:\n *   renderIcon('home')                    -> <i class=\"iconoir-home flex-shrink-0\" ...></i>\n *   renderIcon('iconoir:home')            -> <i class=\"iconoir-home flex-shrink-0\" ...></i>\n *   renderIcon('lucide:home')             -> <i class=\"lucide-home flex-shrink-0\" ...></i>\n *   renderIcon('emoji:rocket')            -> <span ...>rocket</span>\n *   renderIcon('url:https://...')         -> <img src=\"https://...\" ...>\n *\n * Security considerations:\n *   - All CSS class names are escaped to prevent injection\n *   - SVG content from svg: prefix is sanitized\n *   - URLs are validated (only https: and data: with allowed MIME types)\n *   - data: URIs are validated for MIME type and size\n */\n\n// ---------------------------------------------------------------------------\n// Types\n// ---------------------------------------------------------------------------\n\nexport type IconType = 'emoji' | 'library' | 'svg' | 'url';\n\nexport interface IconReference {\n  type: IconType;\n  library?: string;\n  value: string;\n  raw: string;\n}\n\nexport interface IconRenderOptions {\n  /** Custom CSS classes to add */\n  extraClass?: string;\n  /** Icon size style (e.g., '20px') */\n  size?: string;\n  /** Whether the icon source is trusted (allows SVG/URL) */\n  trusted?: boolean;\n}\n\n// ---------------------------------------------------------------------------\n// Constants\n// ---------------------------------------------------------------------------\n\nconst DEFAULT_LIBRARY = 'iconoir';\nconst DEFAULT_SIZE = 'var(--sidebar-icon-size, 20px)';\n\n/** Allowed URL schemes for external icons */\nconst ALLOWED_URL_SCHEMES = ['https:'];\n\n/** Allowed MIME types for data: URIs */\nconst ALLOWED_DATA_MIMES = [\n  'image/svg+xml',\n  'image/png',\n  'image/jpeg',\n  'image/webp',\n  'image/gif',\n];\n\n/** Maximum size for data: URI payloads (128KB) */\nconst MAX_DATA_URI_SIZE = 131072;\n\n/** SVG field type keys for legacy compatibility */\nconst SVG_FIELD_TYPE_KEYS: Record<string, string> = {\n  'text': 'text',\n  'textarea': 'text',\n  'rich-text': 'edit-pencil',\n  'markdown': 'edit-pencil',\n  'code': 'code',\n  'number': 'calculator',\n  'integer': 'calculator',\n  'currency': 'credit-card',\n  'percentage': 'percentage-round',\n  'select': 'list',\n  'radio': 'circle',\n  'checkbox': 'check-circle',\n  'chips': 'label',\n  'toggle': 'switch-on',\n  'date': 'calendar',\n  'time': 'clock',\n  'datetime': 'calendar',\n  'media-picker': 'media-image',\n  'media-gallery': 'media-image-list',\n  'file-upload': 'attachment',\n  'reference': 'link',\n  'references': 'link',\n  'user': 'user',\n  'group': 'folder',\n  'repeater': 'refresh-double',\n  'blocks': 'view-grid',\n  'json': 'code-brackets',\n  'slug': 'link',\n  'color': 'color-picker',\n  'location': 'pin-alt',\n};\n\n// ---------------------------------------------------------------------------\n// Parser\n// ---------------------------------------------------------------------------\n\n/**\n * Parses an icon reference string into its components.\n *\n * Parsing precedence:\n *   1. Empty string -> empty reference\n *   2. emoji:<value> -> emoji type\n *   3. svg:<content> -> svg type\n *   4. url:<value> -> url type\n *   5. Raw <svg...> -> svg type\n *   6. Raw http(s):// or data: -> url type\n *   7. Qualified library:name -> library type\n *   8. Legacy iconoir-name -> library iconoir\n *   9. SVG field type key mapping\n *   10. Bare name -> default library (iconoir)\n */\nexport function parseIconReference(ref: string): IconReference {\n  const raw = ref;\n  ref = ref.trim();\n\n  // 1. Empty string\n  if (!ref) {\n    return { type: 'library', value: '', raw };\n  }\n\n  // 2. emoji: prefix\n  if (ref.startsWith('emoji:')) {\n    return { type: 'emoji', value: ref.slice(6), raw };\n  }\n\n  // 3. svg: prefix\n  if (ref.startsWith('svg:')) {\n    return { type: 'svg', value: ref.slice(4), raw };\n  }\n\n  // 4. url: prefix\n  if (ref.startsWith('url:')) {\n    return { type: 'url', value: ref.slice(4), raw };\n  }\n\n  // 5. Raw SVG content\n  if (ref.startsWith('<svg') || ref.startsWith('<?xml')) {\n    return { type: 'svg', value: ref, raw };\n  }\n\n  // 6. Raw URL\n  if (ref.startsWith('http://') || ref.startsWith('https://') || ref.startsWith('data:')) {\n    return { type: 'url', value: ref, raw };\n  }\n\n  // 7. Emoji detection (common emoji ranges)\n  if (isEmoji(ref)) {\n    return { type: 'emoji', value: ref, raw };\n  }\n\n  // 8. Qualified library:name\n  if (ref.includes(':') && !ref.includes('://')) {\n    const colonIdx = ref.indexOf(':');\n    const library = ref.slice(0, colonIdx);\n    const name = ref.slice(colonIdx + 1);\n    return { type: 'library', library, value: name, raw };\n  }\n\n  // 9. Legacy iconoir-name\n  if (ref.startsWith('iconoir-')) {\n    return { type: 'library', library: 'iconoir', value: ref.slice(8), raw };\n  }\n\n  // 10. SVG field type key mapping\n  const mapped = SVG_FIELD_TYPE_KEYS[ref];\n  if (mapped) {\n    return { type: 'library', library: 'iconoir', value: mapped, raw };\n  }\n\n  // 11. Default: bare name -> iconoir library\n  return { type: 'library', library: DEFAULT_LIBRARY, value: ref, raw };\n}\n\n// ---------------------------------------------------------------------------\n// Renderer\n// ---------------------------------------------------------------------------\n\n/**\n * Renders an icon reference to safe HTML.\n *\n *   renderIcon('home')                  -> <i class=\"iconoir-home ...\">\n *   renderIcon('lucide:home')           -> <i class=\"lucide-home ...\">\n *   renderIcon('emoji:rocket')          -> <span ...>rocket</span>\n *   renderIcon('url:https://...')       -> <img src=\"https://...\" ...>\n */\nexport function renderIcon(ref: string, opts?: IconRenderOptions): string {\n  const parsed = parseIconReference(ref);\n  return renderParsedIcon(parsed, opts);\n}\n\n/**\n * Renders a pre-parsed icon reference to HTML.\n */\nexport function renderParsedIcon(ref: IconReference, opts?: IconRenderOptions): string {\n  if (!ref.value && ref.type === 'library') {\n    return '';\n  }\n\n  const size = opts?.size ?? DEFAULT_SIZE;\n  const extraClass = opts?.extraClass ?? '';\n\n  switch (ref.type) {\n    case 'emoji':\n      return renderEmoji(ref.value, size, extraClass);\n\n    case 'library':\n      return renderLibraryIcon(ref.library ?? DEFAULT_LIBRARY, ref.value, size, extraClass);\n\n    case 'svg':\n      if (opts?.trusted) {\n        return renderSvgIcon(ref.value, size, extraClass);\n      }\n      // Untrusted SVG: fall back to empty or a placeholder\n      console.warn('[icon-renderer] SVG content blocked for untrusted source');\n      return '';\n\n    case 'url':\n      return renderUrlIcon(ref.value, size, extraClass, opts?.trusted);\n\n    default:\n      return '';\n  }\n}\n\n// ---------------------------------------------------------------------------\n// Type-specific Renderers\n// ---------------------------------------------------------------------------\n\nfunction renderEmoji(emoji: string, size: string, extraClass: string): string {\n  const style = `font-size: ${size}; line-height: 1; text-align: center; width: 1.25em;`;\n  const cls = `flex-shrink-0${extraClass ? ' ' + extraClass : ''}`;\n  return `<span class=\"${cls}\" style=\"${style}\">${escapeHtml(emoji)}</span>`;\n}\n\nfunction renderLibraryIcon(library: string, name: string, size: string, extraClass: string): string {\n  const escapedLib = escapeClassName(library);\n  const escapedName = escapeClassName(name);\n  const style = `font-size: ${size};`;\n  const cls = `${escapedLib}-${escapedName} flex-shrink-0${extraClass ? ' ' + extraClass : ''}`;\n  return `<i class=\"${cls}\" style=\"${style}\"></i>`;\n}\n\nfunction renderSvgIcon(content: string, size: string, extraClass: string): string {\n  // Sanitize SVG content\n  const sanitized = sanitizeSvg(content);\n  if (!sanitized) {\n    return '';\n  }\n\n  const cls = `flex-shrink-0${extraClass ? ' ' + extraClass : ''}`;\n  const style = `width: ${size}; height: ${size};`;\n  return `<span class=\"${cls}\" style=\"${style}\">${sanitized}</span>`;\n}\n\nfunction renderUrlIcon(url: string, size: string, extraClass: string, trusted?: boolean): string {\n  // Validate URL\n  const validated = validateIconUrl(url, trusted);\n  if (!validated) {\n    console.warn('[icon-renderer] URL blocked:', url);\n    return '';\n  }\n\n  const cls = `flex-shrink-0${extraClass ? ' ' + extraClass : ''}`;\n  const style = `width: ${size}; height: ${size}; object-fit: contain;`;\n  return `<img src=\"${escapeAttr(validated)}\" class=\"${cls}\" style=\"${style}\" alt=\"\" aria-hidden=\"true\">`;\n}\n\n// ---------------------------------------------------------------------------\n// URL Validation\n// ---------------------------------------------------------------------------\n\nfunction validateIconUrl(url: string, trusted?: boolean): string | null {\n  url = url.trim();\n  if (!url) {\n    return null;\n  }\n\n  // Block javascript: URLs\n  if (url.toLowerCase().startsWith('javascript:')) {\n    return null;\n  }\n\n  // Handle data: URIs\n  if (url.startsWith('data:')) {\n    return validateDataUri(url, trusted);\n  }\n\n  // Handle external URLs\n  try {\n    const parsed = new URL(url);\n\n    // Check scheme\n    if (!ALLOWED_URL_SCHEMES.includes(parsed.protocol)) {\n      return null;\n    }\n\n    // Untrusted sources: block external URLs unless explicitly trusted\n    if (!trusted) {\n      console.warn('[icon-renderer] External URL blocked for untrusted source');\n      return null;\n    }\n\n    return url;\n  } catch {\n    return null;\n  }\n}\n\nfunction validateDataUri(dataUri: string, trusted?: boolean): string | null {\n  if (!dataUri.startsWith('data:')) {\n    return null;\n  }\n\n  // Check size limit\n  if (dataUri.length > MAX_DATA_URI_SIZE) {\n    console.warn('[icon-renderer] Data URI exceeds size limit');\n    return null;\n  }\n\n  // Parse data URI: data:[<mediatype>][;base64],<data>\n  const content = dataUri.slice(5); // Remove 'data:'\n  const commaIdx = content.indexOf(',');\n  if (commaIdx < 0) {\n    return null;\n  }\n\n  const header = content.slice(0, commaIdx);\n  const mimeType = header.split(';')[0].trim();\n\n  // Check MIME allowlist\n  if (!ALLOWED_DATA_MIMES.includes(mimeType.toLowerCase())) {\n    console.warn('[icon-renderer] Data URI MIME type not allowed:', mimeType);\n    return null;\n  }\n\n  // For untrusted sources, only allow non-SVG data URIs\n  if (!trusted && mimeType.toLowerCase() === 'image/svg+xml') {\n    console.warn('[icon-renderer] SVG data URI blocked for untrusted source');\n    return null;\n  }\n\n  return dataUri;\n}\n\n// ---------------------------------------------------------------------------\n// SVG Sanitization\n// ---------------------------------------------------------------------------\n\n/**\n * Sanitizes SVG content by removing dangerous elements and attributes.\n */\nfunction sanitizeSvg(svg: string): string | null {\n  // Basic structure check\n  if (!svg.toLowerCase().includes('<svg')) {\n    return null;\n  }\n\n  // Remove script tags, event handlers, and other dangerous content\n  let sanitized = svg;\n\n  // Remove dangerous elements\n  sanitized = sanitized.replace(\n    /<\\s*(script|foreignObject|set|animate|animateMotion|animateTransform|use|image|feImage)[^>]*>[\\s\\S]*?<\\/\\s*\\1\\s*>/gi,\n    ''\n  );\n  sanitized = sanitized.replace(\n    /<\\s*(script|foreignObject|set|animate|animateMotion|animateTransform|use|image|feImage)[^>]*\\/?>/gi,\n    ''\n  );\n\n  // Remove event handlers\n  sanitized = sanitized.replace(/\\s+on\\w+\\s*=\\s*[\"'][^\"']*[\"']/gi, '');\n  sanitized = sanitized.replace(/\\s+on\\w+\\s*=\\s*[^\\s>]+/gi, '');\n\n  // Remove javascript: hrefs\n  sanitized = sanitized.replace(/(href|xlink:href)\\s*=\\s*[\"']?\\s*javascript:[^\"'\\s>]*[\"']?/gi, '');\n\n  // Remove external references\n  sanitized = sanitized.replace(/(href|xlink:href|src)\\s*=\\s*[\"']?\\s*(https?:|\\/\\/)[^\"'\\s>]*[\"']?/gi, '');\n\n  // Remove XML entities and processing instructions\n  sanitized = sanitized.replace(/<!ENTITY\\s+[^>]+>/gi, '');\n  sanitized = sanitized.replace(/<!DOCTYPE[^>]*\\[[\\s\\S]*?\\]>/gi, '');\n  sanitized = sanitized.replace(/<\\?[\\s\\S]*?\\?>/g, '');\n\n  // Verify structure is still intact\n  if (!sanitized.toLowerCase().includes('<svg')) {\n    return null;\n  }\n\n  return sanitized.trim();\n}\n\n// ---------------------------------------------------------------------------\n// Emoji Detection\n// ---------------------------------------------------------------------------\n\nfunction isEmoji(str: string): boolean {\n  for (const char of str) {\n    const code = char.codePointAt(0);\n    if (code === undefined) continue;\n\n    // Variation selector or ZWJ\n    if (code === 0xFE0F || code === 0x200D) {\n      return true;\n    }\n\n    // Symbol, Other category / Miscellaneous Symbols / Dingbats\n    if (code >= 0x2600 && code <= 0x27BF) {\n      return true;\n    }\n\n    // Main emoji blocks\n    if (code >= 0x1F300 && code <= 0x1FAFF) {\n      return true;\n    }\n\n    // Skin tone modifiers\n    if (code >= 0x1F3FB && code <= 0x1F3FF) {\n      return true;\n    }\n  }\n  return false;\n}\n\n// ---------------------------------------------------------------------------\n// Escape Helpers\n// ---------------------------------------------------------------------------\n\nfunction escapeHtml(str: string): string {\n  return str\n    .replace(/&/g, '&amp;')\n    .replace(/</g, '&lt;')\n    .replace(/>/g, '&gt;')\n    .replace(/\"/g, '&quot;');\n}\n\nfunction escapeAttr(str: string): string {\n  return str\n    .replace(/&/g, '&amp;')\n    .replace(/\"/g, '&quot;');\n}\n\n/**\n * Escapes a string for safe use as a CSS class name.\n * Only allows alphanumeric characters, hyphens, and underscores.\n */\nfunction escapeClassName(str: string): string {\n  return str.replace(/[^a-zA-Z0-9_-]/g, '');\n}\n"],"names":["DEFAULT_LIBRARY","DEFAULT_SIZE","ALLOWED_URL_SCHEMES","ALLOWED_DATA_MIMES","SVG_FIELD_TYPE_KEYS","parseIconReference","ref","raw","isEmoji","colonIdx","library","name","mapped","renderIcon","opts","parsed","renderParsedIcon","size","extraClass","renderEmoji","renderLibraryIcon","renderSvgIcon","renderUrlIcon","emoji","style","escapeHtml","escapedLib","escapeClassName","escapedName","content","sanitized","sanitizeSvg","cls","url","trusted","validated","validateIconUrl","escapeAttr","validateDataUri","dataUri","commaIdx","mimeType","svg","str","char","code"],"mappings":"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"}