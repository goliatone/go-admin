{"version":3,"file":"index.js","sources":["../../node_modules/jsonpath-plus/dist/index-browser-esm.js","../../src/debug/shared/jsonpath-search.ts","../../src/debug/debug-panel.ts","../../src/debug/index.ts"],"sourcesContent":["/**\n * @implements {IHooks}\n */\nclass Hooks {\n  /**\n   * @callback HookCallback\n   * @this {*|Jsep} this\n   * @param {Jsep} env\n   * @returns: void\n   */\n  /**\n   * Adds the given callback to the list of callbacks for the given hook.\n   *\n   * The callback will be invoked when the hook it is registered for is run.\n   *\n   * One callback function can be registered to multiple hooks and the same hook multiple times.\n   *\n   * @param {string|object} name The name of the hook, or an object of callbacks keyed by name\n   * @param {HookCallback|boolean} callback The callback function which is given environment variables.\n   * @param {?boolean} [first=false] Will add the hook to the top of the list (defaults to the bottom)\n   * @public\n   */\n  add(name, callback, first) {\n    if (typeof arguments[0] != 'string') {\n      // Multiple hook callbacks, keyed by name\n      for (let name in arguments[0]) {\n        this.add(name, arguments[0][name], arguments[1]);\n      }\n    } else {\n      (Array.isArray(name) ? name : [name]).forEach(function (name) {\n        this[name] = this[name] || [];\n        if (callback) {\n          this[name][first ? 'unshift' : 'push'](callback);\n        }\n      }, this);\n    }\n  }\n\n  /**\n   * Runs a hook invoking all registered callbacks with the given environment variables.\n   *\n   * Callbacks will be invoked synchronously and in the order in which they were registered.\n   *\n   * @param {string} name The name of the hook.\n   * @param {Object<string, any>} env The environment variables of the hook passed to all callbacks registered.\n   * @public\n   */\n  run(name, env) {\n    this[name] = this[name] || [];\n    this[name].forEach(function (callback) {\n      callback.call(env && env.context ? env.context : env, env);\n    });\n  }\n}\n\n/**\n * @implements {IPlugins}\n */\nclass Plugins {\n  constructor(jsep) {\n    this.jsep = jsep;\n    this.registered = {};\n  }\n\n  /**\n   * @callback PluginSetup\n   * @this {Jsep} jsep\n   * @returns: void\n   */\n  /**\n   * Adds the given plugin(s) to the registry\n   *\n   * @param {object} plugins\n   * @param {string} plugins.name The name of the plugin\n   * @param {PluginSetup} plugins.init The init function\n   * @public\n   */\n  register() {\n    for (var _len = arguments.length, plugins = new Array(_len), _key = 0; _key < _len; _key++) {\n      plugins[_key] = arguments[_key];\n    }\n    plugins.forEach(plugin => {\n      if (typeof plugin !== 'object' || !plugin.name || !plugin.init) {\n        throw new Error('Invalid JSEP plugin format');\n      }\n      if (this.registered[plugin.name]) {\n        // already registered. Ignore.\n        return;\n      }\n      plugin.init(this.jsep);\n      this.registered[plugin.name] = plugin;\n    });\n  }\n}\n\n//     JavaScript Expression Parser (JSEP) 1.4.0\n\nclass Jsep {\n  /**\n   * @returns {string}\n   */\n  static get version() {\n    // To be filled in by the template\n    return '1.4.0';\n  }\n\n  /**\n   * @returns {string}\n   */\n  static toString() {\n    return 'JavaScript Expression Parser (JSEP) v' + Jsep.version;\n  }\n  // ==================== CONFIG ================================\n  /**\n   * @method addUnaryOp\n   * @param {string} op_name The name of the unary op to add\n   * @returns {Jsep}\n   */\n  static addUnaryOp(op_name) {\n    Jsep.max_unop_len = Math.max(op_name.length, Jsep.max_unop_len);\n    Jsep.unary_ops[op_name] = 1;\n    return Jsep;\n  }\n\n  /**\n   * @method jsep.addBinaryOp\n   * @param {string} op_name The name of the binary op to add\n   * @param {number} precedence The precedence of the binary op (can be a float). Higher number = higher precedence\n   * @param {boolean} [isRightAssociative=false] whether operator is right-associative\n   * @returns {Jsep}\n   */\n  static addBinaryOp(op_name, precedence, isRightAssociative) {\n    Jsep.max_binop_len = Math.max(op_name.length, Jsep.max_binop_len);\n    Jsep.binary_ops[op_name] = precedence;\n    if (isRightAssociative) {\n      Jsep.right_associative.add(op_name);\n    } else {\n      Jsep.right_associative.delete(op_name);\n    }\n    return Jsep;\n  }\n\n  /**\n   * @method addIdentifierChar\n   * @param {string} char The additional character to treat as a valid part of an identifier\n   * @returns {Jsep}\n   */\n  static addIdentifierChar(char) {\n    Jsep.additional_identifier_chars.add(char);\n    return Jsep;\n  }\n\n  /**\n   * @method addLiteral\n   * @param {string} literal_name The name of the literal to add\n   * @param {*} literal_value The value of the literal\n   * @returns {Jsep}\n   */\n  static addLiteral(literal_name, literal_value) {\n    Jsep.literals[literal_name] = literal_value;\n    return Jsep;\n  }\n\n  /**\n   * @method removeUnaryOp\n   * @param {string} op_name The name of the unary op to remove\n   * @returns {Jsep}\n   */\n  static removeUnaryOp(op_name) {\n    delete Jsep.unary_ops[op_name];\n    if (op_name.length === Jsep.max_unop_len) {\n      Jsep.max_unop_len = Jsep.getMaxKeyLen(Jsep.unary_ops);\n    }\n    return Jsep;\n  }\n\n  /**\n   * @method removeAllUnaryOps\n   * @returns {Jsep}\n   */\n  static removeAllUnaryOps() {\n    Jsep.unary_ops = {};\n    Jsep.max_unop_len = 0;\n    return Jsep;\n  }\n\n  /**\n   * @method removeIdentifierChar\n   * @param {string} char The additional character to stop treating as a valid part of an identifier\n   * @returns {Jsep}\n   */\n  static removeIdentifierChar(char) {\n    Jsep.additional_identifier_chars.delete(char);\n    return Jsep;\n  }\n\n  /**\n   * @method removeBinaryOp\n   * @param {string} op_name The name of the binary op to remove\n   * @returns {Jsep}\n   */\n  static removeBinaryOp(op_name) {\n    delete Jsep.binary_ops[op_name];\n    if (op_name.length === Jsep.max_binop_len) {\n      Jsep.max_binop_len = Jsep.getMaxKeyLen(Jsep.binary_ops);\n    }\n    Jsep.right_associative.delete(op_name);\n    return Jsep;\n  }\n\n  /**\n   * @method removeAllBinaryOps\n   * @returns {Jsep}\n   */\n  static removeAllBinaryOps() {\n    Jsep.binary_ops = {};\n    Jsep.max_binop_len = 0;\n    return Jsep;\n  }\n\n  /**\n   * @method removeLiteral\n   * @param {string} literal_name The name of the literal to remove\n   * @returns {Jsep}\n   */\n  static removeLiteral(literal_name) {\n    delete Jsep.literals[literal_name];\n    return Jsep;\n  }\n\n  /**\n   * @method removeAllLiterals\n   * @returns {Jsep}\n   */\n  static removeAllLiterals() {\n    Jsep.literals = {};\n    return Jsep;\n  }\n  // ==================== END CONFIG ============================\n\n  /**\n   * @returns {string}\n   */\n  get char() {\n    return this.expr.charAt(this.index);\n  }\n\n  /**\n   * @returns {number}\n   */\n  get code() {\n    return this.expr.charCodeAt(this.index);\n  }\n  /**\n   * @param {string} expr a string with the passed in express\n   * @returns Jsep\n   */\n  constructor(expr) {\n    // `index` stores the character number we are currently at\n    // All of the gobbles below will modify `index` as we move along\n    this.expr = expr;\n    this.index = 0;\n  }\n\n  /**\n   * static top-level parser\n   * @returns {jsep.Expression}\n   */\n  static parse(expr) {\n    return new Jsep(expr).parse();\n  }\n\n  /**\n   * Get the longest key length of any object\n   * @param {object} obj\n   * @returns {number}\n   */\n  static getMaxKeyLen(obj) {\n    return Math.max(0, ...Object.keys(obj).map(k => k.length));\n  }\n\n  /**\n   * `ch` is a character code in the next three functions\n   * @param {number} ch\n   * @returns {boolean}\n   */\n  static isDecimalDigit(ch) {\n    return ch >= 48 && ch <= 57; // 0...9\n  }\n\n  /**\n   * Returns the precedence of a binary operator or `0` if it isn't a binary operator. Can be float.\n   * @param {string} op_val\n   * @returns {number}\n   */\n  static binaryPrecedence(op_val) {\n    return Jsep.binary_ops[op_val] || 0;\n  }\n\n  /**\n   * Looks for start of identifier\n   * @param {number} ch\n   * @returns {boolean}\n   */\n  static isIdentifierStart(ch) {\n    return ch >= 65 && ch <= 90 ||\n    // A...Z\n    ch >= 97 && ch <= 122 ||\n    // a...z\n    ch >= 128 && !Jsep.binary_ops[String.fromCharCode(ch)] ||\n    // any non-ASCII that is not an operator\n    Jsep.additional_identifier_chars.has(String.fromCharCode(ch)); // additional characters\n  }\n\n  /**\n   * @param {number} ch\n   * @returns {boolean}\n   */\n  static isIdentifierPart(ch) {\n    return Jsep.isIdentifierStart(ch) || Jsep.isDecimalDigit(ch);\n  }\n\n  /**\n   * throw error at index of the expression\n   * @param {string} message\n   * @throws\n   */\n  throwError(message) {\n    const error = new Error(message + ' at character ' + this.index);\n    error.index = this.index;\n    error.description = message;\n    throw error;\n  }\n\n  /**\n   * Run a given hook\n   * @param {string} name\n   * @param {jsep.Expression|false} [node]\n   * @returns {?jsep.Expression}\n   */\n  runHook(name, node) {\n    if (Jsep.hooks[name]) {\n      const env = {\n        context: this,\n        node\n      };\n      Jsep.hooks.run(name, env);\n      return env.node;\n    }\n    return node;\n  }\n\n  /**\n   * Runs a given hook until one returns a node\n   * @param {string} name\n   * @returns {?jsep.Expression}\n   */\n  searchHook(name) {\n    if (Jsep.hooks[name]) {\n      const env = {\n        context: this\n      };\n      Jsep.hooks[name].find(function (callback) {\n        callback.call(env.context, env);\n        return env.node;\n      });\n      return env.node;\n    }\n  }\n\n  /**\n   * Push `index` up to the next non-space character\n   */\n  gobbleSpaces() {\n    let ch = this.code;\n    // Whitespace\n    while (ch === Jsep.SPACE_CODE || ch === Jsep.TAB_CODE || ch === Jsep.LF_CODE || ch === Jsep.CR_CODE) {\n      ch = this.expr.charCodeAt(++this.index);\n    }\n    this.runHook('gobble-spaces');\n  }\n\n  /**\n   * Top-level method to parse all expressions and returns compound or single node\n   * @returns {jsep.Expression}\n   */\n  parse() {\n    this.runHook('before-all');\n    const nodes = this.gobbleExpressions();\n\n    // If there's only one expression just try returning the expression\n    const node = nodes.length === 1 ? nodes[0] : {\n      type: Jsep.COMPOUND,\n      body: nodes\n    };\n    return this.runHook('after-all', node);\n  }\n\n  /**\n   * top-level parser (but can be reused within as well)\n   * @param {number} [untilICode]\n   * @returns {jsep.Expression[]}\n   */\n  gobbleExpressions(untilICode) {\n    let nodes = [],\n      ch_i,\n      node;\n    while (this.index < this.expr.length) {\n      ch_i = this.code;\n\n      // Expressions can be separated by semicolons, commas, or just inferred without any\n      // separators\n      if (ch_i === Jsep.SEMCOL_CODE || ch_i === Jsep.COMMA_CODE) {\n        this.index++; // ignore separators\n      } else {\n        // Try to gobble each expression individually\n        if (node = this.gobbleExpression()) {\n          nodes.push(node);\n          // If we weren't able to find a binary expression and are out of room, then\n          // the expression passed in probably has too much\n        } else if (this.index < this.expr.length) {\n          if (ch_i === untilICode) {\n            break;\n          }\n          this.throwError('Unexpected \"' + this.char + '\"');\n        }\n      }\n    }\n    return nodes;\n  }\n\n  /**\n   * The main parsing function.\n   * @returns {?jsep.Expression}\n   */\n  gobbleExpression() {\n    const node = this.searchHook('gobble-expression') || this.gobbleBinaryExpression();\n    this.gobbleSpaces();\n    return this.runHook('after-expression', node);\n  }\n\n  /**\n   * Search for the operation portion of the string (e.g. `+`, `===`)\n   * Start by taking the longest possible binary operations (3 characters: `===`, `!==`, `>>>`)\n   * and move down from 3 to 2 to 1 character until a matching binary operation is found\n   * then, return that binary operation\n   * @returns {string|boolean}\n   */\n  gobbleBinaryOp() {\n    this.gobbleSpaces();\n    let to_check = this.expr.substr(this.index, Jsep.max_binop_len);\n    let tc_len = to_check.length;\n    while (tc_len > 0) {\n      // Don't accept a binary op when it is an identifier.\n      // Binary ops that start with a identifier-valid character must be followed\n      // by a non identifier-part valid character\n      if (Jsep.binary_ops.hasOwnProperty(to_check) && (!Jsep.isIdentifierStart(this.code) || this.index + to_check.length < this.expr.length && !Jsep.isIdentifierPart(this.expr.charCodeAt(this.index + to_check.length)))) {\n        this.index += tc_len;\n        return to_check;\n      }\n      to_check = to_check.substr(0, --tc_len);\n    }\n    return false;\n  }\n\n  /**\n   * This function is responsible for gobbling an individual expression,\n   * e.g. `1`, `1+2`, `a+(b*2)-Math.sqrt(2)`\n   * @returns {?jsep.BinaryExpression}\n   */\n  gobbleBinaryExpression() {\n    let node, biop, prec, stack, biop_info, left, right, i, cur_biop;\n\n    // First, try to get the leftmost thing\n    // Then, check to see if there's a binary operator operating on that leftmost thing\n    // Don't gobbleBinaryOp without a left-hand-side\n    left = this.gobbleToken();\n    if (!left) {\n      return left;\n    }\n    biop = this.gobbleBinaryOp();\n\n    // If there wasn't a binary operator, just return the leftmost node\n    if (!biop) {\n      return left;\n    }\n\n    // Otherwise, we need to start a stack to properly place the binary operations in their\n    // precedence structure\n    biop_info = {\n      value: biop,\n      prec: Jsep.binaryPrecedence(biop),\n      right_a: Jsep.right_associative.has(biop)\n    };\n    right = this.gobbleToken();\n    if (!right) {\n      this.throwError(\"Expected expression after \" + biop);\n    }\n    stack = [left, biop_info, right];\n\n    // Properly deal with precedence using [recursive descent](http://www.engr.mun.ca/~theo/Misc/exp_parsing.htm)\n    while (biop = this.gobbleBinaryOp()) {\n      prec = Jsep.binaryPrecedence(biop);\n      if (prec === 0) {\n        this.index -= biop.length;\n        break;\n      }\n      biop_info = {\n        value: biop,\n        prec,\n        right_a: Jsep.right_associative.has(biop)\n      };\n      cur_biop = biop;\n\n      // Reduce: make a binary expression from the three topmost entries.\n      const comparePrev = prev => biop_info.right_a && prev.right_a ? prec > prev.prec : prec <= prev.prec;\n      while (stack.length > 2 && comparePrev(stack[stack.length - 2])) {\n        right = stack.pop();\n        biop = stack.pop().value;\n        left = stack.pop();\n        node = {\n          type: Jsep.BINARY_EXP,\n          operator: biop,\n          left,\n          right\n        };\n        stack.push(node);\n      }\n      node = this.gobbleToken();\n      if (!node) {\n        this.throwError(\"Expected expression after \" + cur_biop);\n      }\n      stack.push(biop_info, node);\n    }\n    i = stack.length - 1;\n    node = stack[i];\n    while (i > 1) {\n      node = {\n        type: Jsep.BINARY_EXP,\n        operator: stack[i - 1].value,\n        left: stack[i - 2],\n        right: node\n      };\n      i -= 2;\n    }\n    return node;\n  }\n\n  /**\n   * An individual part of a binary expression:\n   * e.g. `foo.bar(baz)`, `1`, `\"abc\"`, `(a % 2)` (because it's in parenthesis)\n   * @returns {boolean|jsep.Expression}\n   */\n  gobbleToken() {\n    let ch, to_check, tc_len, node;\n    this.gobbleSpaces();\n    node = this.searchHook('gobble-token');\n    if (node) {\n      return this.runHook('after-token', node);\n    }\n    ch = this.code;\n    if (Jsep.isDecimalDigit(ch) || ch === Jsep.PERIOD_CODE) {\n      // Char code 46 is a dot `.` which can start off a numeric literal\n      return this.gobbleNumericLiteral();\n    }\n    if (ch === Jsep.SQUOTE_CODE || ch === Jsep.DQUOTE_CODE) {\n      // Single or double quotes\n      node = this.gobbleStringLiteral();\n    } else if (ch === Jsep.OBRACK_CODE) {\n      node = this.gobbleArray();\n    } else {\n      to_check = this.expr.substr(this.index, Jsep.max_unop_len);\n      tc_len = to_check.length;\n      while (tc_len > 0) {\n        // Don't accept an unary op when it is an identifier.\n        // Unary ops that start with a identifier-valid character must be followed\n        // by a non identifier-part valid character\n        if (Jsep.unary_ops.hasOwnProperty(to_check) && (!Jsep.isIdentifierStart(this.code) || this.index + to_check.length < this.expr.length && !Jsep.isIdentifierPart(this.expr.charCodeAt(this.index + to_check.length)))) {\n          this.index += tc_len;\n          const argument = this.gobbleToken();\n          if (!argument) {\n            this.throwError('missing unaryOp argument');\n          }\n          return this.runHook('after-token', {\n            type: Jsep.UNARY_EXP,\n            operator: to_check,\n            argument,\n            prefix: true\n          });\n        }\n        to_check = to_check.substr(0, --tc_len);\n      }\n      if (Jsep.isIdentifierStart(ch)) {\n        node = this.gobbleIdentifier();\n        if (Jsep.literals.hasOwnProperty(node.name)) {\n          node = {\n            type: Jsep.LITERAL,\n            value: Jsep.literals[node.name],\n            raw: node.name\n          };\n        } else if (node.name === Jsep.this_str) {\n          node = {\n            type: Jsep.THIS_EXP\n          };\n        }\n      } else if (ch === Jsep.OPAREN_CODE) {\n        // open parenthesis\n        node = this.gobbleGroup();\n      }\n    }\n    if (!node) {\n      return this.runHook('after-token', false);\n    }\n    node = this.gobbleTokenProperty(node);\n    return this.runHook('after-token', node);\n  }\n\n  /**\n   * Gobble properties of of identifiers/strings/arrays/groups.\n   * e.g. `foo`, `bar.baz`, `foo['bar'].baz`\n   * It also gobbles function calls:\n   * e.g. `Math.acos(obj.angle)`\n   * @param {jsep.Expression} node\n   * @returns {jsep.Expression}\n   */\n  gobbleTokenProperty(node) {\n    this.gobbleSpaces();\n    let ch = this.code;\n    while (ch === Jsep.PERIOD_CODE || ch === Jsep.OBRACK_CODE || ch === Jsep.OPAREN_CODE || ch === Jsep.QUMARK_CODE) {\n      let optional;\n      if (ch === Jsep.QUMARK_CODE) {\n        if (this.expr.charCodeAt(this.index + 1) !== Jsep.PERIOD_CODE) {\n          break;\n        }\n        optional = true;\n        this.index += 2;\n        this.gobbleSpaces();\n        ch = this.code;\n      }\n      this.index++;\n      if (ch === Jsep.OBRACK_CODE) {\n        node = {\n          type: Jsep.MEMBER_EXP,\n          computed: true,\n          object: node,\n          property: this.gobbleExpression()\n        };\n        if (!node.property) {\n          this.throwError('Unexpected \"' + this.char + '\"');\n        }\n        this.gobbleSpaces();\n        ch = this.code;\n        if (ch !== Jsep.CBRACK_CODE) {\n          this.throwError('Unclosed [');\n        }\n        this.index++;\n      } else if (ch === Jsep.OPAREN_CODE) {\n        // A function call is being made; gobble all the arguments\n        node = {\n          type: Jsep.CALL_EXP,\n          'arguments': this.gobbleArguments(Jsep.CPAREN_CODE),\n          callee: node\n        };\n      } else if (ch === Jsep.PERIOD_CODE || optional) {\n        if (optional) {\n          this.index--;\n        }\n        this.gobbleSpaces();\n        node = {\n          type: Jsep.MEMBER_EXP,\n          computed: false,\n          object: node,\n          property: this.gobbleIdentifier()\n        };\n      }\n      if (optional) {\n        node.optional = true;\n      } // else leave undefined for compatibility with esprima\n\n      this.gobbleSpaces();\n      ch = this.code;\n    }\n    return node;\n  }\n\n  /**\n   * Parse simple numeric literals: `12`, `3.4`, `.5`. Do this by using a string to\n   * keep track of everything in the numeric literal and then calling `parseFloat` on that string\n   * @returns {jsep.Literal}\n   */\n  gobbleNumericLiteral() {\n    let number = '',\n      ch,\n      chCode;\n    while (Jsep.isDecimalDigit(this.code)) {\n      number += this.expr.charAt(this.index++);\n    }\n    if (this.code === Jsep.PERIOD_CODE) {\n      // can start with a decimal marker\n      number += this.expr.charAt(this.index++);\n      while (Jsep.isDecimalDigit(this.code)) {\n        number += this.expr.charAt(this.index++);\n      }\n    }\n    ch = this.char;\n    if (ch === 'e' || ch === 'E') {\n      // exponent marker\n      number += this.expr.charAt(this.index++);\n      ch = this.char;\n      if (ch === '+' || ch === '-') {\n        // exponent sign\n        number += this.expr.charAt(this.index++);\n      }\n      while (Jsep.isDecimalDigit(this.code)) {\n        // exponent itself\n        number += this.expr.charAt(this.index++);\n      }\n      if (!Jsep.isDecimalDigit(this.expr.charCodeAt(this.index - 1))) {\n        this.throwError('Expected exponent (' + number + this.char + ')');\n      }\n    }\n    chCode = this.code;\n\n    // Check to make sure this isn't a variable name that start with a number (123abc)\n    if (Jsep.isIdentifierStart(chCode)) {\n      this.throwError('Variable names cannot start with a number (' + number + this.char + ')');\n    } else if (chCode === Jsep.PERIOD_CODE || number.length === 1 && number.charCodeAt(0) === Jsep.PERIOD_CODE) {\n      this.throwError('Unexpected period');\n    }\n    return {\n      type: Jsep.LITERAL,\n      value: parseFloat(number),\n      raw: number\n    };\n  }\n\n  /**\n   * Parses a string literal, staring with single or double quotes with basic support for escape codes\n   * e.g. `\"hello world\"`, `'this is\\nJSEP'`\n   * @returns {jsep.Literal}\n   */\n  gobbleStringLiteral() {\n    let str = '';\n    const startIndex = this.index;\n    const quote = this.expr.charAt(this.index++);\n    let closed = false;\n    while (this.index < this.expr.length) {\n      let ch = this.expr.charAt(this.index++);\n      if (ch === quote) {\n        closed = true;\n        break;\n      } else if (ch === '\\\\') {\n        // Check for all of the common escape codes\n        ch = this.expr.charAt(this.index++);\n        switch (ch) {\n          case 'n':\n            str += '\\n';\n            break;\n          case 'r':\n            str += '\\r';\n            break;\n          case 't':\n            str += '\\t';\n            break;\n          case 'b':\n            str += '\\b';\n            break;\n          case 'f':\n            str += '\\f';\n            break;\n          case 'v':\n            str += '\\x0B';\n            break;\n          default:\n            str += ch;\n        }\n      } else {\n        str += ch;\n      }\n    }\n    if (!closed) {\n      this.throwError('Unclosed quote after \"' + str + '\"');\n    }\n    return {\n      type: Jsep.LITERAL,\n      value: str,\n      raw: this.expr.substring(startIndex, this.index)\n    };\n  }\n\n  /**\n   * Gobbles only identifiers\n   * e.g.: `foo`, `_value`, `$x1`\n   * Also, this function checks if that identifier is a literal:\n   * (e.g. `true`, `false`, `null`) or `this`\n   * @returns {jsep.Identifier}\n   */\n  gobbleIdentifier() {\n    let ch = this.code,\n      start = this.index;\n    if (Jsep.isIdentifierStart(ch)) {\n      this.index++;\n    } else {\n      this.throwError('Unexpected ' + this.char);\n    }\n    while (this.index < this.expr.length) {\n      ch = this.code;\n      if (Jsep.isIdentifierPart(ch)) {\n        this.index++;\n      } else {\n        break;\n      }\n    }\n    return {\n      type: Jsep.IDENTIFIER,\n      name: this.expr.slice(start, this.index)\n    };\n  }\n\n  /**\n   * Gobbles a list of arguments within the context of a function call\n   * or array literal. This function also assumes that the opening character\n   * `(` or `[` has already been gobbled, and gobbles expressions and commas\n   * until the terminator character `)` or `]` is encountered.\n   * e.g. `foo(bar, baz)`, `my_func()`, or `[bar, baz]`\n   * @param {number} termination\n   * @returns {jsep.Expression[]}\n   */\n  gobbleArguments(termination) {\n    const args = [];\n    let closed = false;\n    let separator_count = 0;\n    while (this.index < this.expr.length) {\n      this.gobbleSpaces();\n      let ch_i = this.code;\n      if (ch_i === termination) {\n        // done parsing\n        closed = true;\n        this.index++;\n        if (termination === Jsep.CPAREN_CODE && separator_count && separator_count >= args.length) {\n          this.throwError('Unexpected token ' + String.fromCharCode(termination));\n        }\n        break;\n      } else if (ch_i === Jsep.COMMA_CODE) {\n        // between expressions\n        this.index++;\n        separator_count++;\n        if (separator_count !== args.length) {\n          // missing argument\n          if (termination === Jsep.CPAREN_CODE) {\n            this.throwError('Unexpected token ,');\n          } else if (termination === Jsep.CBRACK_CODE) {\n            for (let arg = args.length; arg < separator_count; arg++) {\n              args.push(null);\n            }\n          }\n        }\n      } else if (args.length !== separator_count && separator_count !== 0) {\n        // NOTE: `&& separator_count !== 0` allows for either all commas, or all spaces as arguments\n        this.throwError('Expected comma');\n      } else {\n        const node = this.gobbleExpression();\n        if (!node || node.type === Jsep.COMPOUND) {\n          this.throwError('Expected comma');\n        }\n        args.push(node);\n      }\n    }\n    if (!closed) {\n      this.throwError('Expected ' + String.fromCharCode(termination));\n    }\n    return args;\n  }\n\n  /**\n   * Responsible for parsing a group of things within parentheses `()`\n   * that have no identifier in front (so not a function call)\n   * This function assumes that it needs to gobble the opening parenthesis\n   * and then tries to gobble everything within that parenthesis, assuming\n   * that the next thing it should see is the close parenthesis. If not,\n   * then the expression probably doesn't have a `)`\n   * @returns {boolean|jsep.Expression}\n   */\n  gobbleGroup() {\n    this.index++;\n    let nodes = this.gobbleExpressions(Jsep.CPAREN_CODE);\n    if (this.code === Jsep.CPAREN_CODE) {\n      this.index++;\n      if (nodes.length === 1) {\n        return nodes[0];\n      } else if (!nodes.length) {\n        return false;\n      } else {\n        return {\n          type: Jsep.SEQUENCE_EXP,\n          expressions: nodes\n        };\n      }\n    } else {\n      this.throwError('Unclosed (');\n    }\n  }\n\n  /**\n   * Responsible for parsing Array literals `[1, 2, 3]`\n   * This function assumes that it needs to gobble the opening bracket\n   * and then tries to gobble the expressions as arguments.\n   * @returns {jsep.ArrayExpression}\n   */\n  gobbleArray() {\n    this.index++;\n    return {\n      type: Jsep.ARRAY_EXP,\n      elements: this.gobbleArguments(Jsep.CBRACK_CODE)\n    };\n  }\n}\n\n// Static fields:\nconst hooks = new Hooks();\nObject.assign(Jsep, {\n  hooks,\n  plugins: new Plugins(Jsep),\n  // Node Types\n  // ----------\n  // This is the full set of types that any JSEP node can be.\n  // Store them here to save space when minified\n  COMPOUND: 'Compound',\n  SEQUENCE_EXP: 'SequenceExpression',\n  IDENTIFIER: 'Identifier',\n  MEMBER_EXP: 'MemberExpression',\n  LITERAL: 'Literal',\n  THIS_EXP: 'ThisExpression',\n  CALL_EXP: 'CallExpression',\n  UNARY_EXP: 'UnaryExpression',\n  BINARY_EXP: 'BinaryExpression',\n  ARRAY_EXP: 'ArrayExpression',\n  TAB_CODE: 9,\n  LF_CODE: 10,\n  CR_CODE: 13,\n  SPACE_CODE: 32,\n  PERIOD_CODE: 46,\n  // '.'\n  COMMA_CODE: 44,\n  // ','\n  SQUOTE_CODE: 39,\n  // single quote\n  DQUOTE_CODE: 34,\n  // double quotes\n  OPAREN_CODE: 40,\n  // (\n  CPAREN_CODE: 41,\n  // )\n  OBRACK_CODE: 91,\n  // [\n  CBRACK_CODE: 93,\n  // ]\n  QUMARK_CODE: 63,\n  // ?\n  SEMCOL_CODE: 59,\n  // ;\n  COLON_CODE: 58,\n  // :\n\n  // Operations\n  // ----------\n  // Use a quickly-accessible map to store all of the unary operators\n  // Values are set to `1` (it really doesn't matter)\n  unary_ops: {\n    '-': 1,\n    '!': 1,\n    '~': 1,\n    '+': 1\n  },\n  // Also use a map for the binary operations but set their values to their\n  // binary precedence for quick reference (higher number = higher precedence)\n  // see [Order of operations](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Operators/Operator_Precedence)\n  binary_ops: {\n    '||': 1,\n    '??': 1,\n    '&&': 2,\n    '|': 3,\n    '^': 4,\n    '&': 5,\n    '==': 6,\n    '!=': 6,\n    '===': 6,\n    '!==': 6,\n    '<': 7,\n    '>': 7,\n    '<=': 7,\n    '>=': 7,\n    '<<': 8,\n    '>>': 8,\n    '>>>': 8,\n    '+': 9,\n    '-': 9,\n    '*': 10,\n    '/': 10,\n    '%': 10,\n    '**': 11\n  },\n  // sets specific binary_ops as right-associative\n  right_associative: new Set(['**']),\n  // Additional valid identifier chars, apart from a-z, A-Z and 0-9 (except on the starting char)\n  additional_identifier_chars: new Set(['$', '_']),\n  // Literals\n  // ----------\n  // Store the values to return for the various literals we may encounter\n  literals: {\n    'true': true,\n    'false': false,\n    'null': null\n  },\n  // Except for `this`, which is special. This could be changed to something like `'self'` as well\n  this_str: 'this'\n});\nJsep.max_unop_len = Jsep.getMaxKeyLen(Jsep.unary_ops);\nJsep.max_binop_len = Jsep.getMaxKeyLen(Jsep.binary_ops);\n\n// Backward Compatibility:\nconst jsep = expr => new Jsep(expr).parse();\nconst stdClassProps = Object.getOwnPropertyNames(class Test {});\nObject.getOwnPropertyNames(Jsep).filter(prop => !stdClassProps.includes(prop) && jsep[prop] === undefined).forEach(m => {\n  jsep[m] = Jsep[m];\n});\njsep.Jsep = Jsep; // allows for const { Jsep } = require('jsep');\n\nconst CONDITIONAL_EXP = 'ConditionalExpression';\nvar ternary = {\n  name: 'ternary',\n  init(jsep) {\n    // Ternary expression: test ? consequent : alternate\n    jsep.hooks.add('after-expression', function gobbleTernary(env) {\n      if (env.node && this.code === jsep.QUMARK_CODE) {\n        this.index++;\n        const test = env.node;\n        const consequent = this.gobbleExpression();\n        if (!consequent) {\n          this.throwError('Expected expression');\n        }\n        this.gobbleSpaces();\n        if (this.code === jsep.COLON_CODE) {\n          this.index++;\n          const alternate = this.gobbleExpression();\n          if (!alternate) {\n            this.throwError('Expected expression');\n          }\n          env.node = {\n            type: CONDITIONAL_EXP,\n            test,\n            consequent,\n            alternate\n          };\n\n          // check for operators of higher priority than ternary (i.e. assignment)\n          // jsep sets || at 1, and assignment at 0.9, and conditional should be between them\n          if (test.operator && jsep.binary_ops[test.operator] <= 0.9) {\n            let newTest = test;\n            while (newTest.right.operator && jsep.binary_ops[newTest.right.operator] <= 0.9) {\n              newTest = newTest.right;\n            }\n            env.node.test = newTest.right;\n            newTest.right = env.node;\n            env.node = test;\n          }\n        } else {\n          this.throwError('Expected :');\n        }\n      }\n    });\n  }\n};\n\n// Add default plugins:\n\njsep.plugins.register(ternary);\n\nconst FSLASH_CODE = 47; // '/'\nconst BSLASH_CODE = 92; // '\\\\'\n\nvar index = {\n  name: 'regex',\n  init(jsep) {\n    // Regex literal: /abc123/ig\n    jsep.hooks.add('gobble-token', function gobbleRegexLiteral(env) {\n      if (this.code === FSLASH_CODE) {\n        const patternIndex = ++this.index;\n        let inCharSet = false;\n        while (this.index < this.expr.length) {\n          if (this.code === FSLASH_CODE && !inCharSet) {\n            const pattern = this.expr.slice(patternIndex, this.index);\n            let flags = '';\n            while (++this.index < this.expr.length) {\n              const code = this.code;\n              if (code >= 97 && code <= 122 // a...z\n              || code >= 65 && code <= 90 // A...Z\n              || code >= 48 && code <= 57) {\n                // 0-9\n                flags += this.char;\n              } else {\n                break;\n              }\n            }\n            let value;\n            try {\n              value = new RegExp(pattern, flags);\n            } catch (e) {\n              this.throwError(e.message);\n            }\n            env.node = {\n              type: jsep.LITERAL,\n              value,\n              raw: this.expr.slice(patternIndex - 1, this.index)\n            };\n\n            // allow . [] and () after regex: /regex/.test(a)\n            env.node = this.gobbleTokenProperty(env.node);\n            return env.node;\n          }\n          if (this.code === jsep.OBRACK_CODE) {\n            inCharSet = true;\n          } else if (inCharSet && this.code === jsep.CBRACK_CODE) {\n            inCharSet = false;\n          }\n          this.index += this.code === BSLASH_CODE ? 2 : 1;\n        }\n        this.throwError('Unclosed Regex');\n      }\n    });\n  }\n};\n\nconst PLUS_CODE = 43; // +\nconst MINUS_CODE = 45; // -\n\nconst plugin = {\n  name: 'assignment',\n  assignmentOperators: new Set(['=', '*=', '**=', '/=', '%=', '+=', '-=', '<<=', '>>=', '>>>=', '&=', '^=', '|=', '||=', '&&=', '??=']),\n  updateOperators: [PLUS_CODE, MINUS_CODE],\n  assignmentPrecedence: 0.9,\n  init(jsep) {\n    const updateNodeTypes = [jsep.IDENTIFIER, jsep.MEMBER_EXP];\n    plugin.assignmentOperators.forEach(op => jsep.addBinaryOp(op, plugin.assignmentPrecedence, true));\n    jsep.hooks.add('gobble-token', function gobbleUpdatePrefix(env) {\n      const code = this.code;\n      if (plugin.updateOperators.some(c => c === code && c === this.expr.charCodeAt(this.index + 1))) {\n        this.index += 2;\n        env.node = {\n          type: 'UpdateExpression',\n          operator: code === PLUS_CODE ? '++' : '--',\n          argument: this.gobbleTokenProperty(this.gobbleIdentifier()),\n          prefix: true\n        };\n        if (!env.node.argument || !updateNodeTypes.includes(env.node.argument.type)) {\n          this.throwError(`Unexpected ${env.node.operator}`);\n        }\n      }\n    });\n    jsep.hooks.add('after-token', function gobbleUpdatePostfix(env) {\n      if (env.node) {\n        const code = this.code;\n        if (plugin.updateOperators.some(c => c === code && c === this.expr.charCodeAt(this.index + 1))) {\n          if (!updateNodeTypes.includes(env.node.type)) {\n            this.throwError(`Unexpected ${env.node.operator}`);\n          }\n          this.index += 2;\n          env.node = {\n            type: 'UpdateExpression',\n            operator: code === PLUS_CODE ? '++' : '--',\n            argument: env.node,\n            prefix: false\n          };\n        }\n      }\n    });\n    jsep.hooks.add('after-expression', function gobbleAssignment(env) {\n      if (env.node) {\n        // Note: Binaries can be chained in a single expression to respect\n        // operator precedence (i.e. a = b = 1 + 2 + 3)\n        // Update all binary assignment nodes in the tree\n        updateBinariesToAssignments(env.node);\n      }\n    });\n    function updateBinariesToAssignments(node) {\n      if (plugin.assignmentOperators.has(node.operator)) {\n        node.type = 'AssignmentExpression';\n        updateBinariesToAssignments(node.left);\n        updateBinariesToAssignments(node.right);\n      } else if (!node.operator) {\n        Object.values(node).forEach(val => {\n          if (val && typeof val === 'object') {\n            updateBinariesToAssignments(val);\n          }\n        });\n      }\n    }\n  }\n};\n\n/* eslint-disable no-bitwise -- Convenient */\n\n// register plugins\njsep.plugins.register(index, plugin);\njsep.addUnaryOp('typeof');\njsep.addLiteral('null', null);\njsep.addLiteral('undefined', undefined);\nconst BLOCKED_PROTO_PROPERTIES = new Set(['constructor', '__proto__', '__defineGetter__', '__defineSetter__']);\nconst SafeEval = {\n  /**\n   * @param {jsep.Expression} ast\n   * @param {Record<string, any>} subs\n   */\n  evalAst(ast, subs) {\n    switch (ast.type) {\n      case 'BinaryExpression':\n      case 'LogicalExpression':\n        return SafeEval.evalBinaryExpression(ast, subs);\n      case 'Compound':\n        return SafeEval.evalCompound(ast, subs);\n      case 'ConditionalExpression':\n        return SafeEval.evalConditionalExpression(ast, subs);\n      case 'Identifier':\n        return SafeEval.evalIdentifier(ast, subs);\n      case 'Literal':\n        return SafeEval.evalLiteral(ast, subs);\n      case 'MemberExpression':\n        return SafeEval.evalMemberExpression(ast, subs);\n      case 'UnaryExpression':\n        return SafeEval.evalUnaryExpression(ast, subs);\n      case 'ArrayExpression':\n        return SafeEval.evalArrayExpression(ast, subs);\n      case 'CallExpression':\n        return SafeEval.evalCallExpression(ast, subs);\n      case 'AssignmentExpression':\n        return SafeEval.evalAssignmentExpression(ast, subs);\n      default:\n        throw SyntaxError('Unexpected expression', ast);\n    }\n  },\n  evalBinaryExpression(ast, subs) {\n    const result = {\n      '||': (a, b) => a || b(),\n      '&&': (a, b) => a && b(),\n      '|': (a, b) => a | b(),\n      '^': (a, b) => a ^ b(),\n      '&': (a, b) => a & b(),\n      // eslint-disable-next-line eqeqeq -- API\n      '==': (a, b) => a == b(),\n      // eslint-disable-next-line eqeqeq -- API\n      '!=': (a, b) => a != b(),\n      '===': (a, b) => a === b(),\n      '!==': (a, b) => a !== b(),\n      '<': (a, b) => a < b(),\n      '>': (a, b) => a > b(),\n      '<=': (a, b) => a <= b(),\n      '>=': (a, b) => a >= b(),\n      '<<': (a, b) => a << b(),\n      '>>': (a, b) => a >> b(),\n      '>>>': (a, b) => a >>> b(),\n      '+': (a, b) => a + b(),\n      '-': (a, b) => a - b(),\n      '*': (a, b) => a * b(),\n      '/': (a, b) => a / b(),\n      '%': (a, b) => a % b()\n    }[ast.operator](SafeEval.evalAst(ast.left, subs), () => SafeEval.evalAst(ast.right, subs));\n    return result;\n  },\n  evalCompound(ast, subs) {\n    let last;\n    for (let i = 0; i < ast.body.length; i++) {\n      if (ast.body[i].type === 'Identifier' && ['var', 'let', 'const'].includes(ast.body[i].name) && ast.body[i + 1] && ast.body[i + 1].type === 'AssignmentExpression') {\n        // var x=2; is detected as\n        // [{Identifier var}, {AssignmentExpression x=2}]\n        // eslint-disable-next-line @stylistic/max-len -- Long\n        // eslint-disable-next-line sonarjs/updated-loop-counter -- Convenient\n        i += 1;\n      }\n      const expr = ast.body[i];\n      last = SafeEval.evalAst(expr, subs);\n    }\n    return last;\n  },\n  evalConditionalExpression(ast, subs) {\n    if (SafeEval.evalAst(ast.test, subs)) {\n      return SafeEval.evalAst(ast.consequent, subs);\n    }\n    return SafeEval.evalAst(ast.alternate, subs);\n  },\n  evalIdentifier(ast, subs) {\n    if (Object.hasOwn(subs, ast.name)) {\n      return subs[ast.name];\n    }\n    throw ReferenceError(`${ast.name} is not defined`);\n  },\n  evalLiteral(ast) {\n    return ast.value;\n  },\n  evalMemberExpression(ast, subs) {\n    const prop = String(\n    // NOTE: `String(value)` throws error when\n    // value has overwritten the toString method to return non-string\n    // i.e. `value = {toString: () => []}`\n    ast.computed ? SafeEval.evalAst(ast.property) // `object[property]`\n    : ast.property.name // `object.property` property is Identifier\n    );\n    const obj = SafeEval.evalAst(ast.object, subs);\n    if (obj === undefined || obj === null) {\n      throw TypeError(`Cannot read properties of ${obj} (reading '${prop}')`);\n    }\n    if (!Object.hasOwn(obj, prop) && BLOCKED_PROTO_PROPERTIES.has(prop)) {\n      throw TypeError(`Cannot read properties of ${obj} (reading '${prop}')`);\n    }\n    const result = obj[prop];\n    if (typeof result === 'function') {\n      return result.bind(obj); // arrow functions aren't affected by bind.\n    }\n    return result;\n  },\n  evalUnaryExpression(ast, subs) {\n    const result = {\n      '-': a => -SafeEval.evalAst(a, subs),\n      '!': a => !SafeEval.evalAst(a, subs),\n      '~': a => ~SafeEval.evalAst(a, subs),\n      // eslint-disable-next-line no-implicit-coercion -- API\n      '+': a => +SafeEval.evalAst(a, subs),\n      typeof: a => typeof SafeEval.evalAst(a, subs)\n    }[ast.operator](ast.argument);\n    return result;\n  },\n  evalArrayExpression(ast, subs) {\n    return ast.elements.map(el => SafeEval.evalAst(el, subs));\n  },\n  evalCallExpression(ast, subs) {\n    const args = ast.arguments.map(arg => SafeEval.evalAst(arg, subs));\n    const func = SafeEval.evalAst(ast.callee, subs);\n    // if (func === Function) {\n    //     throw new Error('Function constructor is disabled');\n    // }\n    return func(...args);\n  },\n  evalAssignmentExpression(ast, subs) {\n    if (ast.left.type !== 'Identifier') {\n      throw SyntaxError('Invalid left-hand side in assignment');\n    }\n    const id = ast.left.name;\n    const value = SafeEval.evalAst(ast.right, subs);\n    subs[id] = value;\n    return subs[id];\n  }\n};\n\n/**\n * A replacement for NodeJS' VM.Script which is also {@link https://developer.mozilla.org/en-US/docs/Web/HTTP/CSP | Content Security Policy} friendly.\n */\nclass SafeScript {\n  /**\n   * @param {string} expr Expression to evaluate\n   */\n  constructor(expr) {\n    this.code = expr;\n    this.ast = jsep(this.code);\n  }\n\n  /**\n   * @param {object} context Object whose items will be added\n   *   to evaluation\n   * @returns {EvaluatedResult} Result of evaluated code\n   */\n  runInNewContext(context) {\n    // `Object.create(null)` creates a prototypeless object\n    const keyMap = Object.assign(Object.create(null), context);\n    return SafeEval.evalAst(this.ast, keyMap);\n  }\n}\n\n/* eslint-disable camelcase -- Convenient for escaping */\n\n\n/**\n * @typedef {null|boolean|number|string|object|GenericArray} JSONObject\n */\n\n/**\n * @typedef {any} AnyItem\n */\n\n/**\n * @typedef {any} AnyResult\n */\n\n/**\n * Copies array and then pushes item into it.\n * @param {GenericArray} arr Array to copy and into which to push\n * @param {AnyItem} item Array item to add (to end)\n * @returns {GenericArray} Copy of the original array\n */\nfunction push(arr, item) {\n  arr = arr.slice();\n  arr.push(item);\n  return arr;\n}\n/**\n * Copies array and then unshifts item into it.\n * @param {AnyItem} item Array item to add (to beginning)\n * @param {GenericArray} arr Array to copy and into which to unshift\n * @returns {GenericArray} Copy of the original array\n */\nfunction unshift(item, arr) {\n  arr = arr.slice();\n  arr.unshift(item);\n  return arr;\n}\n\n/**\n * Caught when JSONPath is used without `new` but rethrown if with `new`\n * @extends Error\n */\nclass NewError extends Error {\n  /**\n   * @param {AnyResult} value The evaluated scalar value\n   */\n  constructor(value) {\n    super('JSONPath should not be called with \"new\" (it prevents return ' + 'of (unwrapped) scalar values)');\n    this.avoidNew = true;\n    this.value = value;\n    this.name = 'NewError';\n  }\n}\n\n/**\n* @typedef {object} ReturnObject\n* @property {string} path\n* @property {JSONObject} value\n* @property {object|GenericArray} parent\n* @property {string} parentProperty\n*/\n\n/**\n* @callback JSONPathCallback\n* @param {string|object} preferredOutput\n* @param {\"value\"|\"property\"} type\n* @param {ReturnObject} fullRetObj\n* @returns {void}\n*/\n\n/**\n* @callback OtherTypeCallback\n* @param {JSONObject} val\n* @param {string} path\n* @param {object|GenericArray} parent\n* @param {string} parentPropName\n* @returns {boolean}\n*/\n\n/**\n * @typedef {any} ContextItem\n */\n\n/**\n * @typedef {any} EvaluatedResult\n */\n\n/**\n* @callback EvalCallback\n* @param {string} code\n* @param {ContextItem} context\n* @returns {EvaluatedResult}\n*/\n\n/**\n * @typedef {typeof SafeScript} EvalClass\n */\n\n/**\n * @typedef {object} JSONPathOptions\n * @property {JSON} json\n * @property {string|string[]} path\n * @property {\"value\"|\"path\"|\"pointer\"|\"parent\"|\"parentProperty\"|\n *   \"all\"} [resultType=\"value\"]\n * @property {boolean} [flatten=false]\n * @property {boolean} [wrap=true]\n * @property {object} [sandbox={}]\n * @property {EvalCallback|EvalClass|'safe'|'native'|\n *   boolean} [eval = 'safe']\n * @property {object|GenericArray|null} [parent=null]\n * @property {string|null} [parentProperty=null]\n * @property {JSONPathCallback} [callback]\n * @property {OtherTypeCallback} [otherTypeCallback] Defaults to\n *   function which throws on encountering `@other`\n * @property {boolean} [autostart=true]\n */\n\n/**\n * @param {string|JSONPathOptions} opts If a string, will be treated as `expr`\n * @param {string} [expr] JSON path to evaluate\n * @param {JSON} [obj] JSON object to evaluate against\n * @param {JSONPathCallback} [callback] Passed 3 arguments: 1) desired payload\n *     per `resultType`, 2) `\"value\"|\"property\"`, 3) Full returned object with\n *     all payloads\n * @param {OtherTypeCallback} [otherTypeCallback] If `@other()` is at the end\n *   of one's query, this will be invoked with the value of the item, its\n *   path, its parent, and its parent's property name, and it should return\n *   a boolean indicating whether the supplied value belongs to the \"other\"\n *   type or not (or it may handle transformations and return `false`).\n * @returns {JSONPath}\n * @class\n */\nfunction JSONPath(opts, expr, obj, callback, otherTypeCallback) {\n  // eslint-disable-next-line no-restricted-syntax -- Allow for pseudo-class\n  if (!(this instanceof JSONPath)) {\n    try {\n      return new JSONPath(opts, expr, obj, callback, otherTypeCallback);\n    } catch (e) {\n      if (!e.avoidNew) {\n        throw e;\n      }\n      return e.value;\n    }\n  }\n  if (typeof opts === 'string') {\n    otherTypeCallback = callback;\n    callback = obj;\n    obj = expr;\n    expr = opts;\n    opts = null;\n  }\n  const optObj = opts && typeof opts === 'object';\n  opts = opts || {};\n  this.json = opts.json || obj;\n  this.path = opts.path || expr;\n  this.resultType = opts.resultType || 'value';\n  this.flatten = opts.flatten || false;\n  this.wrap = Object.hasOwn(opts, 'wrap') ? opts.wrap : true;\n  this.sandbox = opts.sandbox || {};\n  this.eval = opts.eval === undefined ? 'safe' : opts.eval;\n  this.ignoreEvalErrors = typeof opts.ignoreEvalErrors === 'undefined' ? false : opts.ignoreEvalErrors;\n  this.parent = opts.parent || null;\n  this.parentProperty = opts.parentProperty || null;\n  this.callback = opts.callback || callback || null;\n  this.otherTypeCallback = opts.otherTypeCallback || otherTypeCallback || function () {\n    throw new TypeError('You must supply an otherTypeCallback callback option ' + 'with the @other() operator.');\n  };\n  if (opts.autostart !== false) {\n    const args = {\n      path: optObj ? opts.path : expr\n    };\n    if (!optObj) {\n      args.json = obj;\n    } else if ('json' in opts) {\n      args.json = opts.json;\n    }\n    const ret = this.evaluate(args);\n    if (!ret || typeof ret !== 'object') {\n      throw new NewError(ret);\n    }\n    return ret;\n  }\n}\n\n// PUBLIC METHODS\nJSONPath.prototype.evaluate = function (expr, json, callback, otherTypeCallback) {\n  let currParent = this.parent,\n    currParentProperty = this.parentProperty;\n  let {\n    flatten,\n    wrap\n  } = this;\n  this.currResultType = this.resultType;\n  this.currEval = this.eval;\n  this.currSandbox = this.sandbox;\n  callback = callback || this.callback;\n  this.currOtherTypeCallback = otherTypeCallback || this.otherTypeCallback;\n  json = json || this.json;\n  expr = expr || this.path;\n  if (expr && typeof expr === 'object' && !Array.isArray(expr)) {\n    if (!expr.path && expr.path !== '') {\n      throw new TypeError('You must supply a \"path\" property when providing an object ' + 'argument to JSONPath.evaluate().');\n    }\n    if (!Object.hasOwn(expr, 'json')) {\n      throw new TypeError('You must supply a \"json\" property when providing an object ' + 'argument to JSONPath.evaluate().');\n    }\n    ({\n      json\n    } = expr);\n    flatten = Object.hasOwn(expr, 'flatten') ? expr.flatten : flatten;\n    this.currResultType = Object.hasOwn(expr, 'resultType') ? expr.resultType : this.currResultType;\n    this.currSandbox = Object.hasOwn(expr, 'sandbox') ? expr.sandbox : this.currSandbox;\n    wrap = Object.hasOwn(expr, 'wrap') ? expr.wrap : wrap;\n    this.currEval = Object.hasOwn(expr, 'eval') ? expr.eval : this.currEval;\n    callback = Object.hasOwn(expr, 'callback') ? expr.callback : callback;\n    this.currOtherTypeCallback = Object.hasOwn(expr, 'otherTypeCallback') ? expr.otherTypeCallback : this.currOtherTypeCallback;\n    currParent = Object.hasOwn(expr, 'parent') ? expr.parent : currParent;\n    currParentProperty = Object.hasOwn(expr, 'parentProperty') ? expr.parentProperty : currParentProperty;\n    expr = expr.path;\n  }\n  currParent = currParent || null;\n  currParentProperty = currParentProperty || null;\n  if (Array.isArray(expr)) {\n    expr = JSONPath.toPathString(expr);\n  }\n  if (!expr && expr !== '' || !json) {\n    return undefined;\n  }\n  const exprList = JSONPath.toPathArray(expr);\n  if (exprList[0] === '$' && exprList.length > 1) {\n    exprList.shift();\n  }\n  this._hasParentSelector = null;\n  const result = this._trace(exprList, json, ['$'], currParent, currParentProperty, callback).filter(function (ea) {\n    return ea && !ea.isParentSelector;\n  });\n  if (!result.length) {\n    return wrap ? [] : undefined;\n  }\n  if (!wrap && result.length === 1 && !result[0].hasArrExpr) {\n    return this._getPreferredOutput(result[0]);\n  }\n  return result.reduce((rslt, ea) => {\n    const valOrPath = this._getPreferredOutput(ea);\n    if (flatten && Array.isArray(valOrPath)) {\n      rslt = rslt.concat(valOrPath);\n    } else {\n      rslt.push(valOrPath);\n    }\n    return rslt;\n  }, []);\n};\n\n// PRIVATE METHODS\n\nJSONPath.prototype._getPreferredOutput = function (ea) {\n  const resultType = this.currResultType;\n  switch (resultType) {\n    case 'all':\n      {\n        const path = Array.isArray(ea.path) ? ea.path : JSONPath.toPathArray(ea.path);\n        ea.pointer = JSONPath.toPointer(path);\n        ea.path = typeof ea.path === 'string' ? ea.path : JSONPath.toPathString(ea.path);\n        return ea;\n      }\n    case 'value':\n    case 'parent':\n    case 'parentProperty':\n      return ea[resultType];\n    case 'path':\n      return JSONPath.toPathString(ea[resultType]);\n    case 'pointer':\n      return JSONPath.toPointer(ea.path);\n    default:\n      throw new TypeError('Unknown result type');\n  }\n};\nJSONPath.prototype._handleCallback = function (fullRetObj, callback, type) {\n  if (callback) {\n    const preferredOutput = this._getPreferredOutput(fullRetObj);\n    fullRetObj.path = typeof fullRetObj.path === 'string' ? fullRetObj.path : JSONPath.toPathString(fullRetObj.path);\n    // eslint-disable-next-line n/callback-return -- No need to return\n    callback(preferredOutput, type, fullRetObj);\n  }\n};\n\n/**\n *\n * @param {string} expr\n * @param {JSONObject} val\n * @param {string} path\n * @param {object|GenericArray} parent\n * @param {string} parentPropName\n * @param {JSONPathCallback} callback\n * @param {boolean} hasArrExpr\n * @param {boolean} literalPriority\n * @returns {ReturnObject|ReturnObject[]}\n */\nJSONPath.prototype._trace = function (expr, val, path, parent, parentPropName, callback, hasArrExpr, literalPriority) {\n  // No expr to follow? return path and value as the result of\n  //  this trace branch\n  let retObj;\n  if (!expr.length) {\n    retObj = {\n      path,\n      value: val,\n      parent,\n      parentProperty: parentPropName,\n      hasArrExpr\n    };\n    this._handleCallback(retObj, callback, 'value');\n    return retObj;\n  }\n  const loc = expr[0],\n    x = expr.slice(1);\n\n  // We need to gather the return value of recursive trace calls in order to\n  // do the parent sel computation.\n  const ret = [];\n  /**\n   *\n   * @param {ReturnObject|ReturnObject[]} elems\n   * @returns {void}\n   */\n  function addRet(elems) {\n    if (Array.isArray(elems)) {\n      // This was causing excessive stack size in Node (with or\n      //  without Babel) against our performance test:\n      //  `ret.push(...elems);`\n      elems.forEach(t => {\n        ret.push(t);\n      });\n    } else {\n      ret.push(elems);\n    }\n  }\n  if ((typeof loc !== 'string' || literalPriority) && val && Object.hasOwn(val, loc)) {\n    // simple case--directly follow property\n    addRet(this._trace(x, val[loc], push(path, loc), val, loc, callback, hasArrExpr));\n    // eslint-disable-next-line unicorn/prefer-switch -- Part of larger `if`\n  } else if (loc === '*') {\n    // all child properties\n    this._walk(val, m => {\n      addRet(this._trace(x, val[m], push(path, m), val, m, callback, true, true));\n    });\n  } else if (loc === '..') {\n    // all descendent parent properties\n    // Check remaining expression with val's immediate children\n    addRet(this._trace(x, val, path, parent, parentPropName, callback, hasArrExpr));\n    this._walk(val, m => {\n      // We don't join m and x here because we only want parents,\n      //   not scalar values\n      if (typeof val[m] === 'object') {\n        // Keep going with recursive descent on val's\n        //   object children\n        addRet(this._trace(expr.slice(), val[m], push(path, m), val, m, callback, true));\n      }\n    });\n    // The parent sel computation is handled in the frame above using the\n    // ancestor object of val\n  } else if (loc === '^') {\n    // This is not a final endpoint, so we do not invoke the callback here\n    this._hasParentSelector = true;\n    return {\n      path: path.slice(0, -1),\n      expr: x,\n      isParentSelector: true\n    };\n  } else if (loc === '~') {\n    // property name\n    retObj = {\n      path: push(path, loc),\n      value: parentPropName,\n      parent,\n      parentProperty: null\n    };\n    this._handleCallback(retObj, callback, 'property');\n    return retObj;\n  } else if (loc === '$') {\n    // root only\n    addRet(this._trace(x, val, path, null, null, callback, hasArrExpr));\n  } else if (/^(-?\\d*):(-?\\d*):?(\\d*)$/u.test(loc)) {\n    // [start:end:step]  Python slice syntax\n    addRet(this._slice(loc, x, val, path, parent, parentPropName, callback));\n  } else if (loc.indexOf('?(') === 0) {\n    // [?(expr)] (filtering)\n    if (this.currEval === false) {\n      throw new Error('Eval [?(expr)] prevented in JSONPath expression.');\n    }\n    const safeLoc = loc.replace(/^\\?\\((.*?)\\)$/u, '$1');\n    // check for a nested filter expression\n    const nested = /@.?([^?]*)[['](\\??\\(.*?\\))(?!.\\)\\])[\\]']/gu.exec(safeLoc);\n    if (nested) {\n      // find if there are matches in the nested expression\n      // add them to the result set if there is at least one match\n      this._walk(val, m => {\n        const npath = [nested[2]];\n        const nvalue = nested[1] ? val[m][nested[1]] : val[m];\n        const filterResults = this._trace(npath, nvalue, path, parent, parentPropName, callback, true);\n        if (filterResults.length > 0) {\n          addRet(this._trace(x, val[m], push(path, m), val, m, callback, true));\n        }\n      });\n    } else {\n      this._walk(val, m => {\n        if (this._eval(safeLoc, val[m], m, path, parent, parentPropName)) {\n          addRet(this._trace(x, val[m], push(path, m), val, m, callback, true));\n        }\n      });\n    }\n  } else if (loc[0] === '(') {\n    // [(expr)] (dynamic property/index)\n    if (this.currEval === false) {\n      throw new Error('Eval [(expr)] prevented in JSONPath expression.');\n    }\n    // As this will resolve to a property name (but we don't know it\n    //  yet), property and parent information is relative to the\n    //  parent of the property to which this expression will resolve\n    addRet(this._trace(unshift(this._eval(loc, val, path.at(-1), path.slice(0, -1), parent, parentPropName), x), val, path, parent, parentPropName, callback, hasArrExpr));\n  } else if (loc[0] === '@') {\n    // value type: @boolean(), etc.\n    let addType = false;\n    const valueType = loc.slice(1, -2);\n    switch (valueType) {\n      case 'scalar':\n        if (!val || !['object', 'function'].includes(typeof val)) {\n          addType = true;\n        }\n        break;\n      case 'boolean':\n      case 'string':\n      case 'undefined':\n      case 'function':\n        if (typeof val === valueType) {\n          addType = true;\n        }\n        break;\n      case 'integer':\n        if (Number.isFinite(val) && !(val % 1)) {\n          addType = true;\n        }\n        break;\n      case 'number':\n        if (Number.isFinite(val)) {\n          addType = true;\n        }\n        break;\n      case 'nonFinite':\n        if (typeof val === 'number' && !Number.isFinite(val)) {\n          addType = true;\n        }\n        break;\n      case 'object':\n        if (val && typeof val === valueType) {\n          addType = true;\n        }\n        break;\n      case 'array':\n        if (Array.isArray(val)) {\n          addType = true;\n        }\n        break;\n      case 'other':\n        addType = this.currOtherTypeCallback(val, path, parent, parentPropName);\n        break;\n      case 'null':\n        if (val === null) {\n          addType = true;\n        }\n        break;\n      /* c8 ignore next 2 */\n      default:\n        throw new TypeError('Unknown value type ' + valueType);\n    }\n    if (addType) {\n      retObj = {\n        path,\n        value: val,\n        parent,\n        parentProperty: parentPropName\n      };\n      this._handleCallback(retObj, callback, 'value');\n      return retObj;\n    }\n    // `-escaped property\n  } else if (loc[0] === '`' && val && Object.hasOwn(val, loc.slice(1))) {\n    const locProp = loc.slice(1);\n    addRet(this._trace(x, val[locProp], push(path, locProp), val, locProp, callback, hasArrExpr, true));\n  } else if (loc.includes(',')) {\n    // [name1,name2,...]\n    const parts = loc.split(',');\n    for (const part of parts) {\n      addRet(this._trace(unshift(part, x), val, path, parent, parentPropName, callback, true));\n    }\n    // simple case--directly follow property\n  } else if (!literalPriority && val && Object.hasOwn(val, loc)) {\n    addRet(this._trace(x, val[loc], push(path, loc), val, loc, callback, hasArrExpr, true));\n  }\n\n  // We check the resulting values for parent selections. For parent\n  // selections we discard the value object and continue the trace with the\n  // current val object\n  if (this._hasParentSelector) {\n    for (let t = 0; t < ret.length; t++) {\n      const rett = ret[t];\n      if (rett && rett.isParentSelector) {\n        const tmp = this._trace(rett.expr, val, rett.path, parent, parentPropName, callback, hasArrExpr);\n        if (Array.isArray(tmp)) {\n          ret[t] = tmp[0];\n          const tl = tmp.length;\n          for (let tt = 1; tt < tl; tt++) {\n            // eslint-disable-next-line @stylistic/max-len -- Long\n            // eslint-disable-next-line sonarjs/updated-loop-counter -- Convenient\n            t++;\n            ret.splice(t, 0, tmp[tt]);\n          }\n        } else {\n          ret[t] = tmp;\n        }\n      }\n    }\n  }\n  return ret;\n};\nJSONPath.prototype._walk = function (val, f) {\n  if (Array.isArray(val)) {\n    const n = val.length;\n    for (let i = 0; i < n; i++) {\n      f(i);\n    }\n  } else if (val && typeof val === 'object') {\n    Object.keys(val).forEach(m => {\n      f(m);\n    });\n  }\n};\nJSONPath.prototype._slice = function (loc, expr, val, path, parent, parentPropName, callback) {\n  if (!Array.isArray(val)) {\n    return undefined;\n  }\n  const len = val.length,\n    parts = loc.split(':'),\n    step = parts[2] && Number.parseInt(parts[2]) || 1;\n  let start = parts[0] && Number.parseInt(parts[0]) || 0,\n    end = parts[1] && Number.parseInt(parts[1]) || len;\n  start = start < 0 ? Math.max(0, start + len) : Math.min(len, start);\n  end = end < 0 ? Math.max(0, end + len) : Math.min(len, end);\n  const ret = [];\n  for (let i = start; i < end; i += step) {\n    const tmp = this._trace(unshift(i, expr), val, path, parent, parentPropName, callback, true);\n    // Should only be possible to be an array here since first part of\n    //   ``unshift(i, expr)` passed in above would not be empty, nor `~`,\n    //     nor begin with `@` (as could return objects)\n    // This was causing excessive stack size in Node (with or\n    //  without Babel) against our performance test: `ret.push(...tmp);`\n    tmp.forEach(t => {\n      ret.push(t);\n    });\n  }\n  return ret;\n};\nJSONPath.prototype._eval = function (code, _v, _vname, path, parent, parentPropName) {\n  this.currSandbox._$_parentProperty = parentPropName;\n  this.currSandbox._$_parent = parent;\n  this.currSandbox._$_property = _vname;\n  this.currSandbox._$_root = this.json;\n  this.currSandbox._$_v = _v;\n  const containsPath = code.includes('@path');\n  if (containsPath) {\n    this.currSandbox._$_path = JSONPath.toPathString(path.concat([_vname]));\n  }\n  const scriptCacheKey = this.currEval + 'Script:' + code;\n  if (!JSONPath.cache[scriptCacheKey]) {\n    let script = code.replaceAll('@parentProperty', '_$_parentProperty').replaceAll('@parent', '_$_parent').replaceAll('@property', '_$_property').replaceAll('@root', '_$_root').replaceAll(/@([.\\s)[])/gu, '_$_v$1');\n    if (containsPath) {\n      script = script.replaceAll('@path', '_$_path');\n    }\n    if (this.currEval === 'safe' || this.currEval === true || this.currEval === undefined) {\n      JSONPath.cache[scriptCacheKey] = new this.safeVm.Script(script);\n    } else if (this.currEval === 'native') {\n      JSONPath.cache[scriptCacheKey] = new this.vm.Script(script);\n    } else if (typeof this.currEval === 'function' && this.currEval.prototype && Object.hasOwn(this.currEval.prototype, 'runInNewContext')) {\n      const CurrEval = this.currEval;\n      JSONPath.cache[scriptCacheKey] = new CurrEval(script);\n    } else if (typeof this.currEval === 'function') {\n      JSONPath.cache[scriptCacheKey] = {\n        runInNewContext: context => this.currEval(script, context)\n      };\n    } else {\n      throw new TypeError(`Unknown \"eval\" property \"${this.currEval}\"`);\n    }\n  }\n  try {\n    return JSONPath.cache[scriptCacheKey].runInNewContext(this.currSandbox);\n  } catch (e) {\n    if (this.ignoreEvalErrors) {\n      return false;\n    }\n    throw new Error('jsonPath: ' + e.message + ': ' + code);\n  }\n};\n\n// PUBLIC CLASS PROPERTIES AND METHODS\n\n// Could store the cache object itself\nJSONPath.cache = {};\n\n/**\n * @param {string[]} pathArr Array to convert\n * @returns {string} The path string\n */\nJSONPath.toPathString = function (pathArr) {\n  const x = pathArr,\n    n = x.length;\n  let p = '$';\n  for (let i = 1; i < n; i++) {\n    if (!/^(~|\\^|@.*?\\(\\))$/u.test(x[i])) {\n      p += /^[0-9*]+$/u.test(x[i]) ? '[' + x[i] + ']' : \"['\" + x[i] + \"']\";\n    }\n  }\n  return p;\n};\n\n/**\n * @param {string} pointer JSON Path\n * @returns {string} JSON Pointer\n */\nJSONPath.toPointer = function (pointer) {\n  const x = pointer,\n    n = x.length;\n  let p = '';\n  for (let i = 1; i < n; i++) {\n    if (!/^(~|\\^|@.*?\\(\\))$/u.test(x[i])) {\n      p += '/' + x[i].toString().replaceAll('~', '~0').replaceAll('/', '~1');\n    }\n  }\n  return p;\n};\n\n/**\n * @param {string} expr Expression to convert\n * @returns {string[]}\n */\nJSONPath.toPathArray = function (expr) {\n  const {\n    cache\n  } = JSONPath;\n  if (cache[expr]) {\n    return cache[expr].concat();\n  }\n  const subx = [];\n  const normalized = expr\n  // Properties\n  .replaceAll(/@(?:null|boolean|number|string|integer|undefined|nonFinite|scalar|array|object|function|other)\\(\\)/gu, ';$&;')\n  // Parenthetical evaluations (filtering and otherwise), directly\n  //   within brackets or single quotes\n  .replaceAll(/[['](\\??\\(.*?\\))[\\]'](?!.\\])/gu, function ($0, $1) {\n    return '[#' + (subx.push($1) - 1) + ']';\n  })\n  // Escape periods and tildes within properties\n  .replaceAll(/\\[['\"]([^'\\]]*)['\"]\\]/gu, function ($0, prop) {\n    return \"['\" + prop.replaceAll('.', '%@%').replaceAll('~', '%%@@%%') + \"']\";\n  })\n  // Properties operator\n  .replaceAll('~', ';~;')\n  // Split by property boundaries\n  .replaceAll(/['\"]?\\.['\"]?(?![^[]*\\])|\\[['\"]?/gu, ';')\n  // Reinsert periods within properties\n  .replaceAll('%@%', '.')\n  // Reinsert tildes within properties\n  .replaceAll('%%@@%%', '~')\n  // Parent\n  .replaceAll(/(?:;)?(\\^+)(?:;)?/gu, function ($0, ups) {\n    return ';' + ups.split('').join(';') + ';';\n  })\n  // Descendents\n  .replaceAll(/;;;|;;/gu, ';..;')\n  // Remove trailing\n  .replaceAll(/;$|'?\\]|'$/gu, '');\n  const exprList = normalized.split(';').map(function (exp) {\n    const match = exp.match(/#(\\d+)/u);\n    return !match || !match[1] ? exp : subx[match[1]];\n  });\n  cache[expr] = exprList;\n  return cache[expr].concat();\n};\nJSONPath.prototype.safeVm = {\n  Script: SafeScript\n};\n\n/**\n * @typedef {any} ContextItem\n */\n\n/**\n * @typedef {any} EvaluatedResult\n */\n\n/**\n * @callback ConditionCallback\n * @param {ContextItem} item\n * @returns {boolean}\n */\n\n/**\n * Copy items out of one array into another.\n * @param {GenericArray} source Array with items to copy\n * @param {GenericArray} target Array to which to copy\n * @param {ConditionCallback} conditionCb Callback passed the current item;\n *     will move item if evaluates to `true`\n * @returns {void}\n */\nconst moveToAnotherArray = function (source, target, conditionCb) {\n  const il = source.length;\n  for (let i = 0; i < il; i++) {\n    const item = source[i];\n    if (conditionCb(item)) {\n      // eslint-disable-next-line @stylistic/max-len -- Long\n      // eslint-disable-next-line sonarjs/updated-loop-counter -- Convenient\n      target.push(source.splice(i--, 1)[0]);\n    }\n  }\n};\n\n/**\n * In-browser replacement for NodeJS' VM.Script.\n */\nclass Script {\n  /**\n   * @param {string} expr Expression to evaluate\n   */\n  constructor(expr) {\n    this.code = expr;\n  }\n\n  /**\n   * @param {object} context Object whose items will be added\n   *   to evaluation\n   * @returns {EvaluatedResult} Result of evaluated code\n   */\n  runInNewContext(context) {\n    let expr = this.code;\n    const keys = Object.keys(context);\n    const funcs = [];\n    moveToAnotherArray(keys, funcs, key => {\n      return typeof context[key] === 'function';\n    });\n    const values = keys.map(vr => {\n      return context[vr];\n    });\n    const funcString = funcs.reduce((s, func) => {\n      let fString = context[func].toString();\n      if (!/function/u.test(fString)) {\n        fString = 'function ' + fString;\n      }\n      return 'var ' + func + '=' + fString + ';' + s;\n    }, '');\n    expr = funcString + expr;\n\n    // Mitigate http://perfectionkills.com/global-eval-what-are-the-options/#new_function\n    if (!/(['\"])use strict\\1/u.test(expr) && !keys.includes('arguments')) {\n      expr = 'var arguments = undefined;' + expr;\n    }\n\n    // Remove last semi so `return` will be inserted before\n    //  the previous one instead, allowing for the return\n    //  of a bare ending expression\n    expr = expr.replace(/;\\s*$/u, '');\n\n    // Insert `return`\n    const lastStatementEnd = expr.lastIndexOf(';');\n    const code = lastStatementEnd !== -1 ? expr.slice(0, lastStatementEnd + 1) + ' return ' + expr.slice(lastStatementEnd + 1) : ' return ' + expr;\n\n    // eslint-disable-next-line no-new-func -- User's choice\n    return new Function(...keys, code)(...values);\n  }\n}\nJSONPath.prototype.vm = {\n  Script\n};\n\nexport { JSONPath };\n","// JSONPath search utility for debug panels\n// Supports both simple key matching and complex JSONPath expressions like \"profile.roles[0].label\"\n\nimport { JSONPath } from 'jsonpath-plus';\n\nexport type SearchMode = 'simple' | 'jsonpath';\n\nexport type SearchResult = {\n  path: string;\n  value: unknown;\n};\n\n/**\n * Detect if a search string is a JSONPath expression\n * JSONPath expressions start with $ or contain path-like syntax (dots, brackets)\n */\nexport function isJsonPathExpression(search: string): boolean {\n  if (!search) return false;\n  // Starts with $ (explicit JSONPath)\n  if (search.startsWith('$')) return true;\n  // Contains array bracket notation like [0] or ['key']\n  if (/\\[\\d+\\]/.test(search) || /\\[['\"]/.test(search)) return true;\n  // Contains dot notation with at least one segment (a.b but not \"a.\")\n  if (/^[a-zA-Z_][a-zA-Z0-9_]*(\\.[a-zA-Z_][a-zA-Z0-9_]*)+$/.test(search)) return true;\n  // Contains wildcard or recursive descent\n  if (search.includes('..') || search.includes('*')) return true;\n  return false;\n}\n\n/**\n * Normalize a search string to a valid JSONPath expression\n */\nexport function normalizeToJsonPath(search: string): string {\n  if (!search) return '$';\n  // Already a JSONPath expression\n  if (search.startsWith('$')) return search;\n  // Prepend $. for path-like expressions\n  return `$.${search}`;\n}\n\n/**\n * Search an object using JSONPath and return matching paths with values\n */\nexport function searchWithJsonPath(\n  data: unknown,\n  expression: string\n): SearchResult[] {\n  if (!data || !expression) return [];\n\n  try {\n    const normalizedExpr = normalizeToJsonPath(expression);\n    const results = JSONPath({\n      path: normalizedExpr,\n      json: data as object,\n      resultType: 'all',\n    });\n\n    return (results || []).map((result: { path: string; value: unknown }) => ({\n      path: result.path || '',\n      value: result.value,\n    }));\n  } catch {\n    // Invalid expression, return empty\n    return [];\n  }\n}\n\n/**\n * Filter an object to only include keys/paths matching the search\n * For simple searches, matches keys containing the search string\n * For JSONPath expressions, extracts matching subtrees\n */\nexport function filterObjectBySearch(\n  data: Record<string, unknown>,\n  search: string\n): Record<string, unknown> {\n  if (!search || !data) {\n    return data || {};\n  }\n\n  // Detect search mode\n  const isJPath = isJsonPathExpression(search);\n  console.log('[jsonpath-search] search:', search, 'isJsonPath:', isJPath);\n\n  if (isJPath) {\n    const result = filterByJsonPath(data, search);\n    console.log('[jsonpath-search] JSONPath result:', result);\n    return result;\n  }\n\n  // Simple key matching (original behavior)\n  const result = filterByKeyMatch(data, search);\n  console.log('[jsonpath-search] key match result:', result);\n  return result;\n}\n\n/**\n * Simple key matching - filters top-level keys containing the search string\n */\nfunction filterByKeyMatch(\n  data: Record<string, unknown>,\n  search: string\n): Record<string, unknown> {\n  const needle = search.toLowerCase();\n  const out: Record<string, unknown> = {};\n\n  for (const [key, value] of Object.entries(data || {})) {\n    if (key.toLowerCase().includes(needle)) {\n      out[key] = value;\n    }\n  }\n\n  return out;\n}\n\n/**\n * JSONPath filtering - extracts matching subtrees preserving structure\n */\nfunction filterByJsonPath(\n  data: Record<string, unknown>,\n  expression: string\n): Record<string, unknown> {\n  const results = searchWithJsonPath(data, expression);\n\n  if (results.length === 0) {\n    return {};\n  }\n\n  // If single result and it's a primitive, wrap it\n  if (results.length === 1) {\n    const { path, value } = results[0];\n    // If the path is just \"$\", return the whole value\n    if (path === '$' && typeof value === 'object' && value !== null) {\n      return value as Record<string, unknown>;\n    }\n    // For simple paths, return the value directly if it's an object\n    if (typeof value === 'object' && value !== null && !Array.isArray(value)) {\n      return value as Record<string, unknown>;\n    }\n    // For arrays or primitives, wrap in a result object\n    return { [extractLastPathSegment(path)]: value };\n  }\n\n  // Multiple results - build a results object\n  const out: Record<string, unknown> = {};\n  for (const { path, value } of results) {\n    const key = extractLastPathSegment(path) || `result_${Object.keys(out).length}`;\n    // Avoid key collisions by appending index\n    if (key in out) {\n      out[`${key}_${Object.keys(out).length}`] = value;\n    } else {\n      out[key] = value;\n    }\n  }\n\n  return out;\n}\n\n/**\n * Extract the last segment from a JSONPath path string\n * e.g., \"$['profile']['roles'][0]['label']\" -> \"label\"\n */\nfunction extractLastPathSegment(path: string): string {\n  if (!path) return '';\n\n  // Match the last bracket segment\n  const bracketMatch = path.match(/\\[['\"]?([^'\"[\\]]+)['\"]?\\]$/);\n  if (bracketMatch) {\n    return bracketMatch[1];\n  }\n\n  // Match dot notation at the end\n  const dotMatch = path.match(/\\.([^.[\\]]+)$/);\n  if (dotMatch) {\n    return dotMatch[1];\n  }\n\n  return path.replace(/^\\$\\.?/, '');\n}\n\n/**\n * Check if a search matches anywhere in the object (deep search)\n * Used for filtering arrays of objects\n */\nexport function objectMatchesSearch(\n  data: unknown,\n  search: string\n): boolean {\n  if (!search || data === null || data === undefined) {\n    return !search;\n  }\n\n  if (isJsonPathExpression(search)) {\n    const results = searchWithJsonPath(data, search);\n    return results.length > 0;\n  }\n\n  // Simple text search - check if search appears anywhere in stringified JSON\n  const needle = search.toLowerCase();\n  const haystack = JSON.stringify(data).toLowerCase();\n  return haystack.includes(needle);\n}\n\n/**\n * Get a value from an object using a path string\n * Supports dot notation and bracket notation\n * e.g., \"profile.roles[0].label\"\n */\nexport function getByPath(data: unknown, path: string): unknown {\n  if (!data || !path) return undefined;\n\n  try {\n    const results = searchWithJsonPath(data, path);\n    return results.length > 0 ? results[0].value : undefined;\n  } catch {\n    return undefined;\n  }\n}\n\n/**\n * Get all paths in an object (for autocomplete suggestions)\n */\nexport function getAllPaths(\n  data: unknown,\n  maxDepth = 5,\n  prefix = ''\n): string[] {\n  const paths: string[] = [];\n\n  if (maxDepth <= 0 || data === null || data === undefined) {\n    return paths;\n  }\n\n  if (Array.isArray(data)) {\n    // Add array indices\n    data.slice(0, 10).forEach((item, index) => {\n      const itemPath = prefix ? `${prefix}[${index}]` : `[${index}]`;\n      paths.push(itemPath);\n      paths.push(...getAllPaths(item, maxDepth - 1, itemPath));\n    });\n    if (data.length > 10) {\n      paths.push(prefix ? `${prefix}[...]` : '[...]');\n    }\n  } else if (typeof data === 'object') {\n    for (const [key, value] of Object.entries(data as Record<string, unknown>)) {\n      const keyPath = prefix ? `${prefix}.${key}` : key;\n      paths.push(keyPath);\n      paths.push(...getAllPaths(value, maxDepth - 1, keyPath));\n    }\n  }\n\n  return paths;\n}\n","import { DebugStream, type DebugEvent, type DebugStreamStatus } from './debug-stream.js';\nimport { DebugReplPanel, type DebugReplCommand } from './repl/repl-panel.js';\nimport { filterObjectBySearch } from './shared/jsonpath-search.js';\nimport type {\n  RequestEntry,\n  SQLEntry,\n  LogEntry,\n  RouteEntry,\n  CustomLogEntry,\n  DebugSnapshot,\n  DebugUserSession,\n} from './shared/types.js';\nimport {\n  escapeHTML,\n  formatJSON,\n  formatTimestamp,\n  formatNumber,\n  countPayload,\n  isSlowDuration,\n  ensureArray,\n} from './shared/utils.js';\nimport {\n  attachCopyListeners,\n  attachExpandableRowListeners,\n  attachSQLSelectionListeners,\n  attachRequestDetailListeners,\n} from './shared/interactions.js';\nimport { consoleStyles } from './shared/styles.js';\nimport {\n  renderRequestsPanel,\n  renderSQLPanel,\n  renderLogsPanel,\n  renderRoutesPanel,\n  renderJSONPanel as renderSharedJSONPanel,\n  renderCustomPanel,\n  renderJSErrorsPanel,\n} from './shared/panels/index.js';\nimport {\n  panelRegistry,\n  getSnapshotKey,\n  normalizeEventTypes,\n  defaultHandleEvent,\n  getPanelCount,\n  type PanelDefinition,\n  type RegistryChangeEvent,\n} from './shared/panel-registry.js';\n// Import to ensure built-in panels are registered\nimport './shared/builtin-panels.js';\n\ntype DebugReplCommandPayload = {\n  command?: string;\n  description?: string;\n  tags?: string[];\n  aliases?: string[];\n  mutates?: boolean;\n  read_only?: boolean;\n};\n\ntype PanelFilters = {\n  requests: { method: string; status: string; search: string; newestFirst: boolean; hasBody: boolean; contentType: string };\n  sql: { search: string; slowOnly: boolean; errorOnly: boolean; newestFirst: boolean };\n  logs: { level: string; search: string; autoScroll: boolean; newestFirst: boolean };\n  routes: { method: string; search: string };\n  sessions: { search: string };\n  custom: { search: string };\n  objects: { search: string };\n};\n\ntype DebugState = {\n  template: Record<string, any>;\n  session: Record<string, any>;\n  requests: RequestEntry[];\n  sql: SQLEntry[];\n  logs: LogEntry[];\n  config: Record<string, any>;\n  routes: RouteEntry[];\n  custom: { data: Record<string, any>; logs: CustomLogEntry[] };\n  extra: Record<string, any>;\n};\n\ntype PanelRenderer = {\n  render: () => void;\n  filters?: () => string;\n};\n\n// Default panels come from registry, with REPL panels added if needed\nconst getDefaultPanels = (): string[] => {\n  // Get built-in panels from registry, sorted by category/order\n  const registryPanels = panelRegistry.getSortedIds();\n  // Default console order: data panels first, then core, then system\n  // This matches the original order: template, session, requests, sql, logs, config, routes, custom\n  return registryPanels.length > 0\n    ? registryPanels\n    : ['template', 'session', 'requests', 'sql', 'logs', 'config', 'routes', 'custom'];\n};\n\nconst replPanelIDs = new Set(['shell', 'console']);\n\n// Helper to check if a panel is known (in registry or is a REPL panel)\nconst isKnownPanel = (panel: string): boolean => {\n  return panelRegistry.has(panel) || replPanelIDs.has(panel);\n};\n\n// REPL panel labels (not in registry)\nconst replPanelLabels: Record<string, string> = {\n  shell: 'Shell',\n  console: 'Console',\n};\n\n// Get panel label - from registry or fallback\nconst getPanelLabel = (panelId: string): string => {\n  // Check REPL panels first\n  if (replPanelLabels[panelId]) {\n    return replPanelLabels[panelId];\n  }\n  // Check registry\n  const def = panelRegistry.get(panelId);\n  if (def) {\n    return def.label;\n  }\n  // Fallback: format the panel ID\n  if (!panelId) {\n    return '';\n  }\n  return panelId\n    .replace(/[-_.]/g, ' ')\n    .replace(/\\s+/g, ' ')\n    .trim()\n    .replace(/\\bsql\\b/i, 'SQL')\n    .replace(/\\b([a-z])/g, (match) => match.toUpperCase());\n};\n\n// Get event types for a panel from registry\nconst getPanelEventTypes = (panelId: string): string[] => {\n  if (panelId === 'sessions') {\n    return [];\n  }\n  const def = panelRegistry.get(panelId);\n  if (def) {\n    return normalizeEventTypes(def);\n  }\n  // Fallback for unknown panels\n  return [panelId];\n};\n\n// Build event-to-panel mapping from registry\nconst buildEventToPanel = (): Record<string, string> => {\n  const mapping: Record<string, string> = {};\n  for (const def of panelRegistry.list()) {\n    for (const eventType of normalizeEventTypes(def)) {\n      mapping[eventType] = def.id;\n    }\n  }\n  return mapping;\n};\n\nconst parseJSON = (value: string | undefined): any => {\n  if (!value) {\n    return null;\n  }\n  try {\n    return JSON.parse(value);\n  } catch {\n    return null;\n  }\n};\n\nconst normalizeReplCommands = (value: any): DebugReplCommand[] => {\n  if (!Array.isArray(value)) {\n    return [];\n  }\n  const commands: DebugReplCommand[] = [];\n  value.forEach((item) => {\n    if (!item || typeof item !== 'object') {\n      return;\n    }\n    const raw = item as DebugReplCommandPayload;\n    const command = typeof raw.command === 'string' ? raw.command.trim() : '';\n    if (!command) {\n      return;\n    }\n    const description = typeof raw.description === 'string' ? raw.description.trim() : '';\n    const tags = Array.isArray(raw.tags)\n      ? raw.tags\n          .filter((tag) => typeof tag === 'string' && tag.trim() !== '')\n          .map((tag) => tag.trim())\n      : [];\n    const aliases = Array.isArray(raw.aliases)\n      ? raw.aliases\n          .filter((alias) => typeof alias === 'string' && alias.trim() !== '')\n          .map((alias) => alias.trim())\n      : [];\n    const mutates =\n      typeof raw.mutates === 'boolean'\n        ? raw.mutates\n        : typeof raw.read_only === 'boolean'\n          ? !raw.read_only\n          : false;\n    commands.push({\n      command,\n      description: description || undefined,\n      tags: tags.length > 0 ? tags : undefined,\n      aliases: aliases.length > 0 ? aliases : undefined,\n      mutates,\n    });\n  });\n  return commands;\n};\n\n\nconst normalizePanelList = (value: any): string[] => {\n  if (Array.isArray(value) && value.length > 0) {\n    return value.filter((panel) => typeof panel === 'string' && panel.trim()).map((panel) => panel.trim());\n  }\n  return getDefaultPanels();\n};\n\nconst filterObjectByKey = (data: Record<string, any>, search: string): Record<string, any> => {\n  return filterObjectBySearch(data, search) as Record<string, any>;\n};\n\nconst setNestedValue = (dest: Record<string, any>, key: string, value: any): void => {\n  if (!dest || !key) {\n    return;\n  }\n  const parts = key.split('.').map((part) => part.trim()).filter(Boolean);\n  if (parts.length === 0) {\n    return;\n  }\n  let current = dest;\n  for (let i = 0; i < parts.length - 1; i += 1) {\n    const part = parts[i];\n    if (!current[part] || typeof current[part] !== 'object') {\n      current[part] = {};\n    }\n    current = current[part];\n  }\n  current[parts[parts.length - 1]] = value;\n};\n\nconst parseNumber = (value: string | undefined, fallback: number): number => {\n  if (!value) {\n    return fallback;\n  }\n  const parsed = Number(value);\n  if (Number.isNaN(parsed)) {\n    return fallback;\n  }\n  return parsed;\n};\n\nexport class DebugPanel {\n  private container: HTMLElement;\n  private debugPath: string;\n  private panels: string[];\n  private activePanel: string;\n  private state: DebugState;\n  private filters: PanelFilters;\n  private paused = false;\n  private maxLogEntries: number;\n  private maxSQLQueries: number;\n  private slowThresholdMs: number;\n  private eventCount = 0;\n  private lastEventAt: Date | null = null;\n  private stream: DebugStream;\n  private streamBasePath: string;\n  private sessions: DebugUserSession[] = [];\n  private sessionsLoading = false;\n  private sessionsLoaded = false;\n  private sessionsError: string | null = null;\n  private sessionsUpdatedAt: Date | null = null;\n  private activeSessionId: string | null = null;\n  private activeSession: DebugUserSession | null = null;\n  private replPanels: Map<string, DebugReplPanel>;\n  private replCommands: DebugReplCommand[];\n  private panelRenderers: Map<string, PanelRenderer>;\n  private tabsEl: HTMLElement;\n  private panelEl: HTMLElement;\n  private filtersEl: HTMLElement;\n  private statusEl: HTMLElement;\n  private connectionEl: HTMLElement;\n  private eventCountEl: HTMLElement;\n  private lastEventEl: HTMLElement;\n  private sessionBannerEl: HTMLElement | null = null;\n  private sessionMetaEl: HTMLElement | null = null;\n  private sessionDetachEl: HTMLButtonElement | null = null;\n  private eventToPanel: Record<string, string>;\n  private unsubscribeRegistry: (() => void) | null = null;\n  private expandedRequests: Set<string> = new Set();\n\n  constructor(container: HTMLElement) {\n    this.container = container;\n    const panelsData = parseJSON(container.dataset.panels);\n    this.panels = normalizePanelList(panelsData);\n    if (!this.panels.includes('sessions')) {\n      this.panels.push('sessions');\n    }\n    this.activePanel = this.panels[0] || 'template';\n\n    this.debugPath = container.dataset.debugPath || '';\n    this.streamBasePath = this.debugPath;\n    this.maxLogEntries = parseNumber(container.dataset.maxLogEntries, 500);\n    this.maxSQLQueries = parseNumber(container.dataset.maxSqlQueries, 200);\n    this.slowThresholdMs = parseNumber(container.dataset.slowThresholdMs, 50);\n    this.replCommands = normalizeReplCommands(parseJSON(container.dataset.replCommands));\n\n    this.state = {\n      template: {},\n      session: {},\n      requests: [],\n      sql: [],\n      logs: [],\n      config: {},\n      routes: [],\n      custom: { data: {}, logs: [] },\n      extra: {},\n    };\n\n    this.filters = {\n      requests: { method: 'all', status: 'all', search: '', newestFirst: true, hasBody: false, contentType: 'all' },\n      sql: { search: '', slowOnly: false, errorOnly: false, newestFirst: true },\n      logs: { level: 'all', search: '', autoScroll: true, newestFirst: true },\n      routes: { method: 'all', search: '' },\n      sessions: { search: '' },\n      custom: { search: '' },\n      objects: { search: '' },\n    };\n\n    this.replPanels = new Map();\n    this.panelRenderers = new Map();\n    replPanelIDs.forEach((panel) => {\n      this.panelRenderers.set(panel, {\n        render: () => this.renderReplPanel(panel),\n        filters: () => '<span class=\"timestamp\">REPL controls are in the panel header.</span>',\n      });\n    });\n\n    // Build event-to-panel mapping from registry\n    this.eventToPanel = buildEventToPanel();\n\n    this.tabsEl = this.requireElement('[data-debug-tabs]', document);\n    this.panelEl = this.requireElement('[data-debug-panel]', document);\n    this.filtersEl = this.requireElement('[data-debug-filters]', document);\n    this.statusEl = document.querySelector('[data-debug-status]') || this.container;\n    this.connectionEl = this.requireElement('[data-debug-connection]', document);\n    this.eventCountEl = this.requireElement('[data-debug-events]', document);\n    this.lastEventEl = this.requireElement('[data-debug-last]', document);\n    this.sessionBannerEl = document.querySelector('[data-debug-session-banner]');\n    this.sessionMetaEl = document.querySelector('[data-debug-session-meta]');\n    this.sessionDetachEl = document.querySelector('[data-debug-session-detach]');\n    if (this.sessionDetachEl) {\n      this.sessionDetachEl.addEventListener('click', () => this.detachSession());\n    }\n\n    this.renderTabs();\n    this.renderActivePanel();\n    this.bindActions();\n    this.updateSessionBanner();\n\n    this.stream = new DebugStream({\n      basePath: this.streamBasePath,\n      onEvent: (event) => this.handleEvent(event),\n      onStatusChange: (status) => this.updateConnectionStatus(status),\n    });\n\n    // Subscribe to registry changes for dynamic panel updates\n    this.unsubscribeRegistry = panelRegistry.subscribe((event) => this.handleRegistryChange(event));\n\n    this.fetchSnapshot();\n    this.stream.connect();\n    this.subscribeToEvents();\n  }\n\n  /**\n   * Subscribe to WebSocket events for all panels based on registry\n   */\n  private subscribeToEvents(): void {\n    const eventTypes = new Set<string>();\n    for (const panel of this.panels) {\n      for (const eventType of getPanelEventTypes(panel)) {\n        eventTypes.add(eventType);\n      }\n    }\n    this.stream.subscribe(Array.from(eventTypes));\n  }\n\n  /**\n   * Handle registry changes (panel registered/unregistered)\n   */\n  private handleRegistryChange(event: RegistryChangeEvent): void {\n    // Rebuild event-to-panel mapping\n    this.eventToPanel = buildEventToPanel();\n\n    // If a new panel was registered and it's in our panel list, update UI\n    if (event.type === 'register') {\n      // Add to panels if not already present and not explicitly filtered\n      if (!this.panels.includes(event.panelId)) {\n        this.panels.push(event.panelId);\n      }\n    }\n\n    // Update subscriptions\n    this.subscribeToEvents();\n\n    // Rebuild tabs and re-render if needed\n    this.renderTabs();\n    if (event.panelId === this.activePanel) {\n      this.renderActivePanel();\n    }\n  }\n\n  private requireElement(selector: string, parent: ParentNode = this.container): HTMLElement {\n    const el = parent.querySelector(selector);\n    if (!el) {\n      throw new Error(`Missing debug element: ${selector}`);\n    }\n    return el as HTMLElement;\n  }\n\n  private bindActions(): void {\n    this.tabsEl.addEventListener('click', (event) => {\n      const target = event.target as HTMLElement | null;\n      if (!target) {\n        return;\n      }\n      const button = target.closest<HTMLButtonElement>('[data-panel]');\n      if (!button) {\n        return;\n      }\n      const panel = button.dataset.panel || '';\n      if (!panel || panel === this.activePanel) {\n        return;\n      }\n      this.activePanel = panel;\n      this.renderActivePanel();\n    });\n\n    const actions = this.container.querySelectorAll<HTMLButtonElement>('[data-debug-action]');\n    actions.forEach((button) => {\n      button.addEventListener('click', () => {\n        const action = button.dataset.debugAction || '';\n        switch (action) {\n          case 'snapshot':\n            this.stream.requestSnapshot();\n            break;\n          case 'clear':\n            this.clearAll();\n            break;\n          case 'pause':\n            this.togglePause(button);\n            break;\n          case 'clear-panel':\n            this.clearActivePanel();\n            break;\n          default:\n            break;\n        }\n      });\n    });\n  }\n\n  private renderTabs(): void {\n    const tabs = this.panels\n      .map((panel) => {\n        const active = panel === this.activePanel ? 'debug-tab--active' : '';\n        return `\n          <button class=\"debug-tab ${active}\" data-panel=\"${escapeHTML(panel)}\">\n            <span class=\"debug-tab__label\">${escapeHTML(getPanelLabel(panel))}</span>\n            <span class=\"debug-tab__count\" data-panel-count=\"${escapeHTML(panel)}\">0</span>\n          </button>\n        `;\n      })\n      .join('');\n    this.tabsEl.innerHTML = tabs;\n    this.updateTabCounts();\n  }\n\n  private renderActivePanel(): void {\n    this.renderTabs();\n    this.renderFilters();\n    this.renderPanel();\n  }\n\n  private renderFilters(): void {\n    const panel = this.activePanel;\n    let content = '';\n    const renderer = this.panelRenderers.get(panel);\n    if (renderer?.filters) {\n      content = renderer.filters();\n    } else if (panel === 'requests') {\n      const values = this.filters.requests;\n      const contentTypes = this.getUniqueContentTypes();\n      content = `\n        <div class=\"debug-filter\">\n          <label>Method</label>\n          <select data-filter=\"method\">\n            ${this.renderSelectOptions(['all', 'GET', 'POST', 'PUT', 'PATCH', 'DELETE'], values.method)}\n          </select>\n        </div>\n        <div class=\"debug-filter\">\n          <label>Status</label>\n          <select data-filter=\"status\">\n            ${this.renderSelectOptions(['all', '200', '201', '204', '400', '401', '403', '404', '500'], values.status)}\n          </select>\n        </div>\n        <div class=\"debug-filter\">\n          <label>Content-Type</label>\n          <select data-filter=\"contentType\">\n            ${this.renderSelectOptions(['all', ...contentTypes], values.contentType)}\n          </select>\n        </div>\n        <div class=\"debug-filter debug-filter--grow\">\n          <label>Search</label>\n          <input type=\"search\" data-filter=\"search\" value=\"${escapeHTML(values.search)}\" placeholder=\"/admin/users\" />\n        </div>\n        <label class=\"debug-btn\">\n          <input type=\"checkbox\" data-filter=\"hasBody\" ${values.hasBody ? 'checked' : ''} />\n          <span>Has Body</span>\n        </label>\n        <label class=\"debug-btn\">\n          <input type=\"checkbox\" data-filter=\"newestFirst\" ${values.newestFirst ? 'checked' : ''} />\n          <span>Newest first</span>\n        </label>\n      `;\n    } else if (panel === 'sql') {\n      const values = this.filters.sql;\n      content = `\n        <div class=\"debug-filter debug-filter--grow\">\n          <label>Search</label>\n          <input type=\"search\" data-filter=\"search\" value=\"${escapeHTML(values.search)}\" placeholder=\"SELECT\" />\n        </div>\n        <label class=\"debug-btn\">\n          <input type=\"checkbox\" data-filter=\"slowOnly\" ${values.slowOnly ? 'checked' : ''} />\n          <span>Slow only</span>\n        </label>\n        <label class=\"debug-btn\">\n          <input type=\"checkbox\" data-filter=\"errorOnly\" ${values.errorOnly ? 'checked' : ''} />\n          <span>Errors</span>\n        </label>\n        <label class=\"debug-btn\">\n          <input type=\"checkbox\" data-filter=\"newestFirst\" ${values.newestFirst ? 'checked' : ''} />\n          <span>Newest first</span>\n        </label>\n      `;\n    } else if (panel === 'logs') {\n      const values = this.filters.logs;\n      content = `\n        <div class=\"debug-filter\">\n          <label>Level</label>\n          <select data-filter=\"level\">\n            ${this.renderSelectOptions(['all', 'debug', 'info', 'warn', 'error'], values.level)}\n          </select>\n        </div>\n        <div class=\"debug-filter debug-filter--grow\">\n          <label>Search</label>\n          <input type=\"search\" data-filter=\"search\" value=\"${escapeHTML(values.search)}\" placeholder=\"database\" />\n        </div>\n        <label class=\"debug-btn\">\n          <input type=\"checkbox\" data-filter=\"newestFirst\" ${values.newestFirst ? 'checked' : ''} />\n          <span>Newest first</span>\n        </label>\n        <label class=\"debug-btn\">\n          <input type=\"checkbox\" data-filter=\"autoScroll\" ${values.autoScroll ? 'checked' : ''} />\n          <span>Auto-scroll</span>\n        </label>\n      `;\n    } else if (panel === 'routes') {\n      const values = this.filters.routes;\n      content = `\n        <div class=\"debug-filter\">\n          <label>Method</label>\n          <select data-filter=\"method\">\n            ${this.renderSelectOptions(['all', 'GET', 'POST', 'PUT', 'PATCH', 'DELETE'], values.method)}\n          </select>\n        </div>\n        <div class=\"debug-filter debug-filter--grow\">\n          <label>Search</label>\n          <input type=\"search\" data-filter=\"search\" value=\"${escapeHTML(values.search)}\" placeholder=\"/admin\" />\n        </div>\n      `;\n    } else if (panel === 'sessions') {\n      const values = this.filters.sessions;\n      content = `\n        <div class=\"debug-filter debug-filter--grow\">\n          <label>Search</label>\n          <input type=\"search\" data-filter=\"search\" value=\"${escapeHTML(values.search)}\" placeholder=\"user, session id, path\" />\n        </div>\n      `;\n    } else {\n      const values = this.filters.objects;\n      content = `\n        <div class=\"debug-filter debug-filter--grow\">\n          <label>Search (JSONPath supported)</label>\n          <input type=\"search\" data-filter=\"search\" value=\"${escapeHTML(values.search)}\" placeholder=\"user.roles[0].name\" />\n        </div>\n      `;\n    }\n\n    this.filtersEl.innerHTML = content || '<span class=\"timestamp\">No filters</span>';\n    this.bindFilterInputs();\n  }\n\n  private bindFilterInputs(): void {\n    const inputs = this.filtersEl.querySelectorAll<HTMLInputElement | HTMLSelectElement>('input, select');\n    inputs.forEach((input) => {\n      input.addEventListener('input', () => this.updateFiltersFromInputs());\n      input.addEventListener('change', () => this.updateFiltersFromInputs());\n    });\n  }\n\n  private updateFiltersFromInputs(): void {\n    const panel = this.activePanel;\n    const inputs = this.filtersEl.querySelectorAll<HTMLInputElement | HTMLSelectElement>('[data-filter]');\n    if (panel === 'requests') {\n      const next = { ...this.filters.requests };\n      inputs.forEach((input) => {\n        const key = input.dataset.filter || '';\n        if (key === 'newestFirst' || key === 'hasBody') {\n          next[key] = (input as HTMLInputElement).checked;\n        } else if (key && key in next) {\n          next[key as 'method' | 'status' | 'search' | 'contentType'] = (input as HTMLInputElement).value;\n        }\n      });\n      this.filters.requests = next;\n    } else if (panel === 'sql') {\n      const next = { ...this.filters.sql };\n      inputs.forEach((input) => {\n        const key = input.dataset.filter || '';\n        if (key === 'slowOnly' || key === 'errorOnly' || key === 'newestFirst') {\n          next[key] = (input as HTMLInputElement).checked;\n        } else if (key === 'search') {\n          next[key] = (input as HTMLInputElement).value;\n        }\n      });\n      this.filters.sql = next;\n    } else if (panel === 'logs') {\n      const next = { ...this.filters.logs };\n      inputs.forEach((input) => {\n        const key = input.dataset.filter || '';\n        if (key === 'autoScroll' || key === 'newestFirst') {\n          next[key] = (input as HTMLInputElement).checked;\n        } else if (key === 'level' || key === 'search') {\n          next[key] = (input as HTMLInputElement).value;\n        }\n      });\n      this.filters.logs = next;\n    } else if (panel === 'routes') {\n      const next = { ...this.filters.routes };\n      inputs.forEach((input) => {\n        const key = input.dataset.filter || '';\n        if (key && key in next) {\n          next[key as keyof typeof next] = (input as HTMLInputElement).value;\n        }\n      });\n      this.filters.routes = next;\n    } else if (panel === 'sessions') {\n      const next = { ...this.filters.sessions };\n      inputs.forEach((input) => {\n        const key = input.dataset.filter || '';\n        if (key && key in next) {\n          next[key as keyof typeof next] = (input as HTMLInputElement).value;\n        }\n      });\n      this.filters.sessions = next;\n    } else {\n      const next = { ...this.filters.objects };\n      inputs.forEach((input) => {\n        const key = input.dataset.filter || '';\n        if (key && key in next) {\n          next[key as keyof typeof next] = (input as HTMLInputElement).value;\n        }\n      });\n      this.filters.objects = next;\n    }\n    this.renderPanel();\n  }\n\n  private renderPanel(): void {\n    const panel = this.activePanel;\n    const renderer = this.panelRenderers.get(panel);\n    if (renderer) {\n      renderer.render();\n      return;\n    }\n    this.panelEl.classList.remove('debug-content--repl');\n\n    let content = '';\n    if (panel === 'template') {\n      content = this.renderJSONPanel('Template Context', this.state.template, this.filters.objects.search);\n    } else if (panel === 'session') {\n      content = this.renderJSONPanel('Session', this.state.session, this.filters.objects.search);\n    } else if (panel === 'config') {\n      content = this.renderJSONPanel('Config', this.state.config, this.filters.objects.search);\n    } else if (panel === 'requests') {\n      content = this.renderRequests();\n    } else if (panel === 'sql') {\n      content = this.renderSQL();\n    } else if (panel === 'logs') {\n      content = this.renderLogs();\n    } else if (panel === 'routes') {\n      content = this.renderRoutes();\n    } else if (panel === 'sessions') {\n      content = this.renderSessionsPanel();\n    } else if (panel === 'custom') {\n      content = this.renderCustom();\n    } else if (panel === 'jserrors') {\n      content = renderJSErrorsPanel(this.state.extra['jserrors'] || [], consoleStyles, {\n        newestFirst: this.filters.logs.newestFirst,\n        showSortToggle: true,\n      });\n    } else {\n      // Check panel registry for custom renderer\n      const def = panelRegistry.get(panel);\n      if (def && (def.renderConsole || def.render)) {\n        const snapshotKey = getSnapshotKey(def);\n        const data = this.getStateForKey(snapshotKey);\n        const renderFn = def.renderConsole || def.render;\n        content = renderFn(data, consoleStyles, {\n          newestFirst: this.filters.logs.newestFirst,\n        });\n      } else {\n        content = this.renderJSONPanel(getPanelLabel(panel), this.state.extra[panel], this.filters.objects.search);\n      }\n    }\n\n    this.panelEl.innerHTML = content;\n    if (panel === 'logs' && this.filters.logs.autoScroll) {\n      // When newestFirst is true, newest entries are at the top, so scroll to top\n      // When newestFirst is false, newest entries are at the bottom, so scroll to bottom\n      this.panelEl.scrollTop = this.filters.logs.newestFirst ? 0 : this.panelEl.scrollHeight;\n    }\n    this.attachExpandableRowListeners();\n    this.attachCopyButtonListeners();\n    if (panel === 'requests') {\n      attachRequestDetailListeners(this.panelEl, this.expandedRequests);\n    }\n    if (panel === 'sql') {\n      this.attachSQLSelectionListeners();\n    }\n    if (panel === 'sessions') {\n      this.attachSessionActions();\n    }\n  }\n\n  private attachExpandableRowListeners(): void {\n    // Use shared helper for expandable row behavior\n    attachExpandableRowListeners(this.panelEl);\n  }\n\n  private attachCopyButtonListeners(): void {\n    // Use shared helper for copy-to-clipboard behavior (console style with icon feedback)\n    attachCopyListeners(this.panelEl, { useIconFeedback: true });\n  }\n\n  private attachSQLSelectionListeners(): void {\n    // Use shared helper for SQL row selection, clipboard copy, and download\n    attachSQLSelectionListeners(this.panelEl, this.state.sql, { useIconFeedback: true });\n  }\n\n  private renderReplPanel(panel: string): void {\n    this.panelEl.classList.add('debug-content--repl');\n    let replPanel = this.replPanels.get(panel);\n    if (!replPanel) {\n      replPanel = new DebugReplPanel({\n        kind: panel === 'shell' ? 'shell' : 'console',\n        debugPath: this.debugPath,\n        commands: panel === 'console' ? this.replCommands : [],\n      });\n      this.replPanels.set(panel, replPanel);\n    }\n    replPanel.attach(this.panelEl);\n  }\n\n  private getUniqueContentTypes(): string[] {\n    const types = new Set<string>();\n    for (const entry of this.state.requests) {\n      const ct = entry.content_type;\n      if (ct) {\n        types.add(ct.split(';')[0].trim());\n      }\n    }\n    return [...types].sort();\n  }\n\n  private renderRequests(): string {\n    const { method, status, search, newestFirst, hasBody, contentType } = this.filters.requests;\n    const needle = search.toLowerCase();\n\n    // Apply console-specific filters\n    const filtered = this.state.requests.filter((entry) => {\n      if (method !== 'all' && (entry.method || '').toUpperCase() !== method) {\n        return false;\n      }\n      if (status !== 'all' && String(entry.status || '') !== status) {\n        return false;\n      }\n      if (needle && !(entry.path || '').toLowerCase().includes(needle)) {\n        return false;\n      }\n      if (hasBody && !entry.request_body) {\n        return false;\n      }\n      if (contentType !== 'all') {\n        const entryCt = (entry.content_type || '').split(';')[0].trim();\n        if (entryCt !== contentType) {\n          return false;\n        }\n      }\n      return true;\n    });\n\n    if (filtered.length === 0) {\n      return this.renderEmptyState('No requests captured yet.');\n    }\n\n    // Use shared renderer with console-specific options\n    return renderRequestsPanel(filtered, consoleStyles, {\n      newestFirst,\n      slowThresholdMs: this.slowThresholdMs,\n      showSortToggle: false, // Console has filter bar, not inline toggle\n      truncatePath: false, // Console shows full paths\n      expandedRequestIds: this.expandedRequests,\n    });\n  }\n\n  private renderSQL(): string {\n    const { search, slowOnly, errorOnly, newestFirst } = this.filters.sql;\n    const needle = search.toLowerCase();\n\n    // Apply console-specific filters\n    const filtered = this.state.sql.filter((entry) => {\n      if (errorOnly && !entry.error) {\n        return false;\n      }\n      if (slowOnly && !this.isSlowQuery(entry)) {\n        return false;\n      }\n      if (needle && !(entry.query || '').toLowerCase().includes(needle)) {\n        return false;\n      }\n      return true;\n    });\n\n    if (filtered.length === 0) {\n      return this.renderEmptyState('No SQL queries captured yet.');\n    }\n\n    // Use shared renderer with console-specific options\n    return renderSQLPanel(filtered, consoleStyles, {\n      newestFirst,\n      slowThresholdMs: this.slowThresholdMs,\n      maxEntries: this.maxSQLQueries,\n      showSortToggle: false, // Console has filter bar\n      useIconCopyButton: true, // Console uses iconoir icons\n    });\n  }\n\n  private renderLogs(): string {\n    const { level, search, newestFirst } = this.filters.logs;\n    const needle = search.toLowerCase();\n\n    // Apply console-specific filters\n    const filtered = this.state.logs.filter((entry) => {\n      if (level !== 'all' && (entry.level || '').toLowerCase() !== level) {\n        return false;\n      }\n      const haystack = `${entry.message || ''} ${entry.source || ''} ${formatJSON(entry.fields || {})}`.toLowerCase();\n      if (needle && !haystack.includes(needle)) {\n        return false;\n      }\n      return true;\n    });\n\n    if (filtered.length === 0) {\n      return this.renderEmptyState('No logs captured yet.');\n    }\n\n    // Use shared renderer with console-specific options\n    return renderLogsPanel(filtered, consoleStyles, {\n      newestFirst,\n      maxEntries: this.maxLogEntries,\n      showSortToggle: false, // Console has filter bar\n      showSource: true, // Console shows source column\n      truncateMessage: false, // Console shows full messages\n    });\n  }\n\n  private renderRoutes(): string {\n    const { method, search } = this.filters.routes;\n    const needle = search.toLowerCase();\n\n    // Apply console-specific filters\n    const filtered = this.state.routes.filter((entry) => {\n      if (method !== 'all' && (entry.method || '').toUpperCase() !== method) {\n        return false;\n      }\n      const haystack = `${entry.path || ''} ${entry.handler || ''} ${entry.summary || ''}`.toLowerCase();\n      if (needle && !haystack.includes(needle)) {\n        return false;\n      }\n      return true;\n    });\n\n    if (filtered.length === 0) {\n      return this.renderEmptyState('No routes captured yet.');\n    }\n\n    // Use shared renderer with console-specific options\n    return renderRoutesPanel(filtered, consoleStyles, {\n      showName: true, // Console shows name column\n    });\n  }\n\n  private renderSessionsPanel(): string {\n    if (!this.sessionsLoaded && !this.sessionsLoading) {\n      void this.fetchSessions();\n    }\n\n    if (this.sessionsError) {\n      return this.renderEmptyState(this.sessionsError);\n    }\n\n    const trackingFlag =\n      this.state.config && typeof this.state.config === 'object' && 'session_tracking' in this.state.config\n        ? Boolean((this.state.config as Record<string, unknown>).session_tracking)\n        : undefined;\n\n    const search = this.filters.sessions.search.trim().toLowerCase();\n    let sessions = [...this.sessions];\n    if (search) {\n      sessions = sessions.filter((session) => {\n        const haystack = [\n          session.username,\n          session.user_id,\n          session.session_id,\n          session.ip,\n          session.current_page,\n        ]\n          .filter(Boolean)\n          .join(' ')\n          .toLowerCase();\n        return haystack.includes(search);\n      });\n    }\n\n    sessions.sort((a, b) => {\n      const aTime = new Date(a.last_activity || a.started_at || 0).getTime();\n      const bTime = new Date(b.last_activity || b.started_at || 0).getTime();\n      return bTime - aTime;\n    });\n\n    if (this.sessionsLoading && sessions.length === 0) {\n      return this.renderEmptyState('Loading sessions...');\n    }\n\n    if (sessions.length === 0) {\n      if (trackingFlag === false) {\n        return this.renderEmptyState('Session tracking is disabled. Enable it to list active sessions.');\n      }\n      return this.renderEmptyState('No active sessions yet.');\n    }\n\n    const rows = sessions\n      .map((session) => {\n        const sessionId = session.session_id || '';\n        const userLabel = session.username || session.user_id || 'Unknown';\n        const lastActivity = formatTimestamp(session.last_activity || session.started_at);\n        const requestCount = formatNumber(session.request_count ?? 0);\n        const isActive = !!sessionId && sessionId === this.activeSessionId;\n        const action = isActive ? 'detach' : 'attach';\n        const actionLabel = isActive ? 'Detach' : 'Attach';\n        const actionClass = isActive ? 'debug-btn debug-btn--danger' : 'debug-btn debug-btn--primary';\n        const rowClass = isActive ? 'debug-session-row debug-session-row--active' : 'debug-session-row';\n        const currentPage = session.current_page || '-';\n        const ip = session.ip || '-';\n\n        return `\n          <tr class=\"${rowClass}\">\n            <td>\n              <div class=\"debug-session-user\">${escapeHTML(userLabel)}</div>\n              <div class=\"debug-session-meta\">\n                <span class=\"debug-session-id\">${escapeHTML(sessionId || '-')}</span>\n              </div>\n            </td>\n            <td>${escapeHTML(ip)}</td>\n            <td>\n              <span class=\"debug-session-path\">${escapeHTML(currentPage)}</span>\n            </td>\n            <td>${escapeHTML(lastActivity || '-')}</td>\n            <td>${escapeHTML(requestCount)}</td>\n            <td>\n              <button class=\"${actionClass}\" data-session-action=\"${action}\" data-session-id=\"${escapeHTML(sessionId)}\">\n                ${actionLabel}\n              </button>\n            </td>\n          </tr>\n        `;\n      })\n      .join('');\n\n    const refreshLabel = this.sessionsLoading ? 'Refreshing...' : 'Refresh';\n    const countLabel = `${formatNumber(sessions.length)} active`;\n    return `\n      <div class=\"debug-session-toolbar\">\n        <span class=\"debug-session-toolbar__label\">${countLabel}</span>\n        <div class=\"debug-session-toolbar__actions\">\n          <button class=\"debug-btn\" data-session-action=\"refresh\">\n            <i class=\"iconoir-refresh\"></i> ${refreshLabel}\n          </button>\n        </div>\n      </div>\n      <table class=\"debug-table debug-session-table\">\n        <thead>\n          <tr>\n            <th>User</th>\n            <th>IP</th>\n            <th>Current Page</th>\n            <th>Last Activity</th>\n            <th>Requests</th>\n            <th></th>\n          </tr>\n        </thead>\n        <tbody>\n          ${rows}\n        </tbody>\n      </table>\n    `;\n  }\n\n  private renderCustom(): string {\n    const { search } = this.filters.custom;\n\n    // Check if there's any data at all\n    const hasData = Object.keys(this.state.custom.data).length > 0;\n    const hasLogs = this.state.custom.logs.length > 0;\n\n    if (!hasData && !hasLogs) {\n      return this.renderEmptyState('No custom data captured yet.');\n    }\n\n    // Use shared renderer with console-specific options\n    return renderCustomPanel(this.state.custom, consoleStyles, {\n      maxLogEntries: this.maxLogEntries,\n      useIconCopyButton: true, // Console uses iconoir icons\n      showCount: true,\n      dataFilterFn: search ? (data) => filterObjectByKey(data, search) : undefined,\n    });\n  }\n\n  private renderJSONPanel(title: string, data: any, search: string): string {\n    // Check for empty data\n    const isObject = data && typeof data === 'object' && !Array.isArray(data);\n    const isArray = Array.isArray(data);\n    const isEmpty =\n      (isObject && Object.keys(data || {}).length === 0) ||\n      (isArray && (data || []).length === 0) ||\n      (!isObject && !isArray && !data);\n\n    if (isEmpty) {\n      return this.renderEmptyState(`No ${title.toLowerCase()} data available.`);\n    }\n\n    // Use shared renderer with console-specific options and search filter\n    return renderSharedJSONPanel(title, data, consoleStyles, {\n      useIconCopyButton: true, // Console uses iconoir icons\n      showCount: true,\n      filterFn: search ? (obj) => filterObjectByKey(obj, search) : undefined,\n    });\n  }\n\n  private attachSessionActions(): void {\n    const buttons = this.panelEl.querySelectorAll<HTMLButtonElement>('[data-session-action]');\n    buttons.forEach((button) => {\n      button.addEventListener('click', () => {\n        const action = button.dataset.sessionAction || '';\n        const sessionId = button.dataset.sessionId || '';\n        switch (action) {\n          case 'refresh':\n            void this.fetchSessions(true);\n            break;\n          case 'attach':\n            this.attachSessionByID(sessionId);\n            break;\n          case 'detach':\n            this.detachSession();\n            break;\n          default:\n            break;\n        }\n      });\n    });\n  }\n\n  private async fetchSessions(force = false): Promise<void> {\n    if (!this.debugPath) {\n      return;\n    }\n    if (this.sessionsLoading) {\n      return;\n    }\n    if (!force && this.sessionsLoaded && this.sessionsUpdatedAt) {\n      const ageMs = Date.now() - this.sessionsUpdatedAt.getTime();\n      if (ageMs < 3000) {\n        return;\n      }\n    }\n\n    this.sessionsLoading = true;\n    this.sessionsError = null;\n    try {\n      const response = await fetch(`${this.debugPath}/api/sessions`, {\n        credentials: 'same-origin',\n      });\n      if (!response.ok) {\n        this.sessionsError = 'Failed to load active sessions.';\n        return;\n      }\n      const payload = (await response.json()) as { sessions?: DebugUserSession[] };\n      this.sessions = Array.isArray(payload.sessions) ? payload.sessions : [];\n      this.sessionsLoaded = true;\n      this.sessionsUpdatedAt = new Date();\n      if (this.activeSessionId) {\n        const updated = this.sessions.find((session) => session.session_id === this.activeSessionId);\n        if (updated) {\n          this.activeSession = updated;\n          this.updateSessionBanner();\n        }\n      }\n    } catch {\n      this.sessionsError = 'Failed to load active sessions.';\n    } finally {\n      this.sessionsLoading = false;\n      this.updateTabCounts();\n      if (this.activePanel === 'sessions') {\n        this.renderPanel();\n      }\n    }\n  }\n\n  private attachSessionByID(sessionID: string): void {\n    const trimmed = sessionID.trim();\n    if (!trimmed) {\n      return;\n    }\n    if (this.activeSessionId === trimmed) {\n      return;\n    }\n    const session = this.sessions.find((entry) => entry.session_id === trimmed) || { session_id: trimmed };\n    this.attachSession(session);\n  }\n\n  private attachSession(session: DebugUserSession): void {\n    const sessionID = (session.session_id || '').trim();\n    if (!sessionID) {\n      return;\n    }\n    if (this.activeSessionId === sessionID) {\n      return;\n    }\n    this.activeSessionId = sessionID;\n    this.activeSession = session;\n    this.streamBasePath = this.buildSessionStreamPath(sessionID);\n    this.resetDebugState();\n    this.updateSessionBanner();\n    this.rebuildStream('session');\n    this.renderPanel();\n  }\n\n  private detachSession(): void {\n    if (!this.activeSessionId) {\n      return;\n    }\n    this.activeSessionId = null;\n    this.activeSession = null;\n    this.streamBasePath = this.debugPath;\n    this.resetDebugState();\n    this.updateSessionBanner();\n    this.rebuildStream('global');\n    this.renderPanel();\n  }\n\n  private rebuildStream(mode: 'global' | 'session'): void {\n    this.stream.close();\n    this.stream = new DebugStream({\n      basePath: this.streamBasePath,\n      onEvent: (event) => this.handleEvent(event),\n      onStatusChange: (status) => this.updateConnectionStatus(status),\n    });\n    this.stream.connect();\n    this.subscribeToEvents();\n    if (mode === 'session') {\n      this.stream.requestSnapshot();\n    } else {\n      this.fetchSnapshot();\n    }\n  }\n\n  private resetDebugState(): void {\n    this.state = {\n      template: {},\n      session: {},\n      requests: [],\n      sql: [],\n      logs: [],\n      config: {},\n      routes: [],\n      custom: { data: {}, logs: [] },\n      extra: {},\n    };\n    this.expandedRequests.clear();\n    this.eventCount = 0;\n    this.lastEventAt = null;\n    this.updateStatusMeta();\n    this.updateTabCounts();\n  }\n\n  private buildSessionStreamPath(sessionID: string): string {\n    const base = this.debugPath.replace(/\\/+$/, '');\n    const id = encodeURIComponent(sessionID);\n    if (!base) {\n      return '';\n    }\n    return `${base}/session/${id}`;\n  }\n\n  private updateSessionBanner(): void {\n    if (!this.sessionBannerEl) {\n      return;\n    }\n    if (!this.activeSessionId) {\n      this.sessionBannerEl.setAttribute('hidden', 'true');\n      return;\n    }\n    this.sessionBannerEl.removeAttribute('hidden');\n    if (this.sessionMetaEl) {\n      this.sessionMetaEl.textContent = this.sessionMetaText();\n    }\n  }\n\n  private sessionMetaText(): string {\n    const session: DebugUserSession =\n      this.activeSession ||\n      this.sessions.find((entry) => entry.session_id === this.activeSessionId) ||\n      { session_id: this.activeSessionId || undefined };\n    const parts = [\n      session.username || session.user_id,\n      session.session_id,\n      session.ip,\n      session.current_page,\n    ].filter(Boolean);\n    return parts.join(' | ');\n  }\n\n  private panelCount(panel: string): number {\n    switch (panel) {\n      case 'template':\n        return countPayload(this.state.template);\n      case 'session':\n        return countPayload(this.state.session);\n      case 'requests':\n        return this.state.requests.length;\n      case 'sql':\n        return this.state.sql.length;\n      case 'logs':\n        return this.state.logs.length;\n      case 'config':\n        return countPayload(this.state.config);\n      case 'routes':\n        return this.state.routes.length;\n      case 'sessions':\n        return this.sessions.length;\n      case 'custom':\n        return countPayload(this.state.custom.data) + this.state.custom.logs.length;\n      default:\n        return countPayload(this.state.extra[panel]);\n    }\n  }\n\n  private renderEmptyState(message: string): string {\n    return `\n      <div class=\"debug-empty\">\n        <p>${escapeHTML(message)}</p>\n      </div>\n    `;\n  }\n\n  private renderSelectOptions(options: string[], current: string): string {\n    return options\n      .map((option) => {\n        const selected = option.toLowerCase() === current.toLowerCase() ? 'selected' : '';\n        return `<option value=\"${escapeHTML(option)}\" ${selected}>${escapeHTML(option)}</option>`;\n      })\n      .join('');\n  }\n\n  private updateTabCounts(): void {\n    this.panels.forEach((panel) => {\n      const count = this.panelCount(panel);\n      const badge = this.tabsEl.querySelector<HTMLElement>(`[data-panel-count=\"${panel}\"]`);\n      if (badge) {\n        badge.textContent = formatNumber(count);\n      }\n    });\n  }\n\n  private updateConnectionStatus(status: DebugStreamStatus): void {\n    this.connectionEl.textContent = status;\n    this.statusEl.setAttribute('data-status', status);\n  }\n\n  private updateStatusMeta(): void {\n    this.eventCountEl.textContent = `${formatNumber(this.eventCount)} events`;\n    if (this.lastEventAt) {\n      this.lastEventEl.textContent = this.lastEventAt.toLocaleTimeString();\n    }\n  }\n\n  private handleEvent(event: DebugEvent): void {\n    if (!event || !event.type) {\n      return;\n    }\n    if (event.type === 'snapshot') {\n      this.applySnapshot(event.payload as DebugSnapshot);\n      return;\n    }\n\n    this.eventCount += 1;\n    this.lastEventAt = new Date();\n    this.updateStatusMeta();\n\n    if (this.paused) {\n      return;\n    }\n\n    // Find panel for this event type\n    const panel = this.eventToPanel[event.type] || event.type;\n\n    // Check if we have a registry definition for this panel\n    const def = panelRegistry.get(panel);\n    if (def) {\n      // Use registry's handleEvent or default\n      const snapshotKey = getSnapshotKey(def);\n      const currentData = this.getStateForKey(snapshotKey);\n      const handler = def.handleEvent || ((current, payload) => defaultHandleEvent(current, payload, this.maxLogEntries));\n      const newData = handler(currentData, event.payload);\n      this.setStateForKey(snapshotKey, newData);\n    } else {\n      // Legacy handling for built-in panels (backward compatibility)\n      switch (event.type) {\n        case 'request':\n          this.state.requests.push(event.payload as RequestEntry);\n          this.trim(this.state.requests, this.maxLogEntries);\n          break;\n        case 'sql':\n          this.state.sql.push(event.payload as SQLEntry);\n          this.trim(this.state.sql, this.maxSQLQueries);\n          break;\n        case 'log':\n          this.state.logs.push(event.payload as LogEntry);\n          this.trim(this.state.logs, this.maxLogEntries);\n          break;\n        case 'template':\n          this.state.template = (event.payload as Record<string, any>) || {};\n          break;\n        case 'session':\n          this.state.session = (event.payload as Record<string, any>) || {};\n          break;\n        case 'custom':\n          this.handleCustomEvent(event.payload);\n          break;\n        default:\n          // Store unknown events in extra\n          if (!isKnownPanel(panel)) {\n            this.state.extra[panel] = event.payload;\n          }\n          break;\n      }\n    }\n\n    this.updateTabCounts();\n    if (panel === this.activePanel) {\n      this.renderPanel();\n    }\n  }\n\n  private handleCustomEvent(payload: any): void {\n    if (!payload) {\n      return;\n    }\n    if (typeof payload === 'object' && 'key' in payload && 'value' in payload) {\n      setNestedValue(this.state.custom.data, String(payload.key), payload.value);\n      return;\n    }\n    if (typeof payload === 'object' && ('category' in payload || 'message' in payload)) {\n      this.state.custom.logs.push(payload as CustomLogEntry);\n      this.trim(this.state.custom.logs, this.maxLogEntries);\n      return;\n    }\n  }\n\n  /**\n   * Get state data for a snapshot key (used by registry-based event handling)\n   */\n  private getStateForKey(key: string): unknown {\n    switch (key) {\n      case 'template': return this.state.template;\n      case 'session': return this.state.session;\n      case 'requests': return this.state.requests;\n      case 'sql': return this.state.sql;\n      case 'logs': return this.state.logs;\n      case 'config': return this.state.config;\n      case 'routes': return this.state.routes;\n      case 'custom': return this.state.custom;\n      default: return this.state.extra[key];\n    }\n  }\n\n  /**\n   * Set state data for a snapshot key (used by registry-based event handling)\n   */\n  private setStateForKey(key: string, data: unknown): void {\n    switch (key) {\n      case 'template':\n        this.state.template = (data as Record<string, any>) || {};\n        break;\n      case 'session':\n        this.state.session = (data as Record<string, any>) || {};\n        break;\n      case 'requests':\n        this.state.requests = (data as RequestEntry[]) || [];\n        break;\n      case 'sql':\n        this.state.sql = (data as SQLEntry[]) || [];\n        break;\n      case 'logs':\n        this.state.logs = (data as LogEntry[]) || [];\n        break;\n      case 'config':\n        this.state.config = (data as Record<string, any>) || {};\n        break;\n      case 'routes':\n        this.state.routes = (data as RouteEntry[]) || [];\n        break;\n      case 'custom':\n        this.state.custom = (data as { data: Record<string, any>; logs: CustomLogEntry[] }) || { data: {}, logs: [] };\n        break;\n      default:\n        this.state.extra[key] = data;\n        break;\n    }\n  }\n\n  private applySnapshot(snapshot: DebugSnapshot): void {\n    const next = snapshot || {};\n    this.state.template = next.template || {};\n    this.state.session = next.session || {};\n    this.state.requests = ensureArray<RequestEntry>(next.requests);\n    this.state.sql = ensureArray<SQLEntry>(next.sql);\n    this.state.logs = ensureArray<LogEntry>(next.logs);\n    this.state.config = next.config || {};\n    this.state.routes = ensureArray<RouteEntry>(next.routes);\n    const custom = next.custom || {};\n    this.state.custom = {\n      data: custom.data || {},\n      logs: ensureArray<CustomLogEntry>(custom.logs),\n    };\n    // Extract registry and unknown panels into extra.\n    // Built-in state keys are already assigned above; everything else\n    // (including registry panels like jserrors) goes into extra.\n    const builtinStateKeys = new Set([\n      'template', 'session', 'requests', 'sql', 'logs',\n      'config', 'routes', 'custom',\n    ]);\n    const extra: Record<string, any> = {};\n    this.panels.forEach((panel) => {\n      if (!builtinStateKeys.has(panel) && panel in next) {\n        extra[panel] = (next as any)[panel];\n      }\n    });\n    this.state.extra = extra;\n\n    this.updateTabCounts();\n    this.renderPanel();\n  }\n\n  private trim<T>(list: T[], max: number): void {\n    if (!Array.isArray(list) || max <= 0) {\n      return;\n    }\n    while (list.length > max) {\n      list.shift();\n    }\n  }\n\n  private isSlowQuery(entry: SQLEntry): boolean {\n    return isSlowDuration(entry?.duration, this.slowThresholdMs);\n  }\n\n  private async fetchSnapshot(): Promise<void> {\n    if (!this.debugPath) {\n      return;\n    }\n    if (this.activeSessionId) {\n      return;\n    }\n    try {\n      const response = await fetch(`${this.debugPath}/api/snapshot`, {\n        credentials: 'same-origin',\n      });\n      if (!response.ok) {\n        return;\n      }\n      const payload = (await response.json()) as DebugSnapshot;\n      this.applySnapshot(payload);\n    } catch {\n      // ignore fetch errors\n    }\n  }\n\n  private clearAll(): void {\n    if (!this.debugPath) {\n      return;\n    }\n    this.stream.clear();\n    if (this.activeSessionId) {\n      return;\n    }\n    fetch(`${this.debugPath}/api/clear`, { method: 'POST', credentials: 'same-origin' }).catch(() => {\n      // ignore\n    });\n  }\n\n  private clearActivePanel(): void {\n    if (!this.debugPath) {\n      return;\n    }\n    const panel = this.activePanel;\n    this.stream.clear([panel]);\n    if (this.activeSessionId) {\n      return;\n    }\n    fetch(`${this.debugPath}/api/clear/${panel}`, { method: 'POST', credentials: 'same-origin' }).catch(() => {\n      // ignore\n    });\n  }\n\n  private togglePause(button: HTMLButtonElement): void {\n    this.paused = !this.paused;\n    button.textContent = this.paused ? 'Resume' : 'Pause';\n    if (!this.paused) {\n      this.stream.requestSnapshot();\n    }\n  }\n}\n\nexport const initDebugPanel = (container?: HTMLElement | null): DebugPanel | null => {\n  const target = container || document.querySelector<HTMLElement>('[data-debug-console]');\n  if (!target) {\n    return null;\n  }\n  return new DebugPanel(target);\n};\n","import { DebugPanel, initDebugPanel } from './debug-panel.js';\nimport { DebugStream, RemoteDebugStream } from './debug-stream.js';\n\nconst autoInit = () => {\n  initDebugPanel();\n};\n\nif (document.readyState === 'loading') {\n  document.addEventListener('DOMContentLoaded', autoInit);\n} else {\n  autoInit();\n}\n\n// Core exports\nexport { DebugPanel, DebugStream, RemoteDebugStream, initDebugPanel };\nexport type {\n  DebugEvent,\n  DebugStreamOptions,\n  DebugStreamStatus,\n  RemoteDebugStreamOptions,\n  RemoteDebugToken,\n} from './debug-stream.js';\n\n// Panel registry - for custom panel registration\nexport {\n  panelRegistry,\n  type PanelDefinition,\n  type PanelRegistry,\n  type RegistryChangeEvent,\n  type RegistryChangeListener,\n  getSnapshotKey,\n  normalizeEventTypes,\n  defaultGetCount,\n  defaultHandleEvent,\n  getPanelData,\n  getPanelCount,\n  renderPanelContent,\n} from './shared/panel-registry.js';\n\n// Style infrastructure - for uniform panel styling\nexport {\n  type StyleConfig,\n  consoleStyles,\n  toolbarStyles,\n  getStyleConfig,\n} from './shared/styles.js';\n\n// Utilities - for panel rendering\nexport {\n  escapeHTML,\n  formatTimestamp,\n  formatDuration,\n  formatJSON,\n  formatNumber,\n  truncate,\n  countPayload,\n  isSlowDuration,\n  getStatusClass,\n  getLevelClass,\n} from './shared/utils.js';\n\n// Interaction helpers - for copy/expand behaviors\nexport {\n  attachCopyListeners,\n  attachExpandableRowListeners,\n  copyToClipboard,\n  DATA_ATTRS,\n  INTERACTION_CLASSES,\n} from './shared/interactions.js';\n\n// Shared panel renderers - for building custom panels\nexport {\n  renderRequestsPanel,\n  renderSQLPanel,\n  renderLogsPanel,\n  renderRoutesPanel,\n  renderJSONPanel,\n  renderJSONViewer,\n  renderCustomPanel,\n} from './shared/panels/index.js';\n\n// Types\nexport type {\n  RequestEntry,\n  SQLEntry,\n  LogEntry,\n  RouteEntry,\n  CustomLogEntry,\n  CustomSnapshot,\n  DebugSnapshot,\n  PanelOptions,\n} from './shared/types.js';\n"],"names":["Hooks","name","callback","first","env","Plugins","jsep","_len","plugins","_key","plugin","Jsep","op_name","precedence","isRightAssociative","char","literal_name","literal_value","expr","obj","k","ch","op_val","message","error","node","nodes","untilICode","ch_i","to_check","tc_len","biop","prec","stack","biop_info","left","right","i","cur_biop","comparePrev","prev","argument","optional","number","chCode","str","startIndex","quote","closed","start","termination","args","separator_count","arg","hooks","stdClassProps","prop","m","CONDITIONAL_EXP","ternary","test","consequent","alternate","newTest","FSLASH_CODE","BSLASH_CODE","index","patternIndex","inCharSet","pattern","flags","code","value","e","PLUS_CODE","MINUS_CODE","updateNodeTypes","op","c","updateBinariesToAssignments","val","BLOCKED_PROTO_PROPERTIES","SafeEval","ast","subs","a","b","last","result","el","id","SafeScript","context","keyMap","push","arr","item","unshift","NewError","JSONPath","opts","otherTypeCallback","optObj","ret","json","currParent","currParentProperty","flatten","wrap","exprList","ea","rslt","valOrPath","resultType","path","fullRetObj","type","preferredOutput","parent","parentPropName","hasArrExpr","literalPriority","retObj","loc","x","addRet","elems","t","safeLoc","nested","npath","nvalue","addType","valueType","locProp","parts","part","rett","tmp","tl","tt","f","n","len","step","end","_v","_vname","containsPath","scriptCacheKey","script","CurrEval","pathArr","p","pointer","cache","subx","$0","$1","ups","exp","match","moveToAnotherArray","source","target","conditionCb","il","Script","keys","funcs","key","values","vr","s","func","fString","lastStatementEnd","isJsonPathExpression","search","normalizeToJsonPath","searchWithJsonPath","data","expression","normalizedExpr","filterObjectBySearch","isJPath","filterByJsonPath","filterByKeyMatch","needle","out","results","extractLastPathSegment","bracketMatch","dotMatch","getDefaultPanels","registryPanels","panelRegistry","replPanelIDs","isKnownPanel","panel","replPanelLabels","getPanelLabel","panelId","def","getPanelEventTypes","normalizeEventTypes","buildEventToPanel","mapping","eventType","parseJSON","normalizeReplCommands","commands","raw","command","description","tags","tag","aliases","alias","mutates","normalizePanelList","filterObjectByKey","setNestedValue","dest","current","parseNumber","fallback","parsed","DebugPanel","container","panelsData","DebugStream","event","status","eventTypes","selector","button","tabs","escapeHTML","content","renderer","contentTypes","input","inputs","next","renderJSErrorsPanel","consoleStyles","snapshotKey","getSnapshotKey","attachRequestDetailListeners","attachExpandableRowListeners","attachCopyListeners","attachSQLSelectionListeners","replPanel","DebugReplPanel","types","entry","ct","method","newestFirst","hasBody","contentType","filtered","renderRequestsPanel","slowOnly","errorOnly","renderSQLPanel","level","haystack","formatJSON","renderLogsPanel","renderRoutesPanel","trackingFlag","sessions","session","aTime","rows","sessionId","userLabel","lastActivity","formatTimestamp","requestCount","formatNumber","isActive","action","actionLabel","actionClass","rowClass","currentPage","ip","refreshLabel","hasData","hasLogs","renderCustomPanel","title","isObject","isArray","renderSharedJSONPanel","force","response","payload","updated","sessionID","trimmed","mode","base","countPayload","options","option","selected","count","badge","currentData","newData","defaultHandleEvent","snapshot","ensureArray","custom","builtinStateKeys","extra","list","max","isSlowDuration","initDebugPanel","autoInit"],"mappings":"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","x_google_ignoreList":[0]}