{"version":3,"file":"toolbar.js","sources":["../../src/debug/toolbar/toolbar-styles.ts","../../src/debug/toolbar/panel-renderers.ts","../../src/debug/toolbar/debug-toolbar.ts","../../src/debug/toolbar/fab-styles.ts","../../src/debug/toolbar/debug-fab.ts","../../src/debug/toolbar/debug-manager.ts"],"sourcesContent":["// Shadow DOM styles for the debug toolbar\n// Self-contained CSS that won't leak to or from the host page\n\nexport const toolbarStyles = `\n  :host {\n    --toolbar-bg: #1e1e2e;\n    --toolbar-bg-secondary: #181825;\n    --toolbar-border: #313244;\n    --toolbar-text: #cdd6f4;\n    --toolbar-text-muted: #6c7086;\n    --toolbar-accent: #89b4fa;\n    --toolbar-accent-hover: #b4befe;\n    --toolbar-success: #a6e3a1;\n    --toolbar-warning: #f9e2af;\n    --toolbar-error: #f38ba8;\n    --toolbar-info: #89dceb;\n    --toolbar-height-collapsed: 36px;\n    --toolbar-height-expanded: 320px;\n    --toolbar-font: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, \"Liberation Mono\", \"Courier New\", monospace;\n\n    position: fixed;\n    bottom: 0;\n    left: 0;\n    right: 0;\n    z-index: 99999;\n    font-family: var(--toolbar-font);\n    font-size: 12px;\n    line-height: 1.4;\n    pointer-events: auto;\n  }\n\n  * {\n    box-sizing: border-box;\n    margin: 0;\n    padding: 0;\n  }\n\n  .toolbar {\n    background: var(--toolbar-bg);\n    border-top: 1px solid var(--toolbar-border);\n    color: var(--toolbar-text);\n    transition: height 0.2s ease-out, transform 0.3s cubic-bezier(0.4, 0, 0.2, 1), opacity 0.2s ease;\n    display: flex;\n    flex-direction: column;\n  }\n\n  .toolbar.collapsed {\n    height: var(--toolbar-height-collapsed);\n  }\n\n  .toolbar.expanded {\n    height: var(--toolbar-height-expanded);\n  }\n\n  .toolbar.hidden {\n    transform: translateY(100%);\n    opacity: 0;\n    pointer-events: none;\n  }\n\n  /* Header with tabs */\n  .toolbar-header {\n    display: flex;\n    justify-content: space-between;\n    align-items: center;\n    padding: 0 12px;\n    height: 36px;\n    min-height: 36px;\n    border-bottom: 1px solid var(--toolbar-border);\n    background: var(--toolbar-bg-secondary);\n  }\n\n  .toolbar-tabs {\n    display: flex;\n    gap: 2px;\n    overflow-x: auto;\n    scrollbar-width: none;\n  }\n\n  .toolbar-tabs::-webkit-scrollbar {\n    display: none;\n  }\n\n  .tab {\n    background: transparent;\n    border: none;\n    color: var(--toolbar-text-muted);\n    padding: 6px 10px;\n    cursor: pointer;\n    border-radius: 4px;\n    font-size: 11px;\n    font-family: inherit;\n    white-space: nowrap;\n    transition: all 0.15s ease;\n    display: flex;\n    align-items: center;\n    gap: 6px;\n  }\n\n  .tab:hover {\n    background: rgba(137, 180, 250, 0.1);\n    color: var(--toolbar-text);\n  }\n\n  .tab.active {\n    background: var(--toolbar-accent);\n    color: var(--toolbar-bg);\n  }\n\n  .tab-count {\n    font-size: 10px;\n    background: rgba(255, 255, 255, 0.15);\n    padding: 1px 5px;\n    border-radius: 8px;\n    min-width: 18px;\n    text-align: center;\n  }\n\n  .tab.active .tab-count {\n    background: rgba(0, 0, 0, 0.2);\n  }\n\n  /* Actions */\n  .toolbar-actions {\n    display: flex;\n    gap: 4px;\n    align-items: center;\n  }\n\n  .connection-indicator {\n    display: flex;\n    align-items: center;\n    padding: 0 8px;\n  }\n\n  .connection-indicator .status-dot {\n    width: 8px;\n    height: 8px;\n  }\n\n  .action-btn {\n    background: transparent;\n    border: none;\n    color: var(--toolbar-text-muted);\n    cursor: pointer;\n    padding: 6px 8px;\n    font-size: 14px;\n    font-family: inherit;\n    border-radius: 4px;\n    transition: all 0.15s ease;\n    display: flex;\n    align-items: center;\n    justify-content: center;\n  }\n\n  .action-btn:hover {\n    background: rgba(137, 180, 250, 0.1);\n    color: var(--toolbar-text);\n  }\n\n  .action-btn.toggle-btn {\n    font-size: 12px;\n    padding: 6px 10px;\n  }\n\n  .action-btn.collapse-btn:hover {\n    background: rgba(243, 139, 168, 0.2);\n    color: var(--toolbar-error);\n  }\n\n  .expand-link {\n    color: var(--toolbar-text-muted);\n    text-decoration: none;\n    padding: 6px 8px;\n    font-size: 14px;\n    border-radius: 4px;\n    transition: all 0.15s ease;\n    display: flex;\n    align-items: center;\n    justify-content: center;\n  }\n\n  .expand-link:hover {\n    background: rgba(137, 180, 250, 0.1);\n    color: var(--toolbar-text);\n  }\n\n  /* Content area */\n  .toolbar-content {\n    flex: 1;\n    overflow: hidden;\n    display: flex;\n    flex-direction: column;\n  }\n\n  .panel-container {\n    flex: 1;\n    overflow: auto;\n    padding: 8px 12px;\n    scrollbar-width: thin;\n    scrollbar-color: var(--toolbar-border) transparent;\n  }\n\n  .panel-container::-webkit-scrollbar {\n    width: 6px;\n  }\n\n  .panel-container::-webkit-scrollbar-track {\n    background: transparent;\n  }\n\n  .panel-container::-webkit-scrollbar-thumb {\n    background: var(--toolbar-border);\n    border-radius: 3px;\n  }\n\n  /* Summary bar (shown when collapsed) */\n  .toolbar-summary {\n    display: flex;\n    gap: 16px;\n    padding: 0 12px;\n    height: 36px;\n    align-items: center;\n    cursor: pointer;\n    background: var(--toolbar-bg);\n    transition: background 0.15s ease;\n  }\n\n  .toolbar-summary:hover {\n    background: var(--toolbar-bg-secondary);\n  }\n\n  .toolbar.expanded .toolbar-summary {\n    display: none;\n  }\n\n  .summary-item {\n    display: flex;\n    align-items: center;\n    gap: 6px;\n    color: var(--toolbar-text-muted);\n    font-size: 11px;\n  }\n\n  .summary-item .count {\n    color: var(--toolbar-text);\n    font-weight: 600;\n  }\n\n  .summary-item.has-errors .count {\n    color: var(--toolbar-error);\n  }\n\n  .summary-item.has-slow .count {\n    color: var(--toolbar-warning);\n  }\n\n  .connection-status {\n    display: flex;\n    align-items: center;\n    gap: 6px;\n    margin-left: auto;\n  }\n\n  .status-dot {\n    width: 6px;\n    height: 6px;\n    border-radius: 50%;\n    background: var(--toolbar-text-muted);\n  }\n\n  .status-dot.connected {\n    background: var(--toolbar-success);\n    box-shadow: 0 0 4px var(--toolbar-success);\n  }\n\n  .status-dot.error {\n    background: var(--toolbar-error);\n    box-shadow: 0 0 4px var(--toolbar-error);\n  }\n\n  .status-dot.reconnecting {\n    background: var(--toolbar-warning);\n    animation: pulse 1s ease-in-out infinite;\n  }\n\n  @keyframes pulse {\n    0%, 100% { opacity: 1; }\n    50% { opacity: 0.4; }\n  }\n\n  /* Table styles */\n  table {\n    width: 100%;\n    border-collapse: collapse;\n    font-size: 11px;\n  }\n\n  th, td {\n    text-align: left;\n    padding: 6px 8px;\n    border-bottom: 1px solid var(--toolbar-border);\n    vertical-align: top;\n  }\n\n  th {\n    color: var(--toolbar-text-muted);\n    font-weight: 500;\n    font-size: 10px;\n    text-transform: uppercase;\n    letter-spacing: 0.05em;\n    position: sticky;\n    top: 0;\n    background: var(--toolbar-bg);\n    z-index: 1;\n  }\n\n  tr:hover td {\n    background: rgba(137, 180, 250, 0.05);\n  }\n\n  /* Badges */\n  .badge {\n    display: inline-block;\n    padding: 2px 6px;\n    border-radius: 4px;\n    font-size: 10px;\n    font-weight: 600;\n    text-transform: uppercase;\n    letter-spacing: 0.03em;\n  }\n\n  .badge-method {\n    background: rgba(137, 180, 250, 0.2);\n    color: var(--toolbar-accent);\n  }\n\n  .badge-method.get { background: rgba(166, 227, 161, 0.2); color: var(--toolbar-success); }\n  .badge-method.post { background: rgba(137, 180, 250, 0.2); color: var(--toolbar-accent); }\n  .badge-method.put { background: rgba(249, 226, 175, 0.2); color: var(--toolbar-warning); }\n  .badge-method.patch { background: rgba(249, 226, 175, 0.2); color: var(--toolbar-warning); }\n  .badge-method.delete { background: rgba(243, 139, 168, 0.2); color: var(--toolbar-error); }\n\n  .badge-status {\n    background: rgba(166, 227, 161, 0.2);\n    color: var(--toolbar-success);\n  }\n\n  .badge-status.error {\n    background: rgba(243, 139, 168, 0.2);\n    color: var(--toolbar-error);\n  }\n\n  .badge-status.warn {\n    background: rgba(249, 226, 175, 0.2);\n    color: var(--toolbar-warning);\n  }\n\n  .badge-level {\n    min-width: 40px;\n    text-align: center;\n  }\n\n  .badge-level.debug { background: rgba(108, 112, 134, 0.3); color: var(--toolbar-text-muted); }\n  .badge-level.info { background: rgba(137, 220, 235, 0.2); color: var(--toolbar-info); }\n  .badge-level.warn { background: rgba(249, 226, 175, 0.2); color: var(--toolbar-warning); }\n  .badge-level.error { background: rgba(243, 139, 168, 0.2); color: var(--toolbar-error); }\n\n  /* Query highlighting */\n  .slow-query {\n    color: var(--toolbar-warning);\n  }\n\n  .error-query {\n    color: var(--toolbar-error);\n  }\n\n  /* Code/pre */\n  pre, code {\n    font-family: var(--toolbar-font);\n    font-size: 11px;\n  }\n\n  pre {\n    margin: 0;\n    white-space: pre-wrap;\n    word-break: break-word;\n    color: var(--toolbar-text);\n  }\n\n  .query-text {\n    max-width: 400px;\n    overflow: hidden;\n    text-overflow: ellipsis;\n    white-space: nowrap;\n  }\n\n  .query-text:hover {\n    white-space: pre-wrap;\n    word-break: break-all;\n  }\n\n  /* Empty state */\n  .empty-state {\n    color: var(--toolbar-text-muted);\n    text-align: center;\n    padding: 24px;\n    font-size: 12px;\n  }\n\n  /* JSON viewer */\n  .json-viewer {\n    background: var(--toolbar-bg-secondary);\n    border-radius: 4px;\n    padding: 8px;\n    overflow: auto;\n    max-height: 100%;\n  }\n\n  .json-viewer pre {\n    font-size: 11px;\n    line-height: 1.5;\n  }\n\n  /* Duration formatting */\n  .duration {\n    color: var(--toolbar-text-muted);\n    font-variant-numeric: tabular-nums;\n  }\n\n  .duration.slow {\n    color: var(--toolbar-warning);\n    font-weight: 600;\n  }\n\n  /* Timestamp */\n  .timestamp {\n    color: var(--toolbar-text-muted);\n    font-variant-numeric: tabular-nums;\n    white-space: nowrap;\n  }\n\n  /* Path/URL */\n  .path {\n    color: var(--toolbar-text);\n    max-width: 300px;\n    overflow: hidden;\n    text-overflow: ellipsis;\n    white-space: nowrap;\n  }\n\n  /* Message */\n  .message {\n    color: var(--toolbar-text);\n    max-width: 400px;\n    overflow: hidden;\n    text-overflow: ellipsis;\n    white-space: nowrap;\n  }\n\n  .message:hover {\n    white-space: normal;\n    word-break: break-word;\n  }\n\n  /* Responsive */\n  @media (max-width: 768px) {\n    :host {\n      --toolbar-height-expanded: 50vh;\n    }\n\n    .toolbar-tabs {\n      max-width: 60%;\n    }\n  }\n`;\n","// Panel renderers for the debug toolbar\n// Each function returns HTML string for a specific panel type\n\nexport type RequestEntry = {\n  id?: string;\n  timestamp?: string;\n  method?: string;\n  path?: string;\n  status?: number;\n  duration?: number;\n  headers?: Record<string, string>;\n  query?: Record<string, string>;\n  error?: string;\n};\n\nexport type SQLEntry = {\n  id?: string;\n  timestamp?: string;\n  query?: string;\n  args?: unknown[];\n  duration?: number;\n  row_count?: number;\n  error?: string;\n};\n\nexport type LogEntry = {\n  timestamp?: string;\n  level?: string;\n  message?: string;\n  fields?: Record<string, unknown>;\n  source?: string;\n};\n\nexport type RouteEntry = {\n  method?: string;\n  path?: string;\n  name?: string;\n  handler?: string;\n  middleware?: string[];\n  summary?: string;\n  tags?: string[];\n};\n\nexport type CustomLogEntry = {\n  timestamp?: string;\n  category?: string;\n  message?: string;\n  fields?: Record<string, unknown>;\n};\n\nexport type CustomSnapshot = {\n  data?: Record<string, unknown>;\n  logs?: CustomLogEntry[];\n};\n\nexport type DebugSnapshot = {\n  template?: Record<string, unknown>;\n  session?: Record<string, unknown>;\n  requests?: RequestEntry[];\n  sql?: SQLEntry[];\n  logs?: LogEntry[];\n  config?: Record<string, unknown>;\n  routes?: RouteEntry[];\n  custom?: CustomSnapshot;\n};\n\n// Utility functions\nconst escapeHTML = (value: unknown): string => {\n  const str = String(value ?? '');\n  return str\n    .replace(/&/g, '&amp;')\n    .replace(/</g, '&lt;')\n    .replace(/>/g, '&gt;')\n    .replace(/\"/g, '&quot;')\n    .replace(/'/g, '&#39;');\n};\n\nconst formatTimestamp = (value: unknown): string => {\n  if (!value) return '';\n  if (typeof value === 'number') {\n    return new Date(value).toLocaleTimeString();\n  }\n  if (typeof value === 'string') {\n    const date = new Date(value);\n    if (!Number.isNaN(date.getTime())) {\n      return date.toLocaleTimeString();\n    }\n    return value;\n  }\n  return '';\n};\n\nconst formatDuration = (value: unknown, slowThresholdMs = 50): { text: string; isSlow: boolean } => {\n  if (value === null || value === undefined) {\n    return { text: '0ms', isSlow: false };\n  }\n  const nanos = Number(value);\n  if (Number.isNaN(nanos)) {\n    return { text: '0ms', isSlow: false };\n  }\n  const ms = nanos / 1e6;\n  const isSlow = ms >= slowThresholdMs;\n  if (ms < 1) {\n    const micros = nanos / 1e3;\n    return { text: `${micros.toFixed(1)}Âµs`, isSlow };\n  }\n  if (ms < 1000) {\n    return { text: `${ms.toFixed(2)}ms`, isSlow };\n  }\n  return { text: `${(ms / 1000).toFixed(2)}s`, isSlow };\n};\n\nconst formatJSON = (value: unknown): string => {\n  if (value === undefined || value === null) return '{}';\n  try {\n    return JSON.stringify(value, null, 2);\n  } catch {\n    return String(value ?? '');\n  }\n};\n\nconst truncate = (str: string, len: number): string => {\n  if (!str) return '';\n  return str.length > len ? str.substring(0, len) + '...' : str;\n};\n\nconst getStatusClass = (status: number | undefined): string => {\n  if (!status) return '';\n  if (status >= 500) return 'error';\n  if (status >= 400) return 'warn';\n  return '';\n};\n\nconst getLevelClass = (level: string | undefined): string => {\n  if (!level) return 'info';\n  const l = level.toLowerCase();\n  if (l === 'error' || l === 'fatal') return 'error';\n  if (l === 'warn' || l === 'warning') return 'warn';\n  if (l === 'debug' || l === 'trace') return 'debug';\n  return 'info';\n};\n\n// Panel render functions\nexport function renderPanel(\n  panel: string,\n  snapshot: DebugSnapshot,\n  slowThresholdMs = 50\n): string {\n  switch (panel) {\n    case 'requests':\n      return renderRequests(snapshot.requests || []);\n    case 'sql':\n      return renderSQL(snapshot.sql || [], slowThresholdMs);\n    case 'logs':\n      return renderLogs(snapshot.logs || []);\n    case 'config':\n      return renderJSON('Config', snapshot.config || {});\n    case 'routes':\n      return renderRoutes(snapshot.routes || []);\n    case 'template':\n      return renderJSON('Template Context', snapshot.template || {});\n    case 'session':\n      return renderJSON('Session', snapshot.session || {});\n    case 'custom':\n      return renderCustom(snapshot.custom || {});\n    default:\n      return `<div class=\"empty-state\">Panel \"${escapeHTML(panel)}\" not available</div>`;\n  }\n}\n\nfunction renderRequests(requests: RequestEntry[]): string {\n  if (!requests.length) {\n    return '<div class=\"empty-state\">No requests captured</div>';\n  }\n\n  const rows = requests\n    .slice(-50)\n    .reverse()\n    .map((req) => {\n      const methodClass = (req.method || 'get').toLowerCase();\n      const statusClass = getStatusClass(req.status);\n      const duration = formatDuration(req.duration);\n      return `\n        <tr>\n          <td><span class=\"badge badge-method ${methodClass}\">${escapeHTML(req.method || 'GET')}</span></td>\n          <td class=\"path\" title=\"${escapeHTML(req.path || '')}\">${escapeHTML(truncate(req.path || '', 50))}</td>\n          <td><span class=\"badge badge-status ${statusClass}\">${escapeHTML(req.status || '-')}</span></td>\n          <td class=\"duration ${duration.isSlow ? 'slow' : ''}\">${duration.text}</td>\n          <td class=\"timestamp\">${escapeHTML(formatTimestamp(req.timestamp))}</td>\n        </tr>\n      `;\n    })\n    .join('');\n\n  return `\n    <table>\n      <thead>\n        <tr>\n          <th>Method</th>\n          <th>Path</th>\n          <th>Status</th>\n          <th>Duration</th>\n          <th>Time</th>\n        </tr>\n      </thead>\n      <tbody>${rows}</tbody>\n    </table>\n  `;\n}\n\nfunction renderSQL(queries: SQLEntry[], slowThresholdMs: number): string {\n  if (!queries.length) {\n    return '<div class=\"empty-state\">No SQL queries captured</div>';\n  }\n\n  const rows = queries\n    .slice(-50)\n    .reverse()\n    .map((q) => {\n      const duration = formatDuration(q.duration, slowThresholdMs);\n      const rowClasses = [];\n      if (duration.isSlow) rowClasses.push('slow-query');\n      if (q.error) rowClasses.push('error-query');\n      return `\n        <tr class=\"${rowClasses.join(' ')}\">\n          <td class=\"query-text\" title=\"${escapeHTML(q.query || '')}\">${escapeHTML(truncate(q.query || '', 80))}</td>\n          <td class=\"duration ${duration.isSlow ? 'slow' : ''}\">${duration.text}</td>\n          <td>${escapeHTML(q.row_count ?? '-')}</td>\n          <td class=\"timestamp\">${escapeHTML(formatTimestamp(q.timestamp))}</td>\n        </tr>\n      `;\n    })\n    .join('');\n\n  return `\n    <table>\n      <thead>\n        <tr>\n          <th>Query</th>\n          <th>Duration</th>\n          <th>Rows</th>\n          <th>Time</th>\n        </tr>\n      </thead>\n      <tbody>${rows}</tbody>\n    </table>\n  `;\n}\n\nfunction renderLogs(logs: LogEntry[]): string {\n  if (!logs.length) {\n    return '<div class=\"empty-state\">No logs captured</div>';\n  }\n\n  const rows = logs\n    .slice(-100)\n    .reverse()\n    .map((log) => {\n      const levelClass = getLevelClass(log.level);\n      return `\n        <tr>\n          <td><span class=\"badge badge-level ${levelClass}\">${escapeHTML((log.level || 'INFO').toUpperCase())}</span></td>\n          <td class=\"message\" title=\"${escapeHTML(log.message || '')}\">${escapeHTML(truncate(log.message || '', 100))}</td>\n          <td class=\"timestamp\">${escapeHTML(formatTimestamp(log.timestamp))}</td>\n        </tr>\n      `;\n    })\n    .join('');\n\n  return `\n    <table>\n      <thead>\n        <tr>\n          <th>Level</th>\n          <th>Message</th>\n          <th>Time</th>\n        </tr>\n      </thead>\n      <tbody>${rows}</tbody>\n    </table>\n  `;\n}\n\nfunction renderRoutes(routes: RouteEntry[]): string {\n  if (!routes.length) {\n    return '<div class=\"empty-state\">No routes available</div>';\n  }\n\n  const rows = routes\n    .map((r) => {\n      const methodClass = (r.method || 'get').toLowerCase();\n      return `\n        <tr>\n          <td><span class=\"badge badge-method ${methodClass}\">${escapeHTML(r.method || '')}</span></td>\n          <td class=\"path\">${escapeHTML(r.path || '')}</td>\n          <td>${escapeHTML(r.handler || '-')}</td>\n        </tr>\n      `;\n    })\n    .join('');\n\n  return `\n    <table>\n      <thead>\n        <tr>\n          <th>Method</th>\n          <th>Path</th>\n          <th>Handler</th>\n        </tr>\n      </thead>\n      <tbody>${rows}</tbody>\n    </table>\n  `;\n}\n\nfunction renderJSON(title: string, data: Record<string, unknown>): string {\n  const keys = Object.keys(data || {});\n  if (!keys.length) {\n    return `<div class=\"empty-state\">No ${title.toLowerCase()} data available</div>`;\n  }\n\n  return `\n    <div class=\"json-viewer\">\n      <pre>${escapeHTML(formatJSON(data))}</pre>\n    </div>\n  `;\n}\n\nfunction renderCustom(custom: CustomSnapshot): string {\n  const data = custom.data || {};\n  const logs = custom.logs || [];\n\n  if (!Object.keys(data).length && !logs.length) {\n    return '<div class=\"empty-state\">No custom data captured</div>';\n  }\n\n  let content = '';\n\n  if (Object.keys(data).length) {\n    content += `\n      <div class=\"json-viewer\">\n        <pre>${escapeHTML(formatJSON(data))}</pre>\n      </div>\n    `;\n  }\n\n  if (logs.length) {\n    const logRows = logs\n      .slice(-50)\n      .reverse()\n      .map((log) => `\n        <tr>\n          <td><span class=\"badge\">${escapeHTML(log.category || 'custom')}</span></td>\n          <td class=\"message\">${escapeHTML(log.message || '')}</td>\n          <td class=\"timestamp\">${escapeHTML(formatTimestamp(log.timestamp))}</td>\n        </tr>\n      `)\n      .join('');\n\n    content += `\n      <table>\n        <thead>\n          <tr>\n            <th>Category</th>\n            <th>Message</th>\n            <th>Time</th>\n          </tr>\n        </thead>\n        <tbody>${logRows}</tbody>\n      </table>\n    `;\n  }\n\n  return content;\n}\n\n// Get counts for summary display\nexport function getCounts(snapshot: DebugSnapshot): {\n  requests: number;\n  sql: number;\n  logs: number;\n  errors: number;\n  slowQueries: number;\n} {\n  const requests = snapshot.requests?.length || 0;\n  const sql = snapshot.sql?.length || 0;\n  const logs = snapshot.logs?.length || 0;\n\n  // Count errors\n  const requestErrors = (snapshot.requests || []).filter((r) => (r.status || 0) >= 400).length;\n  const sqlErrors = (snapshot.sql || []).filter((q) => q.error).length;\n  const logErrors = (snapshot.logs || []).filter((l) => {\n    const level = (l.level || '').toLowerCase();\n    return level === 'error' || level === 'fatal';\n  }).length;\n\n  // Count slow queries (using default 50ms threshold)\n  const slowQueries = (snapshot.sql || []).filter((q) => {\n    const nanos = Number(q.duration);\n    if (Number.isNaN(nanos)) return false;\n    return nanos / 1e6 >= 50;\n  }).length;\n\n  return {\n    requests,\n    sql,\n    logs,\n    errors: requestErrors + sqlErrors + logErrors,\n    slowQueries,\n  };\n}\n","// Debug Toolbar Web Component\n// A self-contained toolbar that displays debug information at the bottom of the page\n// Works in conjunction with DebugFab for collapsed state\n\nimport { DebugStream, type DebugEvent, type DebugStreamStatus } from '../debug-stream.js';\nimport { toolbarStyles } from './toolbar-styles.js';\nimport { renderPanel, getCounts, type DebugSnapshot } from './panel-renderers.js';\n\n// Panel configuration\nconst defaultPanels = ['requests', 'sql', 'logs', 'routes', 'config'];\n\nconst panelLabels: Record<string, string> = {\n  template: 'Template',\n  session: 'Session',\n  requests: 'Requests',\n  sql: 'SQL',\n  logs: 'Logs',\n  config: 'Config',\n  routes: 'Routes',\n  custom: 'Custom',\n};\n\nconst panelEventMap: Record<string, string> = {\n  template: 'template',\n  session: 'session',\n  requests: 'request',\n  sql: 'sql',\n  logs: 'log',\n  custom: 'custom',\n};\n\nconst eventToPanel: Record<string, string> = {\n  request: 'requests',\n  sql: 'sql',\n  log: 'logs',\n  template: 'template',\n  session: 'session',\n  custom: 'custom',\n};\n\nexport class DebugToolbar extends HTMLElement {\n  private shadow: ShadowRoot;\n  private stream: DebugStream | null = null;\n  private externalStream: DebugStream | null = null;\n  private snapshot: DebugSnapshot = {};\n  private expanded = false;\n  private activePanel = 'requests';\n  private connectionStatus: DebugStreamStatus = 'disconnected';\n  private slowThresholdMs = 50;\n  private useFab = false;\n\n  static get observedAttributes(): string[] {\n    return ['base-path', 'debug-path', 'panels', 'expanded', 'slow-threshold-ms', 'use-fab'];\n  }\n\n  constructor() {\n    super();\n    this.shadow = this.attachShadow({ mode: 'open' });\n  }\n\n  connectedCallback(): void {\n    this.loadState();\n    this.render();\n    // Only init WebSocket if not using FAB (FAB manages its own connection)\n    if (!this.useFab) {\n      this.initWebSocket();\n      this.fetchInitialSnapshot();\n    }\n    this.setupKeyboardShortcut();\n  }\n\n  disconnectedCallback(): void {\n    this.stream?.close();\n    document.removeEventListener('keydown', this.handleKeyDown);\n  }\n\n  attributeChangedCallback(name: string, oldValue: string | null, newValue: string | null): void {\n    if (oldValue === newValue) return;\n\n    if (name === 'expanded') {\n      this.expanded = newValue === 'true' || newValue === '';\n      this.saveState();\n      this.render();\n    } else if (name === 'slow-threshold-ms') {\n      this.slowThresholdMs = parseInt(newValue || '50', 10) || 50;\n    } else if (name === 'use-fab') {\n      this.useFab = newValue === 'true' || newValue === '';\n    }\n  }\n\n  // Public API for FAB integration\n  public setExpanded(expanded: boolean): void {\n    this.expanded = expanded;\n    this.saveState();\n    this.render();\n  }\n\n  public setSnapshot(snapshot: DebugSnapshot): void {\n    this.snapshot = snapshot || {};\n    this.updateContent();\n  }\n\n  public setConnectionStatus(status: DebugStreamStatus): void {\n    this.connectionStatus = status;\n    this.updateConnectionStatus();\n  }\n\n  public setStream(stream: DebugStream): void {\n    this.externalStream = stream;\n  }\n\n  public isExpanded(): boolean {\n    return this.expanded;\n  }\n\n  // State persistence\n  private loadState(): void {\n    try {\n      const stored = localStorage.getItem('debug-toolbar-expanded');\n      if (stored !== null) {\n        this.expanded = stored === 'true';\n      }\n    } catch {\n      // Ignore localStorage errors\n    }\n  }\n\n  private saveState(): void {\n    try {\n      localStorage.setItem('debug-toolbar-expanded', String(this.expanded));\n    } catch {\n      // Ignore localStorage errors\n    }\n  }\n\n  // Keyboard shortcut\n  private handleKeyDown = (e: KeyboardEvent): void => {\n    // Ctrl+Shift+D or Cmd+Shift+D to toggle\n    if ((e.ctrlKey || e.metaKey) && e.shiftKey && e.key.toLowerCase() === 'd') {\n      e.preventDefault();\n      this.toggleExpanded();\n    }\n    // Escape to collapse\n    if (e.key === 'Escape' && this.expanded) {\n      this.collapse();\n    }\n  };\n\n  private setupKeyboardShortcut(): void {\n    document.addEventListener('keydown', this.handleKeyDown);\n  }\n\n  private toggleExpanded(): void {\n    this.expanded = !this.expanded;\n    this.saveState();\n    this.render();\n    this.dispatchExpandEvent();\n  }\n\n  private collapse(): void {\n    if (!this.expanded) return;\n    this.expanded = false;\n    this.saveState();\n    this.render();\n    this.dispatchExpandEvent();\n  }\n\n  private dispatchExpandEvent(): void {\n    this.dispatchEvent(new CustomEvent('debug-expand', {\n      detail: { expanded: this.expanded },\n      bubbles: true,\n      composed: true,\n    }));\n  }\n\n  // Attribute getters\n  private get basePath(): string {\n    return this.getAttribute('base-path') || '/admin';\n  }\n\n  private get debugPath(): string {\n    const attr = this.getAttribute('debug-path');\n    if (attr) return attr;\n    return `${this.basePath}/debug`;\n  }\n\n  private get panels(): string[] {\n    const attr = this.getAttribute('panels');\n    if (attr) {\n      const parsed = attr\n        .split(',')\n        .map((p) => p.trim().toLowerCase())\n        .filter(Boolean);\n      return parsed.length ? parsed : defaultPanels;\n    }\n    return defaultPanels;\n  }\n\n  private get wsUrl(): string {\n    return `${this.debugPath}/ws`;\n  }\n\n  // Get the active stream (external from FAB or internal)\n  private getStream(): DebugStream | null {\n    return this.externalStream || this.stream;\n  }\n\n  // WebSocket initialization\n  private initWebSocket(): void {\n    this.stream = new DebugStream({\n      basePath: this.debugPath,\n      onEvent: (event) => this.handleEvent(event),\n      onStatusChange: (status) => this.handleStatusChange(status),\n    });\n\n    this.stream.connect();\n    this.stream.subscribe(this.panels.map((panel) => panelEventMap[panel] || panel));\n  }\n\n  // Fetch initial snapshot via HTTP\n  private async fetchInitialSnapshot(): Promise<void> {\n    try {\n      const response = await fetch(`${this.debugPath}/api/snapshot`, {\n        credentials: 'same-origin',\n      });\n      if (response.ok) {\n        const data = await response.json();\n        this.applySnapshot(data);\n      }\n    } catch {\n      // Ignore fetch errors - WebSocket will provide data\n    }\n  }\n\n  // Event handlers\n  private handleEvent(event: DebugEvent): void {\n    if (!event || !event.type) return;\n\n    if (event.type === 'snapshot') {\n      this.applySnapshot(event.payload as DebugSnapshot);\n      return;\n    }\n\n    // Apply incremental updates\n    const panel = eventToPanel[event.type] || event.type;\n    switch (event.type) {\n      case 'request':\n        this.snapshot.requests = this.snapshot.requests || [];\n        this.snapshot.requests.push(event.payload);\n        this.trimArray(this.snapshot.requests, 500);\n        break;\n      case 'sql':\n        this.snapshot.sql = this.snapshot.sql || [];\n        this.snapshot.sql.push(event.payload);\n        this.trimArray(this.snapshot.sql, 200);\n        break;\n      case 'log':\n        this.snapshot.logs = this.snapshot.logs || [];\n        this.snapshot.logs.push(event.payload);\n        this.trimArray(this.snapshot.logs, 500);\n        break;\n      case 'template':\n        this.snapshot.template = event.payload || {};\n        break;\n      case 'session':\n        this.snapshot.session = event.payload || {};\n        break;\n      case 'custom':\n        this.handleCustomEvent(event.payload);\n        break;\n    }\n\n    // Update UI if showing affected panel\n    if (panel === this.activePanel && this.expanded) {\n      this.updateContent();\n    }\n  }\n\n  private handleCustomEvent(payload: unknown): void {\n    if (!payload || typeof payload !== 'object') return;\n    this.snapshot.custom = this.snapshot.custom || { data: {}, logs: [] };\n\n    const p = payload as Record<string, unknown>;\n    if ('key' in p && 'value' in p) {\n      this.snapshot.custom.data = this.snapshot.custom.data || {};\n      this.snapshot.custom.data[String(p.key)] = p.value;\n    } else if ('category' in p || 'message' in p) {\n      this.snapshot.custom.logs = this.snapshot.custom.logs || [];\n      this.snapshot.custom.logs.push(payload as { category?: string; message?: string });\n      this.trimArray(this.snapshot.custom.logs, 500);\n    }\n  }\n\n  private handleStatusChange(status: DebugStreamStatus): void {\n    this.connectionStatus = status;\n    this.updateConnectionStatus();\n  }\n\n  private applySnapshot(data: DebugSnapshot): void {\n    this.snapshot = data || {};\n    this.updateContent();\n  }\n\n  private trimArray<T>(arr: T[], max: number): void {\n    while (arr.length > max) {\n      arr.shift();\n    }\n  }\n\n  // Rendering\n  private render(): void {\n    const counts = getCounts(this.snapshot);\n    const panelTabs = this.panels\n      .map((panel) => {\n        const label = panelLabels[panel] || panel;\n        const count = this.getPanelCount(panel);\n        const active = this.activePanel === panel ? 'active' : '';\n        return `\n          <button class=\"tab ${active}\" data-panel=\"${panel}\">\n            ${label}\n            <span class=\"tab-count\">${count}</span>\n          </button>\n        `;\n      })\n      .join('');\n\n    // When using FAB, toolbar is either expanded (visible) or collapsed (hidden)\n    // When not using FAB, show the summary bar in collapsed state\n    const showToolbar = this.useFab ? this.expanded : true;\n    const expandedClass = this.expanded ? 'expanded' : 'collapsed';\n    const hiddenClass = this.useFab && !this.expanded ? 'hidden' : '';\n\n    this.shadow.innerHTML = `\n      <style>${toolbarStyles}</style>\n      <div class=\"toolbar ${expandedClass} ${hiddenClass}\">\n        ${this.expanded ? `\n          <div class=\"toolbar-header\">\n            <div class=\"toolbar-tabs\">${panelTabs}</div>\n            <div class=\"toolbar-actions\">\n              <span class=\"connection-indicator\">\n                <span class=\"status-dot ${this.connectionStatus}\"></span>\n              </span>\n              <button class=\"action-btn\" data-action=\"refresh\" title=\"Refresh (get snapshot)\">\n                <svg viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" stroke-width=\"2\" width=\"14\" height=\"14\">\n                  <path d=\"M23 4v6h-6M1 20v-6h6\"/>\n                  <path d=\"M3.51 9a9 9 0 0 1 14.85-3.36L23 10M1 14l4.64 4.36A9 9 0 0 0 20.49 15\"/>\n                </svg>\n              </button>\n              <button class=\"action-btn\" data-action=\"clear\" title=\"Clear all data\">\n                <svg viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" stroke-width=\"2\" width=\"14\" height=\"14\">\n                  <path d=\"M3 6h18M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6m3 0V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2\"/>\n                </svg>\n              </button>\n              <a class=\"action-btn expand-link\" href=\"${this.debugPath}\" title=\"Open full debug page\">\n                <svg viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" stroke-width=\"2\" width=\"14\" height=\"14\">\n                  <path d=\"M15 3h6v6M9 21H3v-6M21 3l-7 7M3 21l7-7\"/>\n                </svg>\n              </a>\n              <button class=\"action-btn collapse-btn\" data-action=\"collapse\" title=\"Collapse (Esc)\">\n                <svg viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" stroke-width=\"2\" width=\"14\" height=\"14\">\n                  <path d=\"M18 6L6 18M6 6l12 12\"/>\n                </svg>\n              </button>\n            </div>\n          </div>\n          <div class=\"toolbar-content\">\n            <div class=\"panel-container\" id=\"panel-content\">\n              ${renderPanel(this.activePanel, this.snapshot, this.slowThresholdMs)}\n            </div>\n          </div>\n        ` : ''}\n        ${!this.useFab ? `\n          <div class=\"toolbar-summary\">\n            <div class=\"summary-item ${counts.errors > 0 ? 'has-errors' : ''}\">\n              <span>Requests:</span>\n              <span class=\"count\">${counts.requests}</span>\n            </div>\n            <div class=\"summary-item ${counts.slowQueries > 0 ? 'has-slow' : ''}\">\n              <span>SQL:</span>\n              <span class=\"count\">${counts.sql}</span>\n            </div>\n            <div class=\"summary-item\">\n              <span>Logs:</span>\n              <span class=\"count\">${counts.logs}</span>\n            </div>\n            ${counts.errors > 0 ? `\n              <div class=\"summary-item has-errors\">\n                <span>Errors:</span>\n                <span class=\"count\">${counts.errors}</span>\n              </div>\n            ` : ''}\n            <div class=\"connection-status\">\n              <span class=\"status-dot ${this.connectionStatus}\"></span>\n              <span>${this.connectionStatus}</span>\n            </div>\n          </div>\n        ` : ''}\n      </div>\n    `;\n\n    this.attachEventListeners();\n  }\n\n  private updateContent(): void {\n    // Update panel content if expanded\n    if (this.expanded) {\n      const container = this.shadow.getElementById('panel-content');\n      if (container) {\n        container.innerHTML = renderPanel(this.activePanel, this.snapshot, this.slowThresholdMs);\n      }\n      // Update tab counts\n      this.panels.forEach((panel) => {\n        const tab = this.shadow.querySelector(`[data-panel=\"${panel}\"] .tab-count`);\n        if (tab) {\n          tab.textContent = String(this.getPanelCount(panel));\n        }\n      });\n    }\n\n    // Update summary counts (only when not using FAB)\n    if (!this.useFab) {\n      this.updateSummary();\n    }\n  }\n\n  private updateSummary(): void {\n    const counts = getCounts(this.snapshot);\n    const summary = this.shadow.querySelector('.toolbar-summary');\n    if (!summary) return;\n\n    const items = summary.querySelectorAll('.summary-item');\n    items.forEach((item) => {\n      const label = item.querySelector('span:first-child')?.textContent?.replace(':', '').toLowerCase();\n      const countEl = item.querySelector('.count');\n      if (!countEl || !label) return;\n\n      if (label === 'requests') {\n        countEl.textContent = String(counts.requests);\n        item.classList.toggle('has-errors', counts.errors > 0);\n      } else if (label === 'sql') {\n        countEl.textContent = String(counts.sql);\n        item.classList.toggle('has-slow', counts.slowQueries > 0);\n      } else if (label === 'logs') {\n        countEl.textContent = String(counts.logs);\n      } else if (label === 'errors') {\n        countEl.textContent = String(counts.errors);\n      }\n    });\n  }\n\n  private updateConnectionStatus(): void {\n    // Update header indicator\n    const headerDot = this.shadow.querySelector('.connection-indicator .status-dot');\n    if (headerDot) {\n      headerDot.className = `status-dot ${this.connectionStatus}`;\n    }\n\n    // Update summary indicator (when not using FAB)\n    const summaryDot = this.shadow.querySelector('.connection-status .status-dot');\n    const summaryText = this.shadow.querySelector('.connection-status span:last-child');\n    if (summaryDot) {\n      summaryDot.className = `status-dot ${this.connectionStatus}`;\n    }\n    if (summaryText) {\n      summaryText.textContent = this.connectionStatus;\n    }\n  }\n\n  private getPanelCount(panel: string): number {\n    switch (panel) {\n      case 'requests':\n        return this.snapshot.requests?.length || 0;\n      case 'sql':\n        return this.snapshot.sql?.length || 0;\n      case 'logs':\n        return this.snapshot.logs?.length || 0;\n      case 'routes':\n        return this.snapshot.routes?.length || 0;\n      case 'template':\n        return Object.keys(this.snapshot.template || {}).length;\n      case 'session':\n        return Object.keys(this.snapshot.session || {}).length;\n      case 'config':\n        return Object.keys(this.snapshot.config || {}).length;\n      case 'custom':\n        const custom = this.snapshot.custom || {};\n        return Object.keys(custom.data || {}).length + (custom.logs?.length || 0);\n      default:\n        return 0;\n    }\n  }\n\n  private attachEventListeners(): void {\n    // Tab clicks\n    this.shadow.querySelectorAll('.tab').forEach((tab) => {\n      tab.addEventListener('click', (e) => {\n        const panel = (e.currentTarget as HTMLElement).dataset.panel;\n        if (panel && panel !== this.activePanel) {\n          this.activePanel = panel;\n          // Update active state\n          this.shadow.querySelectorAll('.tab').forEach((t) => t.classList.remove('active'));\n          (e.currentTarget as HTMLElement).classList.add('active');\n          // Render panel content\n          const container = this.shadow.getElementById('panel-content');\n          if (container) {\n            container.innerHTML = renderPanel(this.activePanel, this.snapshot, this.slowThresholdMs);\n          }\n        }\n      });\n    });\n\n    // Action buttons\n    this.shadow.querySelectorAll('[data-action]').forEach((btn) => {\n      btn.addEventListener('click', (e) => {\n        const action = (e.currentTarget as HTMLElement).dataset.action;\n        const activeStream = this.getStream();\n        switch (action) {\n          case 'toggle':\n            this.toggleExpanded();\n            break;\n          case 'collapse':\n            this.collapse();\n            break;\n          case 'refresh':\n            activeStream?.requestSnapshot();\n            break;\n          case 'clear':\n            activeStream?.clear();\n            this.snapshot = {};\n            this.updateContent();\n            break;\n        }\n      });\n    });\n\n    // Summary click to expand (when not using FAB)\n    if (!this.useFab) {\n      const summary = this.shadow.querySelector('.toolbar-summary');\n      if (summary) {\n        summary.addEventListener('click', () => {\n          if (!this.expanded) {\n            this.expanded = true;\n            this.saveState();\n            this.render();\n            this.dispatchExpandEvent();\n          }\n        });\n      }\n    }\n  }\n}\n\n// Register the custom element\nif (!customElements.get('debug-toolbar')) {\n  customElements.define('debug-toolbar', DebugToolbar);\n}\n","// Shadow DOM styles for the debug FAB (Floating Action Button)\n// Self-contained CSS that won't leak to or from the host page\n\nexport const fabStyles = `\n  :host {\n    --fab-bg: #1e1e2e;\n    --fab-bg-hover: #313244;\n    --fab-border: #45475a;\n    --fab-text: #cdd6f4;\n    --fab-text-muted: #6c7086;\n    --fab-accent: #89b4fa;\n    --fab-success: #a6e3a1;\n    --fab-warning: #f9e2af;\n    --fab-error: #f38ba8;\n    --fab-font: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, \"Liberation Mono\", \"Courier New\", monospace;\n\n    position: fixed;\n    bottom: 16px;\n    right: 16px;\n    z-index: 99998;\n    font-family: var(--fab-font);\n    font-size: 12px;\n    line-height: 1.4;\n    pointer-events: auto;\n  }\n\n  * {\n    box-sizing: border-box;\n    margin: 0;\n    padding: 0;\n  }\n\n  .fab {\n    position: relative;\n    display: flex;\n    align-items: center;\n    background: var(--fab-bg);\n    border: 1px solid var(--fab-border);\n    border-radius: 24px;\n    cursor: pointer;\n    transition: all 0.25s cubic-bezier(0.4, 0, 0.2, 1);\n    box-shadow: 0 4px 12px rgba(0, 0, 0, 0.3);\n    overflow: visible;\n    height: 48px;\n    min-width: 48px;\n  }\n\n  .fab:hover {\n    background: var(--fab-bg-hover);\n    box-shadow: 0 6px 16px rgba(0, 0, 0, 0.4);\n    transform: translateY(-2px);\n  }\n\n  .fab.hidden {\n    opacity: 0;\n    pointer-events: none;\n    transform: scale(0.8) translateY(20px);\n  }\n\n  /* Collapsed state - icon only */\n  .fab-collapsed {\n    display: flex;\n    align-items: center;\n    justify-content: center;\n    width: 48px;\n    height: 48px;\n    flex-shrink: 0;\n  }\n\n  .fab-icon {\n    width: 24px;\n    height: 24px;\n    color: var(--fab-accent);\n    display: flex;\n    align-items: center;\n    justify-content: center;\n  }\n\n  .fab-icon svg {\n    width: 100%;\n    height: 100%;\n  }\n\n  /* Connection status dot - positioned at bottom-right of icon area */\n  .fab-status-dot {\n    position: absolute;\n    bottom: 6px;\n    left: 34px;\n    width: 10px;\n    height: 10px;\n    border-radius: 50%;\n    border: 2px solid var(--fab-bg);\n    background: var(--fab-text-muted);\n    transition: background 0.2s, box-shadow 0.2s;\n    z-index: 1;\n  }\n\n  .fab[data-status=\"connected\"] .fab-status-dot {\n    background: var(--fab-success);\n    box-shadow: 0 0 6px var(--fab-success);\n  }\n\n  .fab[data-status=\"disconnected\"] .fab-status-dot {\n    background: var(--fab-text-muted);\n  }\n\n  .fab[data-status=\"reconnecting\"] .fab-status-dot {\n    background: var(--fab-warning);\n    animation: pulse 1s ease-in-out infinite;\n  }\n\n  .fab[data-status=\"error\"] .fab-status-dot {\n    background: var(--fab-error);\n    box-shadow: 0 0 6px var(--fab-error);\n  }\n\n  @keyframes pulse {\n    0%, 100% { opacity: 1; }\n    50% { opacity: 0.4; }\n  }\n\n  /* Expanded state - counters */\n  .fab-expanded {\n    display: flex;\n    align-items: center;\n    gap: 12px;\n    padding-right: 16px;\n    max-width: 0;\n    opacity: 0;\n    overflow: hidden;\n    transition: all 0.25s cubic-bezier(0.4, 0, 0.2, 1);\n  }\n\n  .fab:hover .fab-expanded,\n  .fab.is-hovered .fab-expanded {\n    max-width: 300px;\n    opacity: 1;\n    padding-left: 4px;\n  }\n\n  .fab-counter {\n    display: flex;\n    flex-direction: column;\n    align-items: center;\n    min-width: 36px;\n    padding: 4px 8px;\n    border-radius: 8px;\n    background: rgba(255, 255, 255, 0.05);\n    transition: background 0.15s;\n  }\n\n  .fab-counter.has-items {\n    background: rgba(137, 180, 250, 0.15);\n  }\n\n  .fab-counter.has-slow {\n    background: rgba(249, 226, 175, 0.15);\n  }\n\n  .fab-counter.has-errors {\n    background: rgba(243, 139, 168, 0.15);\n  }\n\n  .counter-value {\n    font-size: 14px;\n    font-weight: 600;\n    color: var(--fab-text);\n    font-variant-numeric: tabular-nums;\n  }\n\n  .fab-counter.has-items .counter-value {\n    color: var(--fab-accent);\n  }\n\n  .fab-counter.has-slow .counter-value {\n    color: var(--fab-warning);\n  }\n\n  .fab-counter.has-errors .counter-value {\n    color: var(--fab-error);\n  }\n\n  .counter-label {\n    font-size: 9px;\n    color: var(--fab-text-muted);\n    text-transform: uppercase;\n    letter-spacing: 0.05em;\n  }\n\n  /* Responsive */\n  @media (max-width: 480px) {\n    :host {\n      bottom: 12px;\n      right: 12px;\n    }\n\n    .fab {\n      height: 44px;\n      min-width: 44px;\n    }\n\n    .fab-collapsed {\n      width: 44px;\n      height: 44px;\n    }\n\n    .fab-icon {\n      width: 20px;\n      height: 20px;\n    }\n\n    .fab-status-dot {\n      width: 8px;\n      height: 8px;\n      bottom: 5px;\n      left: 32px;\n    }\n\n    .fab-counter {\n      min-width: 32px;\n      padding: 3px 6px;\n    }\n\n    .counter-value {\n      font-size: 12px;\n    }\n\n    .counter-label {\n      font-size: 8px;\n    }\n  }\n`;\n","// Debug FAB (Floating Action Button) Component\n// A minimized debug indicator that expands on hover and opens the toolbar on click\n\nimport { DebugStream, type DebugEvent, type DebugStreamStatus } from '../debug-stream.js';\nimport { getCounts, type DebugSnapshot } from './panel-renderers.js';\nimport { fabStyles } from './fab-styles.js';\n\n// Panel configuration for events\nconst panelEventMap: Record<string, string> = {\n  template: 'template',\n  session: 'session',\n  requests: 'request',\n  sql: 'sql',\n  logs: 'log',\n  custom: 'custom',\n};\n\nconst eventToPanel: Record<string, string> = {\n  request: 'requests',\n  sql: 'sql',\n  log: 'logs',\n  template: 'template',\n  session: 'session',\n  custom: 'custom',\n};\n\nconst defaultPanels = ['requests', 'sql', 'logs', 'routes', 'config'];\n\nexport class DebugFab extends HTMLElement {\n  private shadow: ShadowRoot;\n  private stream: DebugStream | null = null;\n  private snapshot: DebugSnapshot = {};\n  private connectionStatus: DebugStreamStatus = 'disconnected';\n  private isHovered = false;\n  private toolbarExpanded = false;\n\n  static get observedAttributes(): string[] {\n    return ['debug-path', 'panels', 'toolbar-expanded'];\n  }\n\n  constructor() {\n    super();\n    this.shadow = this.attachShadow({ mode: 'open' });\n  }\n\n  connectedCallback(): void {\n    this.render();\n    this.initWebSocket();\n    this.fetchInitialSnapshot();\n    this.loadState();\n  }\n\n  disconnectedCallback(): void {\n    this.stream?.close();\n  }\n\n  attributeChangedCallback(name: string, oldValue: string | null, newValue: string | null): void {\n    if (oldValue === newValue) return;\n\n    if (name === 'toolbar-expanded') {\n      this.toolbarExpanded = newValue === 'true' || newValue === '';\n      this.render();\n    }\n  }\n\n  // Public API\n  public setToolbarExpanded(expanded: boolean): void {\n    this.toolbarExpanded = expanded;\n    this.saveState();\n    this.render();\n  }\n\n  public getSnapshot(): DebugSnapshot {\n    return this.snapshot;\n  }\n\n  public getConnectionStatus(): DebugStreamStatus {\n    return this.connectionStatus;\n  }\n\n  public getStream(): DebugStream | null {\n    return this.stream;\n  }\n\n  // Attribute getters\n  private get debugPath(): string {\n    return this.getAttribute('debug-path') || '/admin/debug';\n  }\n\n  private get panels(): string[] {\n    const attr = this.getAttribute('panels');\n    if (attr) {\n      const parsed = attr\n        .split(',')\n        .map((p) => p.trim().toLowerCase())\n        .filter(Boolean);\n      return parsed.length ? parsed : defaultPanels;\n    }\n    return defaultPanels;\n  }\n\n  // State persistence\n  private loadState(): void {\n    try {\n      const stored = localStorage.getItem('debug-toolbar-expanded');\n      if (stored !== null) {\n        this.toolbarExpanded = stored === 'true';\n        this.render();\n      }\n    } catch {\n      // Ignore localStorage errors\n    }\n  }\n\n  private saveState(): void {\n    try {\n      localStorage.setItem('debug-toolbar-expanded', String(this.toolbarExpanded));\n    } catch {\n      // Ignore localStorage errors\n    }\n  }\n\n  // WebSocket initialization\n  private initWebSocket(): void {\n    this.stream = new DebugStream({\n      basePath: this.debugPath,\n      onEvent: (event) => this.handleEvent(event),\n      onStatusChange: (status) => this.handleStatusChange(status),\n    });\n\n    this.stream.connect();\n    this.stream.subscribe(this.panels.map((panel) => panelEventMap[panel] || panel));\n  }\n\n  // Fetch initial snapshot via HTTP\n  private async fetchInitialSnapshot(): Promise<void> {\n    try {\n      const response = await fetch(`${this.debugPath}/api/snapshot`, {\n        credentials: 'same-origin',\n      });\n      if (response.ok) {\n        const data = await response.json();\n        this.applySnapshot(data);\n      }\n    } catch {\n      // Ignore fetch errors - WebSocket will provide data\n    }\n  }\n\n  // Event handlers\n  private handleEvent(event: DebugEvent): void {\n    if (!event || !event.type) return;\n\n    if (event.type === 'snapshot') {\n      this.applySnapshot(event.payload as DebugSnapshot);\n      return;\n    }\n\n    // Apply incremental updates\n    switch (event.type) {\n      case 'request':\n        this.snapshot.requests = this.snapshot.requests || [];\n        this.snapshot.requests.push(event.payload);\n        this.trimArray(this.snapshot.requests, 500);\n        break;\n      case 'sql':\n        this.snapshot.sql = this.snapshot.sql || [];\n        this.snapshot.sql.push(event.payload);\n        this.trimArray(this.snapshot.sql, 200);\n        break;\n      case 'log':\n        this.snapshot.logs = this.snapshot.logs || [];\n        this.snapshot.logs.push(event.payload);\n        this.trimArray(this.snapshot.logs, 500);\n        break;\n      case 'template':\n        this.snapshot.template = event.payload || {};\n        break;\n      case 'session':\n        this.snapshot.session = event.payload || {};\n        break;\n      case 'custom':\n        this.handleCustomEvent(event.payload);\n        break;\n    }\n\n    this.updateCounters();\n  }\n\n  private handleCustomEvent(payload: unknown): void {\n    if (!payload || typeof payload !== 'object') return;\n    this.snapshot.custom = this.snapshot.custom || { data: {}, logs: [] };\n\n    const p = payload as Record<string, unknown>;\n    if ('key' in p && 'value' in p) {\n      this.snapshot.custom.data = this.snapshot.custom.data || {};\n      this.snapshot.custom.data[String(p.key)] = p.value;\n    } else if ('category' in p || 'message' in p) {\n      this.snapshot.custom.logs = this.snapshot.custom.logs || [];\n      this.snapshot.custom.logs.push(payload as { category?: string; message?: string });\n      this.trimArray(this.snapshot.custom.logs, 500);\n    }\n  }\n\n  private handleStatusChange(status: DebugStreamStatus): void {\n    this.connectionStatus = status;\n    this.updateConnectionStatus();\n    // Dispatch event for toolbar to listen\n    this.dispatchEvent(new CustomEvent('debug-status-change', {\n      detail: { status },\n      bubbles: true,\n      composed: true,\n    }));\n  }\n\n  private applySnapshot(data: DebugSnapshot): void {\n    this.snapshot = data || {};\n    this.updateCounters();\n    // Dispatch event for toolbar to listen\n    this.dispatchEvent(new CustomEvent('debug-snapshot', {\n      detail: { snapshot: this.snapshot },\n      bubbles: true,\n      composed: true,\n    }));\n  }\n\n  private trimArray<T>(arr: T[], max: number): void {\n    while (arr.length > max) {\n      arr.shift();\n    }\n  }\n\n  // Rendering\n  private render(): void {\n    const counts = getCounts(this.snapshot);\n    const hasErrors = counts.errors > 0;\n    const hasSlowQueries = counts.slowQueries > 0;\n\n    // Hide FAB when toolbar is expanded\n    const hiddenClass = this.toolbarExpanded ? 'hidden' : '';\n\n    this.shadow.innerHTML = `\n      <style>${fabStyles}</style>\n      <div class=\"fab ${hiddenClass}\" data-status=\"${this.connectionStatus}\">\n        <span class=\"fab-status-dot\"></span>\n        <div class=\"fab-collapsed\">\n          <span class=\"fab-icon\">\n            <svg viewBox=\"0 0 24 24\" stroke-width=\"1.5\" fill=\"none\" xmlns=\"http://www.w3.org/2000/svg\">\n              <path fill-rule=\"evenodd\" clip-rule=\"evenodd\" d=\"M12 2.25C15.4148 2.25 18.157 4.93659 19.2445 8.53907L20.6646 7.82902C21.0351 7.64377 21.4856 7.79394 21.6709 8.16443C21.8561 8.53491 21.7059 8.98541 21.3355 9.17066L19.5919 10.0425C19.6958 10.6789 19.75 11.3341 19.75 12C19.75 12.4216 19.7283 12.839 19.6859 13.25H22C22.4142 13.25 22.75 13.5858 22.75 14C22.75 14.4142 22.4142 14.75 22 14.75H19.4347C19.2438 15.5659 18.9699 16.3431 18.6235 17.0629L20.5303 18.9697C20.8232 19.2626 20.8232 19.7374 20.5303 20.0303C20.2374 20.3232 19.7626 20.3232 19.4697 20.0303L17.8463 18.4069C16.4519 20.4331 14.3908 21.75 12 21.75C9.60921 21.75 7.54809 20.4331 6.15371 18.4069L4.53033 20.0303C4.23744 20.3232 3.76256 20.3232 3.46967 20.0303C3.17678 19.7374 3.17678 19.2626 3.46967 18.9697L5.37647 17.0629C5.03008 16.3431 4.7562 15.5659 4.56527 14.75H2C1.58579 14.75 1.25 14.4142 1.25 14C1.25 13.5858 1.58579 13.25 2 13.25H4.31407C4.27174 12.839 4.25 12.4216 4.25 12C4.25 11.3341 4.30423 10.6789 4.40814 10.0425L2.66455 9.17066C2.29406 8.98541 2.1439 8.53491 2.32914 8.16443C2.51438 7.79394 2.96488 7.64377 3.33537 7.82902L4.75547 8.53907C5.84297 4.93659 8.58522 2.25 12 2.25ZM11.25 19C11.25 19.4142 11.5858 19.75 12 19.75C12.4142 19.75 12.75 19.4142 12.75 19V9.73117C14.005 9.6696 15.2088 9.46632 16.1588 9.26042C16.5636 9.17268 16.8207 8.77339 16.7329 8.36857C16.6452 7.96376 16.2459 7.70672 15.8411 7.79445C14.7597 8.02883 13.3718 8.25 12 8.25C10.6281 8.25 9.24022 8.02883 8.15882 7.79445C7.75401 7.70672 7.35472 7.96376 7.26698 8.36857C7.17924 8.77339 7.43629 9.17268 7.8411 9.26042C8.79115 9.46632 9.99494 9.6696 11.25 9.73117V19Z\" fill=\"currentColor\"></path>\n            </svg>\n          </span>\n        </div>\n        <div class=\"fab-expanded\">\n          <div class=\"fab-counter ${counts.requests > 0 ? 'has-items' : ''}\">\n            <span class=\"counter-value\">${counts.requests}</span>\n            <span class=\"counter-label\">Req</span>\n          </div>\n          <div class=\"fab-counter ${counts.sql > 0 ? 'has-items' : ''} ${hasSlowQueries ? 'has-slow' : ''}\">\n            <span class=\"counter-value\">${counts.sql}</span>\n            <span class=\"counter-label\">SQL</span>\n          </div>\n          <div class=\"fab-counter ${counts.logs > 0 ? 'has-items' : ''} ${hasErrors ? 'has-errors' : ''}\">\n            <span class=\"counter-value\">${counts.logs}</span>\n            <span class=\"counter-label\">Logs</span>\n          </div>\n          ${hasErrors ? `\n            <div class=\"fab-counter has-errors\">\n              <span class=\"counter-value\">${counts.errors}</span>\n              <span class=\"counter-label\">Err</span>\n            </div>\n          ` : ''}\n        </div>\n      </div>\n    `;\n\n    this.attachEventListeners();\n  }\n\n  private updateCounters(): void {\n    const counts = getCounts(this.snapshot);\n    const hasErrors = counts.errors > 0;\n    const hasSlowQueries = counts.slowQueries > 0;\n\n    // Update request counter\n    const reqCounter = this.shadow.querySelector('.fab-counter:nth-child(1)');\n    if (reqCounter) {\n      const reqValue = reqCounter.querySelector('.counter-value');\n      if (reqValue) reqValue.textContent = String(counts.requests);\n      reqCounter.classList.toggle('has-items', counts.requests > 0);\n    }\n\n    // Update SQL counter\n    const sqlCounter = this.shadow.querySelector('.fab-counter:nth-child(2)');\n    if (sqlCounter) {\n      const sqlValue = sqlCounter.querySelector('.counter-value');\n      if (sqlValue) sqlValue.textContent = String(counts.sql);\n      sqlCounter.classList.toggle('has-items', counts.sql > 0);\n      sqlCounter.classList.toggle('has-slow', hasSlowQueries);\n    }\n\n    // Update logs counter\n    const logsCounter = this.shadow.querySelector('.fab-counter:nth-child(3)');\n    if (logsCounter) {\n      const logsValue = logsCounter.querySelector('.counter-value');\n      if (logsValue) logsValue.textContent = String(counts.logs);\n      logsCounter.classList.toggle('has-items', counts.logs > 0);\n      logsCounter.classList.toggle('has-errors', hasErrors);\n    }\n\n    // Update or add error counter\n    const errorCounter = this.shadow.querySelector('.fab-counter:nth-child(4)');\n    if (hasErrors) {\n      if (errorCounter) {\n        const errValue = errorCounter.querySelector('.counter-value');\n        if (errValue) errValue.textContent = String(counts.errors);\n      }\n    }\n  }\n\n  private updateConnectionStatus(): void {\n    const fab = this.shadow.querySelector('.fab');\n    if (fab) {\n      fab.setAttribute('data-status', this.connectionStatus);\n    }\n  }\n\n  private attachEventListeners(): void {\n    const fab = this.shadow.querySelector('.fab');\n    if (!fab) return;\n\n    // Click to expand toolbar\n    fab.addEventListener('click', () => {\n      this.toolbarExpanded = true;\n      this.saveState();\n      this.render();\n      this.dispatchEvent(new CustomEvent('debug-expand', {\n        detail: { expanded: true },\n        bubbles: true,\n        composed: true,\n      }));\n    });\n\n    // Hover state (for CSS transitions)\n    fab.addEventListener('mouseenter', () => {\n      this.isHovered = true;\n      fab.classList.add('is-hovered');\n    });\n\n    fab.addEventListener('mouseleave', () => {\n      this.isHovered = false;\n      fab.classList.remove('is-hovered');\n    });\n  }\n}\n\n// Register the custom element\nif (!customElements.get('debug-fab')) {\n  customElements.define('debug-fab', DebugFab);\n}\n","// Debug Manager\n// Coordinates the FAB and Toolbar components, sharing WebSocket connection and state\n\nimport { DebugFab } from './debug-fab.js';\nimport { DebugToolbar } from './debug-toolbar.js';\nimport type { DebugSnapshot } from './panel-renderers.js';\n\nexport interface DebugManagerOptions {\n  debugPath?: string;\n  panels?: string[];\n  slowThresholdMs?: number;\n  container?: HTMLElement;\n}\n\nexport class DebugManager {\n  private fab: DebugFab | null = null;\n  private toolbar: DebugToolbar | null = null;\n  private options: DebugManagerOptions;\n  private initialized = false;\n\n  constructor(options: DebugManagerOptions = {}) {\n    this.options = {\n      debugPath: '/admin/debug',\n      panels: ['requests', 'sql', 'logs', 'routes', 'config'],\n      slowThresholdMs: 50,\n      container: document.body,\n      ...options,\n    };\n  }\n\n  /**\n   * Initialize the debug UI with FAB and Toolbar\n   */\n  public init(): void {\n    if (this.initialized) return;\n    this.initialized = true;\n\n    this.createFab();\n    this.createToolbar();\n    this.wireEvents();\n  }\n\n  /**\n   * Destroy the debug UI\n   */\n  public destroy(): void {\n    if (this.fab) {\n      this.fab.remove();\n      this.fab = null;\n    }\n    if (this.toolbar) {\n      this.toolbar.remove();\n      this.toolbar = null;\n    }\n    this.initialized = false;\n  }\n\n  /**\n   * Expand the toolbar programmatically\n   */\n  public expand(): void {\n    if (!this.toolbar || !this.fab) return;\n    this.fab.setToolbarExpanded(true);\n    this.toolbar.setExpanded(true);\n  }\n\n  /**\n   * Collapse the toolbar programmatically\n   */\n  public collapse(): void {\n    if (!this.toolbar || !this.fab) return;\n    this.fab.setToolbarExpanded(false);\n    this.toolbar.setExpanded(false);\n  }\n\n  /**\n   * Toggle the toolbar state\n   */\n  public toggle(): void {\n    if (!this.toolbar) return;\n    if (this.toolbar.isExpanded()) {\n      this.collapse();\n    } else {\n      this.expand();\n    }\n  }\n\n  private createFab(): void {\n    this.fab = document.createElement('debug-fab') as DebugFab;\n    this.fab.setAttribute('debug-path', this.options.debugPath || '/admin/debug');\n    if (this.options.panels) {\n      this.fab.setAttribute('panels', this.options.panels.join(','));\n    }\n    this.options.container?.appendChild(this.fab);\n  }\n\n  private createToolbar(): void {\n    this.toolbar = document.createElement('debug-toolbar') as DebugToolbar;\n    this.toolbar.setAttribute('debug-path', this.options.debugPath || '/admin/debug');\n    this.toolbar.setAttribute('use-fab', 'true');\n    if (this.options.panels) {\n      this.toolbar.setAttribute('panels', this.options.panels.join(','));\n    }\n    if (this.options.slowThresholdMs) {\n      this.toolbar.setAttribute('slow-threshold-ms', String(this.options.slowThresholdMs));\n    }\n    this.options.container?.appendChild(this.toolbar);\n  }\n\n  private wireEvents(): void {\n    if (!this.fab || !this.toolbar) return;\n\n    // FAB dispatches expand event when clicked\n    this.fab.addEventListener('debug-expand', ((e: CustomEvent) => {\n      if (e.detail?.expanded && this.toolbar) {\n        // Share the FAB's stream with the toolbar\n        const stream = this.fab?.getStream();\n        if (stream) {\n          this.toolbar.setStream(stream);\n        }\n        // Share the snapshot\n        const snapshot = this.fab?.getSnapshot();\n        if (snapshot) {\n          this.toolbar.setSnapshot(snapshot);\n        }\n        // Share the connection status\n        const status = this.fab?.getConnectionStatus();\n        if (status) {\n          this.toolbar.setConnectionStatus(status);\n        }\n        this.toolbar.setExpanded(true);\n      }\n    }) as EventListener);\n\n    // FAB dispatches status changes\n    this.fab.addEventListener('debug-status-change', ((e: CustomEvent) => {\n      if (this.toolbar && e.detail?.status) {\n        this.toolbar.setConnectionStatus(e.detail.status);\n      }\n    }) as EventListener);\n\n    // FAB dispatches snapshot updates\n    this.fab.addEventListener('debug-snapshot', ((e: CustomEvent) => {\n      if (this.toolbar && e.detail?.snapshot) {\n        this.toolbar.setSnapshot(e.detail.snapshot);\n      }\n    }) as EventListener);\n\n    // Toolbar dispatches collapse event\n    this.toolbar.addEventListener('debug-expand', ((e: CustomEvent) => {\n      if (!e.detail?.expanded && this.fab) {\n        this.fab.setToolbarExpanded(false);\n      }\n    }) as EventListener);\n  }\n}\n\n/**\n * Initialize debug UI from window config or data attributes\n */\nexport function initDebugManager(): DebugManager | null {\n  // Check for window config\n  const windowConfig = (window as any).DEBUG_CONFIG;\n\n  // Check for existing debug element with config\n  const existingElement = document.querySelector('[data-debug-path]');\n\n  let options: DebugManagerOptions = {};\n\n  if (windowConfig) {\n    options = {\n      debugPath: windowConfig.debugPath || windowConfig.basePath,\n      panels: windowConfig.panels,\n      slowThresholdMs: windowConfig.slowThresholdMs,\n    };\n  } else if (existingElement) {\n    options = {\n      debugPath: existingElement.getAttribute('data-debug-path') || undefined,\n      panels: existingElement.getAttribute('data-panels')?.split(','),\n      slowThresholdMs: parseInt(existingElement.getAttribute('data-slow-threshold-ms') || '50', 10),\n    };\n  }\n\n  // Only initialize if we have a debug path configured\n  if (!options.debugPath && !windowConfig && !existingElement) {\n    return null;\n  }\n\n  const manager = new DebugManager(options);\n  manager.init();\n  return manager;\n}\n\n// Export for global access\n(window as any).DebugManager = DebugManager;\n(window as any).initDebugManager = initDebugManager;\n"],"names":["toolbarStyles","escapeHTML","value","formatTimestamp","date","formatDuration","slowThresholdMs","nanos","ms","isSlow","formatJSON","truncate","str","len","getStatusClass","status","getLevelClass","level","l","renderPanel","panel","snapshot","renderRequests","renderSQL","renderLogs","renderJSON","renderRoutes","renderCustom","requests","req","methodClass","statusClass","duration","queries","q","rowClasses","logs","log","routes","r","title","data","custom","content","logRows","getCounts","sql","requestErrors","sqlErrors","logErrors","slowQueries","defaultPanels","panelLabels","panelEventMap","eventToPanel","DebugToolbar","e","name","oldValue","newValue","expanded","stream","stored","attr","parsed","p","DebugStream","event","response","payload","arr","max","counts","panelTabs","label","count","expandedClass","hiddenClass","container","tab","summary","item","countEl","headerDot","summaryDot","summaryText","t","btn","action","activeStream","fabStyles","DebugFab","hasErrors","hasSlowQueries","reqCounter","reqValue","sqlCounter","sqlValue","logsCounter","logsValue","errorCounter","errValue","fab","DebugManager","options","initDebugManager","windowConfig","existingElement","manager"],"mappings":";AAGO,MAAMA,IAAgB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,GCgEvBC,IAAa,CAACC,MAC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"}