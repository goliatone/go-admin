{"version":3,"file":"toolbar.js","sources":["../../src/debug/toolbar/toolbar-styles.ts","../../src/debug/toolbar/panel-renderers.ts","../../src/debug/toolbar/debug-toolbar.ts","../../src/debug/toolbar/fab-styles.ts","../../src/debug/toolbar/debug-fab.ts","../../src/debug/toolbar/debug-manager.ts"],"sourcesContent":["// Shadow DOM styles for the debug toolbar\n// Self-contained CSS that won't leak to or from the host page\n\nexport const toolbarStyles = `\n  :host {\n    --toolbar-bg: #1e1e2e;\n    --toolbar-bg-secondary: #181825;\n    --toolbar-border: #313244;\n    --toolbar-text: #cdd6f4;\n    --toolbar-text-muted: #6c7086;\n    --toolbar-accent: #89b4fa;\n    --toolbar-accent-hover: #b4befe;\n    --toolbar-success: #a6e3a1;\n    --toolbar-warning: #f9e2af;\n    --toolbar-error: #f38ba8;\n    --toolbar-info: #89dceb;\n    --toolbar-height-collapsed: 36px;\n    --toolbar-height-expanded: 320px;\n    --toolbar-font: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, \"Liberation Mono\", \"Courier New\", monospace;\n\n    position: fixed;\n    bottom: 0;\n    left: 0;\n    right: 0;\n    z-index: 99999;\n    font-family: var(--toolbar-font);\n    font-size: 12px;\n    line-height: 1.4;\n    pointer-events: auto;\n  }\n\n  * {\n    box-sizing: border-box;\n    margin: 0;\n    padding: 0;\n  }\n\n  .toolbar {\n    background: var(--toolbar-bg);\n    border-top: 1px solid var(--toolbar-border);\n    color: var(--toolbar-text);\n    transition: transform 0.3s cubic-bezier(0.4, 0, 0.2, 1), opacity 0.2s ease;\n    display: flex;\n    flex-direction: column;\n  }\n\n  .toolbar:not(.resizing) {\n    transition: height 0.2s ease-out, transform 0.3s cubic-bezier(0.4, 0, 0.2, 1), opacity 0.2s ease;\n  }\n\n  /* Resize handle */\n  .resize-handle {\n    position: absolute;\n    top: -4px;\n    left: 0;\n    right: 0;\n    height: 8px;\n    cursor: ns-resize;\n    z-index: 10;\n    background: transparent;\n  }\n\n  .resize-handle::before {\n    content: '';\n    position: absolute;\n    top: 50%;\n    left: 50%;\n    transform: translate(-50%, -50%);\n    width: 40px;\n    height: 4px;\n    background: var(--toolbar-border);\n    border-radius: 2px;\n    opacity: 0;\n    transition: opacity 0.15s ease;\n  }\n\n  .resize-handle:hover::before,\n  .toolbar.resizing .resize-handle::before {\n    opacity: 1;\n  }\n\n  .toolbar.resizing .resize-handle::before {\n    background: var(--toolbar-accent);\n  }\n\n  .toolbar.collapsed {\n    height: var(--toolbar-height-collapsed);\n  }\n\n  .toolbar.expanded {\n    height: var(--toolbar-height-expanded);\n  }\n\n  .toolbar.hidden {\n    transform: translateY(100%);\n    opacity: 0;\n    pointer-events: none;\n  }\n\n  /* Header with tabs */\n  .toolbar-header {\n    display: flex;\n    justify-content: space-between;\n    align-items: center;\n    padding: 0 12px;\n    height: 36px;\n    min-height: 36px;\n    border-bottom: 1px solid var(--toolbar-border);\n    background: var(--toolbar-bg-secondary);\n  }\n\n  .toolbar-tabs {\n    display: flex;\n    gap: 2px;\n    overflow-x: auto;\n    scrollbar-width: none;\n  }\n\n  .toolbar-tabs::-webkit-scrollbar {\n    display: none;\n  }\n\n  .tab {\n    background: transparent;\n    border: none;\n    color: var(--toolbar-text-muted);\n    padding: 6px 10px;\n    cursor: pointer;\n    border-radius: 4px;\n    font-size: 11px;\n    font-family: inherit;\n    white-space: nowrap;\n    transition: all 0.15s ease;\n    display: flex;\n    align-items: center;\n    gap: 6px;\n  }\n\n  .tab:hover {\n    background: rgba(137, 180, 250, 0.1);\n    color: var(--toolbar-text);\n  }\n\n  .tab.active {\n    background: var(--toolbar-accent);\n    color: var(--toolbar-bg);\n  }\n\n  .tab-count {\n    font-size: 10px;\n    background: rgba(255, 255, 255, 0.15);\n    padding: 1px 5px;\n    border-radius: 8px;\n    min-width: 18px;\n    text-align: center;\n  }\n\n  .tab.active .tab-count {\n    background: rgba(0, 0, 0, 0.2);\n  }\n\n  /* Actions */\n  .toolbar-actions {\n    display: flex;\n    gap: 4px;\n    align-items: center;\n  }\n\n  .connection-indicator {\n    display: flex;\n    align-items: center;\n    padding: 0 8px;\n  }\n\n  .connection-indicator .status-dot {\n    width: 8px;\n    height: 8px;\n  }\n\n  .action-btn {\n    background: transparent;\n    border: none;\n    color: var(--toolbar-text-muted);\n    cursor: pointer;\n    padding: 6px 8px;\n    font-size: 14px;\n    font-family: inherit;\n    border-radius: 4px;\n    transition: all 0.15s ease;\n    display: flex;\n    align-items: center;\n    justify-content: center;\n  }\n\n  .action-btn:hover {\n    background: rgba(137, 180, 250, 0.1);\n    color: var(--toolbar-text);\n  }\n\n  .action-btn.toggle-btn {\n    font-size: 12px;\n    padding: 6px 10px;\n  }\n\n  .action-btn.collapse-btn:hover {\n    background: rgba(243, 139, 168, 0.2);\n    color: var(--toolbar-error);\n  }\n\n  .expand-link {\n    color: var(--toolbar-text-muted);\n    text-decoration: none;\n    padding: 6px 8px;\n    font-size: 14px;\n    border-radius: 4px;\n    transition: all 0.15s ease;\n    display: flex;\n    align-items: center;\n    justify-content: center;\n  }\n\n  .expand-link:hover {\n    background: rgba(137, 180, 250, 0.1);\n    color: var(--toolbar-text);\n  }\n\n  /* Content area */\n  .toolbar-content {\n    flex: 1;\n    overflow: hidden;\n    display: flex;\n    flex-direction: column;\n  }\n\n  .panel-container {\n    flex: 1;\n    overflow: auto;\n    padding: 0 12px 8px 12px;\n    scrollbar-width: thin;\n    scrollbar-color: var(--toolbar-border) transparent;\n  }\n\n  .panel-container::-webkit-scrollbar {\n    width: 6px;\n  }\n\n  .panel-container::-webkit-scrollbar-track {\n    background: transparent;\n  }\n\n  .panel-container::-webkit-scrollbar-thumb {\n    background: var(--toolbar-border);\n    border-radius: 3px;\n  }\n\n  /* Summary bar (shown when collapsed) */\n  .toolbar-summary {\n    display: flex;\n    gap: 16px;\n    padding: 0 12px;\n    height: 36px;\n    align-items: center;\n    cursor: pointer;\n    background: var(--toolbar-bg);\n    transition: background 0.15s ease;\n  }\n\n  .toolbar-summary:hover {\n    background: var(--toolbar-bg-secondary);\n  }\n\n  .toolbar.expanded .toolbar-summary {\n    display: none;\n  }\n\n  .summary-item {\n    display: flex;\n    align-items: center;\n    gap: 6px;\n    color: var(--toolbar-text-muted);\n    font-size: 11px;\n  }\n\n  .summary-item .count {\n    color: var(--toolbar-text);\n    font-weight: 600;\n  }\n\n  .summary-item.has-errors .count {\n    color: var(--toolbar-error);\n  }\n\n  .summary-item.has-slow .count {\n    color: var(--toolbar-warning);\n  }\n\n  .connection-status {\n    display: flex;\n    align-items: center;\n    gap: 6px;\n    margin-left: auto;\n  }\n\n  .status-dot {\n    width: 6px;\n    height: 6px;\n    border-radius: 50%;\n    background: var(--toolbar-text-muted);\n  }\n\n  .status-dot.connected {\n    background: var(--toolbar-success);\n    box-shadow: 0 0 4px var(--toolbar-success);\n  }\n\n  .status-dot.error {\n    background: var(--toolbar-error);\n    box-shadow: 0 0 4px var(--toolbar-error);\n  }\n\n  .status-dot.reconnecting {\n    background: var(--toolbar-warning);\n    animation: pulse 1s ease-in-out infinite;\n  }\n\n  @keyframes pulse {\n    0%, 100% { opacity: 1; }\n    50% { opacity: 0.4; }\n  }\n\n  /* Table styles */\n  table {\n    width: 100%;\n    border-collapse: collapse;\n    font-size: 11px;\n  }\n\n  th, td {\n    text-align: left;\n    padding: 6px 8px;\n    border-bottom: 1px solid var(--toolbar-border);\n    vertical-align: top;\n  }\n\n  th {\n    color: var(--toolbar-text-muted);\n    font-weight: 500;\n    font-size: 10px;\n    text-transform: uppercase;\n    letter-spacing: 0.05em;\n    position: sticky;\n    top: 0;\n    background: var(--toolbar-bg);\n    z-index: 1;\n  }\n\n  tr:hover td {\n    background: rgba(137, 180, 250, 0.05);\n  }\n\n  /* Badges */\n  .badge {\n    display: inline-block;\n    padding: 2px 6px;\n    border-radius: 4px;\n    font-size: 10px;\n    font-weight: 600;\n    text-transform: uppercase;\n    letter-spacing: 0.03em;\n  }\n\n  .badge-method {\n    background: rgba(137, 180, 250, 0.2);\n    color: var(--toolbar-accent);\n  }\n\n  .badge-method.get { background: rgba(166, 227, 161, 0.2); color: var(--toolbar-success); }\n  .badge-method.post { background: rgba(137, 180, 250, 0.2); color: var(--toolbar-accent); }\n  .badge-method.put { background: rgba(249, 226, 175, 0.2); color: var(--toolbar-warning); }\n  .badge-method.patch { background: rgba(249, 226, 175, 0.2); color: var(--toolbar-warning); }\n  .badge-method.delete { background: rgba(243, 139, 168, 0.2); color: var(--toolbar-error); }\n\n  .badge-status {\n    background: rgba(166, 227, 161, 0.2);\n    color: var(--toolbar-success);\n  }\n\n  .badge-status.error {\n    background: rgba(243, 139, 168, 0.2);\n    color: var(--toolbar-error);\n  }\n\n  .badge-status.warn {\n    background: rgba(249, 226, 175, 0.2);\n    color: var(--toolbar-warning);\n  }\n\n  .badge-level {\n    min-width: 40px;\n    text-align: center;\n  }\n\n  .badge-level.debug { background: rgba(108, 112, 134, 0.3); color: var(--toolbar-text-muted); }\n  .badge-level.info { background: rgba(137, 220, 235, 0.2); color: var(--toolbar-info); }\n  .badge-level.warn { background: rgba(249, 226, 175, 0.2); color: var(--toolbar-warning); }\n  .badge-level.error { background: rgba(243, 139, 168, 0.2); color: var(--toolbar-error); }\n\n  /* Query highlighting */\n  .slow-query {\n    color: var(--toolbar-warning);\n  }\n\n  .error-query {\n    color: var(--toolbar-error);\n  }\n\n  /* Code/pre */\n  pre, code {\n    font-family: var(--toolbar-font);\n    font-size: 11px;\n  }\n\n  pre {\n    margin: 0;\n    white-space: pre-wrap;\n    word-break: break-word;\n    color: var(--toolbar-text);\n  }\n\n  .query-text {\n    max-width: 400px;\n    overflow: hidden;\n    text-overflow: ellipsis;\n    white-space: nowrap;\n  }\n\n  /* Empty state */\n  .empty-state {\n    color: var(--toolbar-text-muted);\n    text-align: center;\n    padding: 24px;\n    padding-top: 32px;\n    font-size: 12px;\n  }\n\n  /* JSON viewer */\n  .json-viewer {\n    background: var(--toolbar-bg-secondary);\n    border-radius: 4px;\n    padding: 8px;\n    margin-top: 8px;\n    overflow: auto;\n    max-height: 100%;\n    position: relative;\n  }\n\n  .json-viewer pre {\n    font-size: 11px;\n    line-height: 1.5;\n  }\n\n  .json-viewer__header {\n    display: flex;\n    justify-content: space-between;\n    align-items: center;\n    margin-bottom: 8px;\n    padding-bottom: 6px;\n    border-bottom: 1px solid var(--toolbar-border);\n  }\n\n  .json-viewer__title {\n    font-size: 10px;\n    font-weight: 600;\n    text-transform: uppercase;\n    letter-spacing: 0.05em;\n    color: var(--toolbar-text-muted);\n  }\n\n  /* Copy button */\n  .copy-btn {\n    display: inline-flex;\n    align-items: center;\n    gap: 4px;\n    background: transparent;\n    border: 1px solid var(--toolbar-border);\n    color: var(--toolbar-text-muted);\n    padding: 3px 8px;\n    font-size: 10px;\n    font-family: inherit;\n    border-radius: 4px;\n    cursor: pointer;\n    transition: all 0.15s ease;\n  }\n\n  .copy-btn:hover {\n    background: rgba(137, 180, 250, 0.1);\n    border-color: var(--toolbar-accent);\n    color: var(--toolbar-text);\n  }\n\n  .copy-btn.copied {\n    background: rgba(166, 227, 161, 0.15);\n    border-color: var(--toolbar-success);\n    color: var(--toolbar-success);\n  }\n\n  .copy-btn svg {\n    width: 12px;\n    height: 12px;\n  }\n\n  /* SQL selection */\n  .sql-select {\n    width: 28px;\n    text-align: center;\n    padding-left: 6px !important;\n    padding-right: 2px !important;\n  }\n\n  .sql-select input[type=\"checkbox\"] {\n    cursor: pointer;\n    appearance: none;\n    width: 14px;\n    height: 14px;\n    border: 1.5px solid var(--toolbar-text-muted);\n    border-radius: 3px;\n    background: transparent;\n    position: relative;\n    transition: all 0.15s ease;\n  }\n\n  .sql-select input[type=\"checkbox\"]:hover {\n    border-color: var(--toolbar-accent);\n  }\n\n  .sql-select input[type=\"checkbox\"]:checked {\n    background: var(--toolbar-accent);\n    border-color: var(--toolbar-accent);\n  }\n\n  .sql-select input[type=\"checkbox\"]:checked::after {\n    content: '';\n    position: absolute;\n    left: 4px;\n    top: 1px;\n    width: 4px;\n    height: 8px;\n    border: solid var(--toolbar-bg);\n    border-width: 0 2px 2px 0;\n    transform: rotate(45deg);\n  }\n\n  .sql-select input[type=\"checkbox\"]:indeterminate {\n    border-color: var(--toolbar-accent);\n  }\n\n  .sql-select input[type=\"checkbox\"]:indeterminate::after {\n    content: '';\n    position: absolute;\n    left: 2px;\n    top: 5px;\n    width: 8px;\n    height: 2px;\n    background: var(--toolbar-accent);\n  }\n\n  .sql-toolbar {\n    display: none;\n    align-items: center;\n    gap: 8px;\n    padding: 6px 10px;\n    background: rgba(137, 180, 250, 0.08);\n    border: 1px solid rgba(137, 180, 250, 0.2);\n    border-radius: 6px;\n    margin-bottom: 4px;\n    font-size: 11px;\n    color: var(--toolbar-text-muted);\n  }\n\n  .sql-toolbar[data-visible=\"true\"] {\n    display: flex;\n  }\n\n  .sql-toolbar span {\n    font-weight: 600;\n    color: var(--toolbar-accent);\n    margin-right: 4px;\n  }\n\n  .sql-toolbar button {\n    display: inline-flex;\n    align-items: center;\n    gap: 4px;\n    padding: 3px 8px;\n    border: 1px solid rgba(137, 180, 250, 0.3);\n    border-radius: 4px;\n    background: transparent;\n    color: var(--toolbar-text-muted);\n    font-size: 11px;\n    font-family: inherit;\n    cursor: pointer;\n    transition: all 0.15s ease;\n  }\n\n  .sql-toolbar button:hover {\n    background: rgba(137, 180, 250, 0.1);\n    border-color: var(--toolbar-accent);\n    color: var(--toolbar-text);\n  }\n\n  .sql-toolbar button svg {\n    width: 12px;\n    height: 12px;\n    flex-shrink: 0;\n  }\n\n  /* Duration formatting */\n  .duration {\n    color: var(--toolbar-text-muted);\n    font-variant-numeric: tabular-nums;\n  }\n\n  .duration.slow {\n    color: var(--toolbar-warning);\n    font-weight: 600;\n  }\n\n  /* Timestamp */\n  .timestamp {\n    color: var(--toolbar-text-muted);\n    font-variant-numeric: tabular-nums;\n    white-space: nowrap;\n  }\n\n  /* Path/URL */\n  .path {\n    color: var(--toolbar-text);\n    max-width: 300px;\n    overflow: hidden;\n    text-overflow: ellipsis;\n    white-space: nowrap;\n  }\n\n  /* Message */\n  .message {\n    color: var(--toolbar-text);\n    max-width: 400px;\n    overflow: hidden;\n    text-overflow: ellipsis;\n    white-space: nowrap;\n  }\n\n  .message:hover {\n    white-space: normal;\n    word-break: break-word;\n  }\n\n  /* Prism Catppuccin Mocha Theme */\n  .token.comment,\n  .token.prolog,\n  .token.doctype,\n  .token.cdata {\n    color: #6c7086;\n    font-style: italic;\n  }\n\n  .token.punctuation {\n    color: #9399b2;\n  }\n\n  .token.namespace {\n    opacity: 0.7;\n  }\n\n  .token.property,\n  .token.tag,\n  .token.boolean,\n  .token.number,\n  .token.constant,\n  .token.symbol {\n    color: #fab387;\n  }\n\n  .token.selector,\n  .token.attr-name,\n  .token.string,\n  .token.char,\n  .token.builtin {\n    color: #a6e3a1;\n  }\n\n  .token.operator,\n  .token.entity,\n  .token.url,\n  .language-css .token.string,\n  .style .token.string,\n  .token.variable {\n    color: #89dceb;\n  }\n\n  .token.atrule,\n  .token.attr-value,\n  .token.function {\n    color: #f9e2af;\n  }\n\n  .token.keyword {\n    color: #cba6f7;\n    font-weight: 600;\n  }\n\n  .token.regex,\n  .token.important {\n    color: #fab387;\n  }\n\n  .token.important,\n  .token.bold {\n    font-weight: bold;\n  }\n\n  .token.italic {\n    font-style: italic;\n  }\n\n  .token.entity {\n    cursor: help;\n  }\n\n  .token.deleted {\n    color: #f38ba8;\n  }\n\n  .token.inserted {\n    color: #a6e3a1;\n  }\n\n  /* Expandable row styles */\n  .expandable-row {\n    cursor: pointer;\n    transition: background 0.15s ease;\n  }\n\n  .expandable-row:hover {\n    background: rgba(137, 180, 250, 0.08) !important;\n  }\n\n  .expandable-row .expand-icon {\n    display: inline-block;\n    width: 12px;\n    text-align: center;\n    margin-right: 4px;\n    transition: transform 0.2s ease;\n    opacity: 0.5;\n    font-size: 10px;\n  }\n\n  .expandable-row:hover .expand-icon {\n    opacity: 1;\n  }\n\n  .expandable-row.expanded .expand-icon {\n    transform: rotate(90deg);\n  }\n\n  .expanded-content {\n    display: none;\n    background: #181825;\n    border: 1px solid #313244;\n    border-radius: 4px;\n    margin: 4px 8px 8px 8px;\n    padding: 12px;\n    overflow-x: auto;\n  }\n\n  .expanded-content__header {\n    display: flex;\n    justify-content: flex-end;\n    margin-bottom: 8px;\n  }\n\n  .expanded-content pre {\n    margin: 0;\n    white-space: pre-wrap;\n    word-break: break-word;\n    line-height: 1.6;\n    font-size: 11px;\n  }\n\n  .expandable-row.expanded + tr .expanded-content {\n    display: block;\n  }\n\n  /* Row with expanded content */\n  .expansion-row {\n    background: transparent !important;\n  }\n\n  .expansion-row:hover {\n    background: transparent !important;\n  }\n\n  .expansion-row td {\n    padding: 0 !important;\n    border: none !important;\n  }\n\n  /* Panel controls (sort toggle) */\n  .panel-controls {\n    display: flex;\n    align-items: center;\n    justify-content: flex-end;\n    padding: 8px 0 4px 0;\n    border-bottom: 1px solid var(--toolbar-border);\n    margin-bottom: 4px;\n  }\n\n  .sort-toggle {\n    display: flex;\n    align-items: center;\n    gap: 6px;\n    cursor: pointer;\n    font-size: 11px;\n    color: var(--toolbar-text-muted);\n    user-select: none;\n    transition: color 0.15s ease;\n  }\n\n  .sort-toggle:hover {\n    color: var(--toolbar-text);\n  }\n\n  .sort-toggle input[type=\"checkbox\"] {\n    appearance: none;\n    width: 14px;\n    height: 14px;\n    border: 1px solid var(--toolbar-border);\n    border-radius: 3px;\n    background: var(--toolbar-bg-secondary);\n    cursor: pointer;\n    position: relative;\n    transition: all 0.15s ease;\n  }\n\n  .sort-toggle input[type=\"checkbox\"]:hover {\n    border-color: var(--toolbar-accent);\n  }\n\n  .sort-toggle input[type=\"checkbox\"]:checked {\n    background: var(--toolbar-accent);\n    border-color: var(--toolbar-accent);\n  }\n\n  .sort-toggle input[type=\"checkbox\"]:checked::after {\n    content: '';\n    position: absolute;\n    left: 4px;\n    top: 1px;\n    width: 4px;\n    height: 8px;\n    border: solid var(--toolbar-bg);\n    border-width: 0 2px 2px 0;\n    transform: rotate(45deg);\n  }\n\n  /* Request detail rows */\n  .request-detail-row {\n    background: transparent !important;\n  }\n\n  .request-detail-row:hover {\n    background: transparent !important;\n  }\n\n  .request-detail-row td {\n    padding: 0 !important;\n    border: none !important;\n  }\n\n  .request-detail-pane {\n    background: var(--toolbar-bg-secondary);\n    border: 1px solid var(--toolbar-border);\n    border-radius: 4px;\n    margin: 4px 8px 8px 8px;\n    padding: 10px 12px;\n  }\n\n  .request-detail-section {\n    margin-bottom: 8px;\n  }\n\n  .request-detail-section:last-child {\n    margin-bottom: 0;\n  }\n\n  .request-detail-label {\n    display: block;\n    font-size: 10px;\n    font-weight: 600;\n    text-transform: uppercase;\n    letter-spacing: 0.05em;\n    color: var(--toolbar-text-muted);\n    margin-bottom: 3px;\n  }\n\n  .request-detail-value {\n    font-family: var(--toolbar-font);\n    font-size: 11px;\n    color: var(--toolbar-text);\n    word-break: break-all;\n  }\n\n  .request-detail-kv {\n    display: grid;\n    grid-template-columns: auto 1fr;\n    gap: 2px 10px;\n    font-size: 11px;\n    margin: 0;\n  }\n\n  .request-detail-kv dt {\n    color: var(--toolbar-accent);\n    font-weight: 500;\n    white-space: nowrap;\n  }\n\n  .request-detail-kv dd {\n    color: var(--toolbar-text);\n    margin: 0;\n    word-break: break-all;\n  }\n\n  .request-detail-masked {\n    color: var(--toolbar-text-muted);\n    font-style: italic;\n    font-size: 10px;\n  }\n\n  .request-detail-error {\n    background: rgba(243, 139, 168, 0.1);\n    border: 1px solid rgba(243, 139, 168, 0.3);\n    border-radius: 4px;\n    padding: 6px 8px;\n    color: var(--toolbar-error);\n    font-size: 11px;\n    word-break: break-word;\n  }\n\n  .request-detail-body {\n    background: rgba(30, 30, 46, 0.6);\n    border: 1px solid var(--toolbar-border);\n    border-radius: 4px;\n    padding: 10px 12px;\n    margin-top: 4px;\n    overflow-x: auto;\n    max-height: 300px;\n    overflow-y: auto;\n  }\n\n  .request-detail-body pre {\n    margin: 0;\n    white-space: pre-wrap;\n    word-break: break-word;\n    line-height: 1.6;\n    font-size: 11px;\n    color: var(--toolbar-text);\n    font-family: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, \"Liberation Mono\", \"Courier New\", monospace;\n  }\n\n  .request-detail-metadata {\n    display: flex;\n    flex-wrap: wrap;\n    gap: 6px 16px;\n    font-size: 11px;\n    color: var(--toolbar-text-muted);\n    margin-bottom: 6px;\n  }\n\n  .request-detail-metadata code {\n    font-family: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, \"Liberation Mono\", \"Courier New\", monospace;\n    color: var(--toolbar-text);\n    font-size: 11px;\n  }\n\n  .request-detail-metadata span {\n    white-space: nowrap;\n  }\n\n  /* Content-Type badge */\n  .badge-content-type {\n    font-size: 9px;\n    font-weight: 500;\n    text-transform: none;\n    padding: 1px 5px;\n    margin-left: 4px;\n    background: rgba(108, 112, 134, 0.2);\n    color: var(--toolbar-text-muted);\n    vertical-align: middle;\n  }\n\n  /* Request row cursor */\n  [data-request-id] {\n    cursor: pointer;\n  }\n\n  [data-request-id]:hover {\n    background: rgba(137, 180, 250, 0.08) !important;\n  }\n\n  [data-request-id] [data-expand-icon] {\n    display: inline-block;\n    width: 12px;\n    text-align: center;\n    margin-right: 4px;\n    opacity: 0.5;\n    font-size: 10px;\n    transition: opacity 0.15s ease;\n  }\n\n  [data-request-id]:hover [data-expand-icon] {\n    opacity: 1;\n  }\n\n  /* Responsive */\n  @media (max-width: 768px) {\n    :host {\n      --toolbar-height-expanded: 50vh;\n    }\n\n    .toolbar-tabs {\n      max-width: 60%;\n    }\n  }\n`;\n","// Panel renderers for the debug toolbar\n// Thin wrapper around shared panel components with toolbar-specific defaults\n\nimport type {\n  RequestEntry,\n  SQLEntry,\n  LogEntry,\n  RouteEntry,\n  CustomLogEntry,\n  CustomSnapshot,\n  JSErrorEntry,\n  DebugSnapshot,\n  PanelOptions,\n} from '../shared/types.js';\nimport { escapeHTML, isSlowDuration } from '../shared/utils.js';\nimport { toolbarStyles } from '../shared/styles.js';\nimport {\n  renderRequestsPanel,\n  renderSQLPanel,\n  renderLogsPanel,\n  renderRoutesPanel,\n  renderJSONPanel,\n  renderCustomPanel,\n  renderJSErrorsPanel,\n} from '../shared/panels/index.js';\n\n// Re-export types for consumers that import from this file\nexport type {\n  RequestEntry,\n  SQLEntry,\n  LogEntry,\n  RouteEntry,\n  CustomLogEntry,\n  CustomSnapshot,\n  JSErrorEntry,\n  DebugSnapshot,\n  PanelOptions,\n};\n\n// Use toolbar styles\nconst styles = toolbarStyles;\n\n/**\n * Main entry point for rendering panels in the toolbar.\n * Delegates to shared panel components with toolbar-specific defaults.\n */\nexport function renderPanel(\n  panel: string,\n  snapshot: DebugSnapshot,\n  slowThresholdMs = 50,\n  options?: PanelOptions & { expandedRequestIds?: Set<string> }\n): string {\n  const newestFirst = options?.newestFirst ?? true;\n  const threshold = options?.slowThresholdMs ?? slowThresholdMs;\n\n  switch (panel) {\n    case 'requests':\n      return renderRequestsPanel(snapshot.requests || [], styles, {\n        newestFirst,\n        slowThresholdMs: threshold,\n        maxEntries: 50,\n        showSortToggle: true,\n        truncatePath: true,\n        maxPathLength: 50,\n        expandedRequestIds: options?.expandedRequestIds,\n        maxDetailLength: 80,\n      });\n    case 'sql':\n      return renderSQLPanel(snapshot.sql || [], styles, {\n        newestFirst,\n        slowThresholdMs: threshold,\n        maxEntries: 50,\n        showSortToggle: true,\n        useIconCopyButton: false, // Toolbar uses SVG icons\n      });\n    case 'logs':\n      return renderLogsPanel(snapshot.logs || [], styles, {\n        newestFirst: true, // Logs always show newest first in toolbar\n        maxEntries: 100,\n        showSortToggle: false, // Logs don't have sort toggle in toolbar\n        showSource: false, // Toolbar doesn't show source column\n        truncateMessage: true,\n        maxMessageLength: 100,\n      });\n    case 'config':\n      return renderJSONPanel('Config', snapshot.config || {}, styles, {\n        useIconCopyButton: false,\n        showCount: false,\n      });\n    case 'routes':\n      return renderRoutesPanel(snapshot.routes || [], styles, {\n        showName: false, // Toolbar doesn't show name column\n      });\n    case 'template':\n      return renderJSONPanel('Template Context', snapshot.template || {}, styles, {\n        useIconCopyButton: false,\n        showCount: false,\n      });\n    case 'session':\n      return renderJSONPanel('Session', snapshot.session || {}, styles, {\n        useIconCopyButton: false,\n        showCount: false,\n      });\n    case 'jserrors':\n      return renderJSErrorsPanel(snapshot.jserrors || [], styles, {\n        newestFirst,\n        maxEntries: 50,\n        compact: true,\n        showSortToggle: true,\n      });\n    case 'custom':\n      return renderCustomPanel(snapshot.custom || {}, styles, {\n        maxLogEntries: 50,\n        useIconCopyButton: false,\n        showCount: false,\n      });\n    default: {\n      // Dynamically registered panels: render as JSON if data exists in snapshot\n      const panelData = snapshot[panel];\n      if (panelData != null) {\n        const label = panel.replace(/[_-]/g, ' ').replace(/\\b\\w/g, (c) => c.toUpperCase());\n        return renderJSONPanel(label, panelData, styles, {\n          useIconCopyButton: false,\n          showCount: false,\n        });\n      }\n      return `<div class=\"${styles.emptyState}\">Panel \"${escapeHTML(panel)}\" not available</div>`;\n    }\n  }\n}\n\n// Get counts for summary display\nexport function getCounts(\n  snapshot: DebugSnapshot,\n  slowThresholdMs = 50\n): {\n  requests: number;\n  sql: number;\n  logs: number;\n  jserrors: number;\n  errors: number;\n  slowQueries: number;\n} {\n  const requests = snapshot.requests?.length || 0;\n  const sql = snapshot.sql?.length || 0;\n  const logs = snapshot.logs?.length || 0;\n  const jserrors = snapshot.jserrors?.length || 0;\n\n  // Count errors\n  const requestErrors = (snapshot.requests || []).filter((r) => (r.status || 0) >= 400).length;\n  const sqlErrors = (snapshot.sql || []).filter((q) => q.error).length;\n  const logErrors = (snapshot.logs || []).filter((l) => {\n    const level = (l.level || '').toLowerCase();\n    return level === 'error' || level === 'fatal';\n  }).length;\n\n  // Count slow queries (using default 50ms threshold)\n  const slowQueries = (snapshot.sql || []).filter((q) => isSlowDuration(q.duration, slowThresholdMs)).length;\n\n  return {\n    requests,\n    sql,\n    logs,\n    jserrors,\n    errors: requestErrors + sqlErrors + logErrors + jserrors,\n    slowQueries,\n  };\n}\n","// Debug Toolbar Web Component\n// A self-contained toolbar that displays debug information at the bottom of the page\n// Works in conjunction with DebugFab for collapsed state\n\nimport { DebugStream, type DebugEvent, type DebugStreamStatus } from '../debug-stream.js';\nimport { DebugReplPanel, type DebugReplCommand } from '../repl/repl-panel.js';\nimport { toolbarStyles } from './toolbar-styles.js';\nimport { renderPanel, getCounts, type DebugSnapshot, type PanelOptions } from './panel-renderers.js';\nimport {\n  attachCopyListeners,\n  attachExpandableRowListeners,\n  attachSortToggleListeners,\n  attachSQLSelectionListeners,\n  attachRequestDetailListeners,\n} from '../shared/interactions.js';\nimport {\n  panelRegistry,\n  normalizeEventTypes,\n  defaultHandleEvent,\n  getSnapshotKey,\n  type RegistryChangeEvent,\n} from '../shared/panel-registry.js';\n// Import to ensure built-in panels are registered\nimport '../shared/builtin-panels.js';\n\n// Panel configuration\nconst replPanelIDs = new Set(['console', 'shell']);\n\n// REPL panel labels (not in registry)\nconst replPanelLabels: Record<string, string> = {\n  console: 'Console',\n  shell: 'Shell',\n};\n\n// Get default toolbar panels from registry (filter to toolbar-compatible)\nconst getDefaultToolbarPanels = (): string[] => {\n  const toolbarPanels = panelRegistry.getToolbarPanels();\n  if (toolbarPanels.length > 0) {\n    // Filter to core panels for toolbar default\n    return toolbarPanels\n      .filter((p) => p.category === 'core' || p.category === 'system')\n      .map((p) => p.id);\n  }\n  return ['requests', 'sql', 'logs', 'routes', 'config'];\n};\n\n// Get panel label from registry or fallback\nconst getPanelLabel = (panelId: string): string => {\n  if (replPanelLabels[panelId]) {\n    return replPanelLabels[panelId];\n  }\n  const def = panelRegistry.get(panelId);\n  if (def) {\n    return def.label;\n  }\n  // Fallback: capitalize\n  return panelId.charAt(0).toUpperCase() + panelId.slice(1);\n};\n\n// Get event types for a panel\nconst getPanelEventTypes = (panelId: string): string[] => {\n  const def = panelRegistry.get(panelId);\n  if (def) {\n    return normalizeEventTypes(def);\n  }\n  return [panelId];\n};\n\n// Build event-to-panel mapping from registry\nconst buildEventToPanel = (): Record<string, string> => {\n  const mapping: Record<string, string> = {};\n  for (const def of panelRegistry.list()) {\n    for (const eventType of normalizeEventTypes(def)) {\n      mapping[eventType] = def.id;\n    }\n  }\n  return mapping;\n};\n\ntype DebugReplCommandPayload = {\n  command?: string;\n  description?: string;\n  tags?: string[];\n  aliases?: string[];\n  mutates?: boolean;\n  read_only?: boolean;\n};\n\nconst normalizeReplCommands = (value: unknown): DebugReplCommand[] => {\n  if (!Array.isArray(value)) {\n    return [];\n  }\n  const commands: DebugReplCommand[] = [];\n  value.forEach((item) => {\n    if (!item || typeof item !== 'object') {\n      return;\n    }\n    const raw = item as DebugReplCommandPayload;\n    const command = typeof raw.command === 'string' ? raw.command.trim() : '';\n    if (!command) {\n      return;\n    }\n    const description = typeof raw.description === 'string' ? raw.description.trim() : '';\n    const tags = Array.isArray(raw.tags)\n      ? raw.tags.filter((tag) => typeof tag === 'string' && tag.trim() !== '').map((tag) => tag.trim())\n      : [];\n    const aliases = Array.isArray(raw.aliases)\n      ? raw.aliases.filter((alias) => typeof alias === 'string' && alias.trim() !== '').map((alias) => alias.trim())\n      : [];\n    const mutates =\n      typeof raw.mutates === 'boolean'\n        ? raw.mutates\n        : typeof raw.read_only === 'boolean'\n          ? !raw.read_only\n          : false;\n    commands.push({\n      command,\n      description: description || undefined,\n      tags: tags.length > 0 ? tags : undefined,\n      aliases: aliases.length > 0 ? aliases : undefined,\n      mutates,\n    });\n  });\n  return commands;\n};\n\nexport class DebugToolbar extends HTMLElement {\n  private shadow: ShadowRoot;\n  private stream: DebugStream | null = null;\n  private externalStream: DebugStream | null = null;\n  private snapshot: DebugSnapshot = {};\n  private replPanels: Map<string, DebugReplPanel> = new Map();\n  private replCommands: DebugReplCommand[] = [];\n  private expanded = false;\n  private activePanel = 'requests';\n  private connectionStatus: DebugStreamStatus = 'disconnected';\n  private slowThresholdMs = 50;\n  private useFab = false;\n  private customHeight: number | null = null;\n  private isResizing = false;\n  private resizeStartY = 0;\n  private resizeStartHeight = 0;\n  // Sort order state per panel (true = newest first, which is default)\n  private panelSortOrder: Map<string, boolean> = new Map([\n    ['requests', true],\n    ['sql', true],\n  ]);\n  // Event-to-panel mapping (built from registry)\n  private eventToPanel: Record<string, string> = {};\n  // Registry subscription cleanup\n  private unsubscribeRegistry: (() => void) | null = null;\n  // Expanded request detail state (preserved across re-renders)\n  private expandedRequests: Set<string> = new Set();\n\n  private static readonly MIN_HEIGHT = 150;\n  private static readonly MAX_HEIGHT_RATIO = 0.8;\n  private static readonly DEFAULT_HEIGHT = 320;\n\n  static get observedAttributes(): string[] {\n    return ['base-path', 'debug-path', 'panels', 'expanded', 'slow-threshold-ms', 'use-fab'];\n  }\n\n  constructor() {\n    super();\n    this.shadow = this.attachShadow({ mode: 'open' });\n  }\n\n  connectedCallback(): void {\n    // Build event-to-panel mapping from registry\n    this.eventToPanel = buildEventToPanel();\n\n    // Subscribe to registry changes\n    this.unsubscribeRegistry = panelRegistry.subscribe((event) => this.handleRegistryChange(event));\n\n    this.loadState();\n    this.render();\n    // Only init WebSocket if not using FAB (FAB manages its own connection)\n    if (!this.useFab) {\n      this.initWebSocket();\n      this.fetchInitialSnapshot();\n    }\n    this.setupKeyboardShortcut();\n  }\n\n  disconnectedCallback(): void {\n    this.stream?.close();\n    this.unsubscribeRegistry?.();\n    document.removeEventListener('keydown', this.handleKeyDown);\n  }\n\n  /**\n   * Handle registry changes (panel registered/unregistered)\n   */\n  private handleRegistryChange(event: RegistryChangeEvent): void {\n    // Rebuild event-to-panel mapping\n    this.eventToPanel = buildEventToPanel();\n\n    // Update subscriptions if we have a stream\n    this.updateSubscriptions();\n\n    // Re-render to update tabs\n    if (this.expanded) {\n      this.render();\n    }\n  }\n\n  /**\n   * Update WebSocket subscriptions based on current panels\n   */\n  private updateSubscriptions(): void {\n    const stream = this.getStream();\n    if (!stream) return;\n\n    const eventTypes = new Set<string>();\n    for (const panel of this.panels) {\n      for (const eventType of getPanelEventTypes(panel)) {\n        eventTypes.add(eventType);\n      }\n    }\n    stream.subscribe(Array.from(eventTypes));\n  }\n\n  attributeChangedCallback(name: string, oldValue: string | null, newValue: string | null): void {\n    if (oldValue === newValue) return;\n\n    if (name === 'expanded') {\n      this.expanded = newValue === 'true' || newValue === '';\n      this.saveState();\n      this.render();\n    } else if (name === 'slow-threshold-ms') {\n      this.slowThresholdMs = parseInt(newValue || '50', 10) || 50;\n    } else if (name === 'use-fab') {\n      this.useFab = newValue === 'true' || newValue === '';\n    }\n  }\n\n  // Public API for FAB integration\n  public setExpanded(expanded: boolean): void {\n    this.expanded = expanded;\n    this.saveState();\n    this.render();\n  }\n\n  public setSnapshot(snapshot: DebugSnapshot): void {\n    this.applySnapshot(snapshot || {});\n  }\n\n  public setConnectionStatus(status: DebugStreamStatus): void {\n    this.connectionStatus = status;\n    this.updateConnectionStatus();\n  }\n\n  public setStream(stream: DebugStream): void {\n    this.externalStream = stream;\n  }\n\n  public isExpanded(): boolean {\n    return this.expanded;\n  }\n\n  // State persistence\n  private loadState(): void {\n    try {\n      const stored = localStorage.getItem('debug-toolbar-expanded');\n      if (stored !== null) {\n        this.expanded = stored === 'true';\n      }\n      const storedHeight = localStorage.getItem('debug-toolbar-height');\n      if (storedHeight !== null) {\n        const height = parseInt(storedHeight, 10);\n        if (!isNaN(height) && height >= DebugToolbar.MIN_HEIGHT) {\n          this.customHeight = height;\n        }\n      }\n      // Load sort order preferences\n      const storedSortOrder = localStorage.getItem('debug-toolbar-sort-order');\n      if (storedSortOrder) {\n        try {\n          const parsed = JSON.parse(storedSortOrder) as Record<string, boolean>;\n          Object.entries(parsed).forEach(([panel, newestFirst]) => {\n            this.panelSortOrder.set(panel, newestFirst);\n          });\n        } catch {\n          // Ignore parse errors\n        }\n      }\n    } catch {\n      // Ignore localStorage errors\n    }\n  }\n\n  private saveState(): void {\n    try {\n      localStorage.setItem('debug-toolbar-expanded', String(this.expanded));\n      if (this.customHeight !== null) {\n        localStorage.setItem('debug-toolbar-height', String(this.customHeight));\n      }\n      // Save sort order preferences\n      const sortOrderObj: Record<string, boolean> = {};\n      this.panelSortOrder.forEach((value, key) => {\n        sortOrderObj[key] = value;\n      });\n      localStorage.setItem('debug-toolbar-sort-order', JSON.stringify(sortOrderObj));\n    } catch {\n      // Ignore localStorage errors\n    }\n  }\n\n  // Keyboard shortcut\n  private handleKeyDown = (e: KeyboardEvent): void => {\n    // Ctrl+Shift+D or Cmd+Shift+D to toggle\n    if ((e.ctrlKey || e.metaKey) && e.shiftKey && e.key.toLowerCase() === 'd') {\n      e.preventDefault();\n      this.toggleExpanded();\n    }\n    // Escape to collapse\n    if (e.key === 'Escape' && this.expanded) {\n      this.collapse();\n    }\n  };\n\n  private setupKeyboardShortcut(): void {\n    document.addEventListener('keydown', this.handleKeyDown);\n  }\n\n  private toggleExpanded(): void {\n    this.expanded = !this.expanded;\n    this.saveState();\n    this.render();\n    this.dispatchExpandEvent();\n  }\n\n  private collapse(): void {\n    if (!this.expanded) return;\n    this.expanded = false;\n    this.saveState();\n    this.render();\n    this.dispatchExpandEvent();\n  }\n\n  private dispatchExpandEvent(): void {\n    this.dispatchEvent(new CustomEvent('debug-expand', {\n      detail: { expanded: this.expanded },\n      bubbles: true,\n      composed: true,\n    }));\n  }\n\n  // Attribute getters\n  private get basePath(): string {\n    return this.getAttribute('base-path') || '/admin';\n  }\n\n  private get debugPath(): string {\n    const attr = this.getAttribute('debug-path');\n    if (attr) return attr;\n    return `${this.basePath}/debug`;\n  }\n\n  private get panels(): string[] {\n    const attr = this.getAttribute('panels');\n    if (attr) {\n      const parsed = attr\n        .split(',')\n        .map((p) => p.trim().toLowerCase())\n        .filter(Boolean);\n      return parsed.length ? parsed : getDefaultToolbarPanels();\n    }\n    return getDefaultToolbarPanels();\n  }\n\n  private get wsUrl(): string {\n    return `${this.debugPath}/ws`;\n  }\n\n  // Get the active stream (external from FAB or internal)\n  private getStream(): DebugStream | null {\n    return this.externalStream || this.stream;\n  }\n\n  // WebSocket initialization\n  private initWebSocket(): void {\n    this.stream = new DebugStream({\n      basePath: this.debugPath,\n      onEvent: (event) => this.handleEvent(event),\n      onStatusChange: (status) => this.handleStatusChange(status),\n    });\n\n    this.stream.connect();\n    // Subscribe to event types for all panels\n    const eventTypes = new Set<string>();\n    for (const panel of this.panels) {\n      for (const eventType of getPanelEventTypes(panel)) {\n        eventTypes.add(eventType);\n      }\n    }\n    this.stream.subscribe(Array.from(eventTypes));\n  }\n\n  // Fetch initial snapshot via HTTP\n  private async fetchInitialSnapshot(): Promise<void> {\n    try {\n      const response = await fetch(`${this.debugPath}/api/snapshot`, {\n        credentials: 'same-origin',\n      });\n      if (response.ok) {\n        const data = await response.json();\n        this.applySnapshot(data);\n      }\n    } catch {\n      // Ignore fetch errors - WebSocket will provide data\n    }\n  }\n\n  // Event handlers\n  private handleEvent(event: DebugEvent): void {\n    if (!event || !event.type) return;\n\n    if (event.type === 'snapshot') {\n      this.applySnapshot(event.payload as DebugSnapshot);\n      return;\n    }\n\n    // Find panel for this event type\n    const panel = this.eventToPanel[event.type] || event.type;\n\n    // Check if we have a registry definition\n    const def = panelRegistry.get(panel);\n    if (def) {\n      // Use registry's handleEvent or default\n      const snapshotKey = getSnapshotKey(def);\n      const currentData = (this.snapshot as Record<string, unknown>)[snapshotKey];\n      const handler = def.handleEvent || ((current, payload) => defaultHandleEvent(current, payload, 500));\n      const newData = handler(currentData, event.payload);\n      (this.snapshot as Record<string, unknown>)[snapshotKey] = newData;\n    } else {\n      // Fallback for non-registry events\n      switch (event.type) {\n        case 'request':\n          this.snapshot.requests = this.snapshot.requests || [];\n          this.snapshot.requests.push(event.payload);\n          this.trimArray(this.snapshot.requests, 500);\n          break;\n        case 'sql':\n          this.snapshot.sql = this.snapshot.sql || [];\n          this.snapshot.sql.push(event.payload);\n          this.trimArray(this.snapshot.sql, 200);\n          break;\n        case 'log':\n          this.snapshot.logs = this.snapshot.logs || [];\n          this.snapshot.logs.push(event.payload);\n          this.trimArray(this.snapshot.logs, 500);\n          break;\n        case 'template':\n          this.snapshot.template = event.payload || {};\n          break;\n        case 'session':\n          this.snapshot.session = event.payload || {};\n          break;\n        case 'custom':\n          this.handleCustomEvent(event.payload);\n          break;\n      }\n    }\n\n    // Update UI if showing affected panel\n    if (panel === this.activePanel && this.expanded) {\n      this.updateContent();\n    }\n  }\n\n  private handleCustomEvent(payload: unknown): void {\n    if (!payload || typeof payload !== 'object') return;\n    this.snapshot.custom = this.snapshot.custom || { data: {}, logs: [] };\n\n    const p = payload as Record<string, unknown>;\n    if ('key' in p && 'value' in p) {\n      this.snapshot.custom.data = this.snapshot.custom.data || {};\n      this.snapshot.custom.data[String(p.key)] = p.value;\n    } else if ('category' in p || 'message' in p) {\n      this.snapshot.custom.logs = this.snapshot.custom.logs || [];\n      this.snapshot.custom.logs.push(payload as { category?: string; message?: string });\n      this.trimArray(this.snapshot.custom.logs, 500);\n    }\n  }\n\n  private handleStatusChange(status: DebugStreamStatus): void {\n    this.connectionStatus = status;\n    this.updateConnectionStatus();\n  }\n\n  private applySnapshot(data: DebugSnapshot): void {\n    this.snapshot = data || {};\n    this.replCommands = normalizeReplCommands(this.snapshot.repl_commands);\n    this.updateContent();\n  }\n\n  private trimArray<T>(arr: T[], max: number): void {\n    while (arr.length > max) {\n      arr.shift();\n    }\n  }\n\n  // Rendering\n  private render(): void {\n    const counts = getCounts(this.snapshot, this.slowThresholdMs);\n    const panelTabs = this.panels\n      .map((panel) => {\n        const label = getPanelLabel(panel);\n        const count = this.getPanelCount(panel);\n        const active = this.activePanel === panel ? 'active' : '';\n        return `\n          <button class=\"tab ${active}\" data-panel=\"${panel}\">\n            ${label}\n            <span class=\"tab-count\">${count}</span>\n          </button>\n        `;\n      })\n      .join('');\n\n    // When using FAB, toolbar is either expanded (visible) or collapsed (hidden)\n    // When not using FAB, show the summary bar in collapsed state\n    const expandedClass = this.expanded ? 'expanded' : 'collapsed';\n    const hiddenClass = this.useFab && !this.expanded ? 'hidden' : '';\n    const toolbarHeight = this.expanded\n      ? (this.customHeight || DebugToolbar.DEFAULT_HEIGHT)\n      : 36;\n    const heightStyle = this.expanded ? `height: ${toolbarHeight}px;` : '';\n\n    this.shadow.innerHTML = `\n      <style>${toolbarStyles}</style>\n      <div class=\"toolbar ${expandedClass} ${hiddenClass}\" style=\"${heightStyle}\">\n        ${this.expanded ? `\n          <div class=\"resize-handle\" data-resize-handle></div>\n          <div class=\"toolbar-header\">\n            <div class=\"toolbar-tabs\">${panelTabs}</div>\n            <div class=\"toolbar-actions\">\n              <span class=\"connection-indicator\">\n                <span class=\"status-dot ${this.connectionStatus}\"></span>\n              </span>\n              <button class=\"action-btn\" data-action=\"refresh\" title=\"Refresh (get snapshot)\">\n                <svg viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" stroke-width=\"2\" width=\"14\" height=\"14\">\n                  <path d=\"M23 4v6h-6M1 20v-6h6\"/>\n                  <path d=\"M3.51 9a9 9 0 0 1 14.85-3.36L23 10M1 14l4.64 4.36A9 9 0 0 0 20.49 15\"/>\n                </svg>\n              </button>\n              <button class=\"action-btn\" data-action=\"clear\" title=\"Clear all data\">\n                <svg viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" stroke-width=\"2\" width=\"14\" height=\"14\">\n                  <path d=\"M3 6h18M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6m3 0V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2\"/>\n                </svg>\n              </button>\n              <a class=\"action-btn expand-link\" href=\"${this.debugPath}\" title=\"Open full debug page\">\n                <svg viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" stroke-width=\"2\" width=\"14\" height=\"14\">\n                  <path d=\"M15 3h6v6M9 21H3v-6M21 3l-7 7M3 21l7-7\"/>\n                </svg>\n              </a>\n              <button class=\"action-btn collapse-btn\" data-action=\"collapse\" title=\"Collapse (Esc)\">\n                <svg viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" stroke-width=\"2\" width=\"14\" height=\"14\">\n                  <path d=\"M18 6L6 18M6 6l12 12\"/>\n                </svg>\n              </button>\n            </div>\n          </div>\n          <div class=\"toolbar-content\">\n            <div class=\"panel-container\" id=\"panel-content\">\n              ${renderPanel(this.activePanel, this.snapshot, this.slowThresholdMs, this.getPanelOptions())}\n            </div>\n          </div>\n        ` : ''}\n        ${!this.useFab ? `\n          <div class=\"toolbar-summary\">\n            <div class=\"summary-item ${counts.errors > 0 ? 'has-errors' : ''}\">\n              <span>Requests:</span>\n              <span class=\"count\">${counts.requests}</span>\n            </div>\n            <div class=\"summary-item ${counts.slowQueries > 0 ? 'has-slow' : ''}\">\n              <span>SQL:</span>\n              <span class=\"count\">${counts.sql}</span>\n            </div>\n            <div class=\"summary-item\">\n              <span>Logs:</span>\n              <span class=\"count\">${counts.logs}</span>\n            </div>\n            ${counts.errors > 0 ? `\n              <div class=\"summary-item has-errors\">\n                <span>Errors:</span>\n                <span class=\"count\">${counts.errors}</span>\n              </div>\n            ` : ''}\n            <div class=\"connection-status\">\n              <span class=\"status-dot ${this.connectionStatus}\"></span>\n              <span>${this.connectionStatus}</span>\n            </div>\n          </div>\n        ` : ''}\n      </div>\n    `;\n\n    this.attachEventListeners();\n  }\n\n  private updateContent(): void {\n    // Update panel content if expanded\n    if (this.expanded) {\n      const container = this.shadow.getElementById('panel-content');\n      if (container) {\n        if (replPanelIDs.has(this.activePanel)) {\n          this.renderReplPanel(container, this.activePanel);\n        } else {\n          container.innerHTML = renderPanel(this.activePanel, this.snapshot, this.slowThresholdMs, this.getPanelOptions());\n          this.attachExpandableRowListeners();\n          this.attachCopyListeners();\n          this.attachSortToggleListeners();\n          this.attachSQLSelectionListeners();\n          if (this.activePanel === 'requests') {\n            attachRequestDetailListeners(this.shadow, this.expandedRequests);\n          }\n        }\n      }\n      // Update tab counts\n      this.panels.forEach((panel) => {\n        const tab = this.shadow.querySelector(`[data-panel=\"${panel}\"] .tab-count`);\n        if (tab) {\n          tab.textContent = String(this.getPanelCount(panel));\n        }\n      });\n    }\n\n    // Update summary counts (only when not using FAB)\n    if (!this.useFab) {\n      this.updateSummary();\n    }\n  }\n\n  private updateSummary(): void {\n    const counts = getCounts(this.snapshot, this.slowThresholdMs);\n    const summary = this.shadow.querySelector('.toolbar-summary');\n    if (!summary) return;\n\n    const items = summary.querySelectorAll('.summary-item');\n    items.forEach((item) => {\n      const label = item.querySelector('span:first-child')?.textContent?.replace(':', '').toLowerCase();\n      const countEl = item.querySelector('.count');\n      if (!countEl || !label) return;\n\n      if (label === 'requests') {\n        countEl.textContent = String(counts.requests);\n        item.classList.toggle('has-errors', counts.errors > 0);\n      } else if (label === 'sql') {\n        countEl.textContent = String(counts.sql);\n        item.classList.toggle('has-slow', counts.slowQueries > 0);\n      } else if (label === 'logs') {\n        countEl.textContent = String(counts.logs);\n      } else if (label === 'errors') {\n        countEl.textContent = String(counts.errors);\n      }\n    });\n  }\n\n  private updateConnectionStatus(): void {\n    // Update header indicator\n    const headerDot = this.shadow.querySelector('.connection-indicator .status-dot');\n    if (headerDot) {\n      headerDot.className = `status-dot ${this.connectionStatus}`;\n    }\n\n    // Update summary indicator (when not using FAB)\n    const summaryDot = this.shadow.querySelector('.connection-status .status-dot');\n    const summaryText = this.shadow.querySelector('.connection-status span:last-child');\n    if (summaryDot) {\n      summaryDot.className = `status-dot ${this.connectionStatus}`;\n    }\n    if (summaryText) {\n      summaryText.textContent = this.connectionStatus;\n    }\n  }\n\n  private getPanelCount(panel: string): number {\n    switch (panel) {\n      case 'requests':\n        return this.snapshot.requests?.length || 0;\n      case 'sql':\n        return this.snapshot.sql?.length || 0;\n      case 'logs':\n        return this.snapshot.logs?.length || 0;\n      case 'routes':\n        return this.snapshot.routes?.length || 0;\n      case 'template':\n        return Object.keys(this.snapshot.template || {}).length;\n      case 'session':\n        return Object.keys(this.snapshot.session || {}).length;\n      case 'config':\n        return Object.keys(this.snapshot.config || {}).length;\n      case 'custom':\n        const custom = this.snapshot.custom || {};\n        return Object.keys(custom.data || {}).length + (custom.logs?.length || 0);\n      default: {\n        // Dynamically registered panels: count keys if object, length if array\n        const data = this.snapshot[panel];\n        if (Array.isArray(data)) {\n          return data.length;\n        }\n        if (data != null && typeof data === 'object') {\n          return Object.keys(data as Record<string, unknown>).length;\n        }\n        return 0;\n      }\n    }\n  }\n\n  private getPanelOptions(): PanelOptions & { expandedRequestIds?: Set<string> } {\n    return {\n      slowThresholdMs: this.slowThresholdMs,\n      newestFirst: this.panelSortOrder.get(this.activePanel) ?? true,\n      expandedRequestIds: this.expandedRequests,\n    };\n  }\n\n  private attachEventListeners(): void {\n    // Tab clicks\n    this.shadow.querySelectorAll('.tab').forEach((tab) => {\n      tab.addEventListener('click', (e) => {\n        const panel = (e.currentTarget as HTMLElement).dataset.panel;\n        if (panel && panel !== this.activePanel) {\n          this.activePanel = panel;\n          // Update active state\n          this.shadow.querySelectorAll('.tab').forEach((t) => t.classList.remove('active'));\n          (e.currentTarget as HTMLElement).classList.add('active');\n          // Render panel content\n          const container = this.shadow.getElementById('panel-content');\n          if (container) {\n            container.innerHTML = renderPanel(this.activePanel, this.snapshot, this.slowThresholdMs, this.getPanelOptions());\n            this.attachExpandableRowListeners();\n            this.attachCopyListeners();\n            this.attachSortToggleListeners();\n            this.attachSQLSelectionListeners();\n            if (this.activePanel === 'requests') {\n              attachRequestDetailListeners(this.shadow, this.expandedRequests);\n            }\n          }\n        }\n      });\n    });\n\n    // Attach expandable row listeners for initial render\n    this.attachExpandableRowListeners();\n    this.attachCopyListeners();\n    this.attachSortToggleListeners();\n    this.attachSQLSelectionListeners();\n    if (this.activePanel === 'requests') {\n      attachRequestDetailListeners(this.shadow, this.expandedRequests);\n    }\n\n    // Action buttons\n    this.shadow.querySelectorAll('[data-action]').forEach((btn) => {\n      btn.addEventListener('click', (e) => {\n        const action = (e.currentTarget as HTMLElement).dataset.action;\n        const activeStream = this.getStream();\n        switch (action) {\n          case 'toggle':\n            this.toggleExpanded();\n            break;\n          case 'collapse':\n            this.collapse();\n            break;\n          case 'refresh':\n            activeStream?.requestSnapshot();\n            break;\n          case 'clear':\n            activeStream?.clear();\n            this.snapshot = {};\n            this.updateContent();\n            break;\n        }\n      });\n    });\n\n    // Summary click to expand (when not using FAB)\n    if (!this.useFab) {\n      const summary = this.shadow.querySelector('.toolbar-summary');\n      if (summary) {\n        summary.addEventListener('click', () => {\n          if (!this.expanded) {\n            this.expanded = true;\n            this.saveState();\n            this.render();\n            this.dispatchExpandEvent();\n          }\n        });\n      }\n    }\n\n    // Resize handle\n    this.attachResizeListeners();\n\n    // Copy buttons\n    this.attachCopyListeners();\n  }\n\n  private renderReplPanel(container: HTMLElement, panel: string): void {\n    let replPanel = this.replPanels.get(panel);\n    if (!replPanel) {\n      replPanel = new DebugReplPanel({\n        kind: panel === 'shell' ? 'shell' : 'console',\n        debugPath: this.debugPath,\n        commands: panel === 'console' ? this.replCommands : [],\n      });\n      this.replPanels.set(panel, replPanel);\n    }\n    replPanel.attach(container);\n  }\n\n  private attachResizeListeners(): void {\n    const resizeHandle = this.shadow.querySelector('[data-resize-handle]');\n    if (!resizeHandle) return;\n\n    resizeHandle.addEventListener('mousedown', (e: Event) => {\n      const mouseEvent = e as MouseEvent;\n      mouseEvent.preventDefault();\n      this.startResize(mouseEvent.clientY);\n    });\n\n    resizeHandle.addEventListener('touchstart', (e: Event) => {\n      const touchEvent = e as TouchEvent;\n      if (touchEvent.touches.length === 1) {\n        touchEvent.preventDefault();\n        this.startResize(touchEvent.touches[0].clientY);\n      }\n    }, { passive: false });\n  }\n\n  private startResize(startY: number): void {\n    this.isResizing = true;\n    this.resizeStartY = startY;\n    const toolbar = this.shadow.querySelector('.toolbar') as HTMLElement;\n    this.resizeStartHeight = toolbar?.offsetHeight || DebugToolbar.DEFAULT_HEIGHT;\n\n    toolbar?.classList.add('resizing');\n    document.body.style.cursor = 'ns-resize';\n    document.body.style.userSelect = 'none';\n\n    const handleMouseMove = (e: MouseEvent) => {\n      this.handleResize(e.clientY);\n    };\n\n    const handleTouchMove = (e: TouchEvent) => {\n      if (e.touches.length === 1) {\n        this.handleResize(e.touches[0].clientY);\n      }\n    };\n\n    const handleEnd = () => {\n      this.isResizing = false;\n      toolbar?.classList.remove('resizing');\n      document.body.style.cursor = '';\n      document.body.style.userSelect = '';\n      document.removeEventListener('mousemove', handleMouseMove);\n      document.removeEventListener('mouseup', handleEnd);\n      document.removeEventListener('touchmove', handleTouchMove);\n      document.removeEventListener('touchend', handleEnd);\n      this.saveState();\n    };\n\n    document.addEventListener('mousemove', handleMouseMove);\n    document.addEventListener('mouseup', handleEnd);\n    document.addEventListener('touchmove', handleTouchMove, { passive: true });\n    document.addEventListener('touchend', handleEnd);\n  }\n\n  private handleResize(currentY: number): void {\n    if (!this.isResizing) return;\n\n    const delta = this.resizeStartY - currentY;\n    const maxHeight = window.innerHeight * DebugToolbar.MAX_HEIGHT_RATIO;\n    const newHeight = Math.min(maxHeight, Math.max(DebugToolbar.MIN_HEIGHT, this.resizeStartHeight + delta));\n\n    this.customHeight = newHeight;\n\n    const toolbar = this.shadow.querySelector('.toolbar') as HTMLElement;\n    if (toolbar) {\n      toolbar.style.height = `${newHeight}px`;\n    }\n  }\n\n  private attachExpandableRowListeners(): void {\n    // Use shared helper for expandable row behavior\n    attachExpandableRowListeners(this.shadow);\n  }\n\n  private attachCopyListeners(): void {\n    // Use shared helper for copy-to-clipboard behavior (toolbar style with SVG feedback)\n    attachCopyListeners(this.shadow, { useIconFeedback: false });\n  }\n\n  private attachSortToggleListeners(): void {\n    // Use shared helper for sort toggle behavior\n    attachSortToggleListeners(this.shadow, (panelId, newestFirst) => {\n      this.panelSortOrder.set(panelId, newestFirst);\n      this.saveState();\n      this.updateContent();\n    });\n  }\n\n  private attachSQLSelectionListeners(): void {\n    if (this.activePanel !== 'sql') return;\n    // Use shared helper for SQL row selection (toolbar style with SVG feedback)\n    attachSQLSelectionListeners(this.shadow, this.snapshot.sql || [], { useIconFeedback: false });\n  }\n}\n\n// Register the custom element\nif (!customElements.get('debug-toolbar')) {\n  customElements.define('debug-toolbar', DebugToolbar);\n}\n","// Shadow DOM styles for the debug FAB (Floating Action Button)\n// Self-contained CSS that won't leak to or from the host page\n\nexport const fabStyles = `\n  :host {\n    --fab-bg: #1e1e2e;\n    --fab-bg-hover: #313244;\n    --fab-border: #45475a;\n    --fab-text: #cdd6f4;\n    --fab-text-muted: #6c7086;\n    --fab-accent: #89b4fa;\n    --fab-success: #a6e3a1;\n    --fab-warning: #f9e2af;\n    --fab-error: #f38ba8;\n    --fab-font: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, \"Liberation Mono\", \"Courier New\", monospace;\n\n    position: fixed;\n    bottom: 16px;\n    right: 16px;\n    z-index: 99998;\n    font-family: var(--fab-font);\n    font-size: 12px;\n    line-height: 1.4;\n    pointer-events: auto;\n  }\n\n  * {\n    box-sizing: border-box;\n    margin: 0;\n    padding: 0;\n  }\n\n  .fab {\n    position: relative;\n    display: flex;\n    align-items: center;\n    background: var(--fab-bg);\n    border: 1px solid var(--fab-border);\n    border-radius: 24px;\n    cursor: pointer;\n    transition: all 0.25s cubic-bezier(0.4, 0, 0.2, 1);\n    box-shadow: 0 4px 12px rgba(0, 0, 0, 0.3);\n    overflow: visible;\n    height: 48px;\n    min-width: 48px;\n  }\n\n  .fab:hover {\n    background: var(--fab-bg-hover);\n    box-shadow: 0 6px 16px rgba(0, 0, 0, 0.4);\n    transform: translateY(-2px);\n  }\n\n  .fab.hidden {\n    opacity: 0;\n    pointer-events: none;\n    transform: scale(0.8) translateY(20px);\n  }\n\n  /* Collapsed state - icon only */\n  .fab-collapsed {\n    display: flex;\n    align-items: center;\n    justify-content: center;\n    width: 48px;\n    height: 48px;\n    flex-shrink: 0;\n  }\n\n  .fab-icon {\n    width: 24px;\n    height: 24px;\n    color: var(--fab-accent);\n    display: flex;\n    align-items: center;\n    justify-content: center;\n  }\n\n  .fab-icon svg {\n    width: 100%;\n    height: 100%;\n  }\n\n  /* Connection status dot - positioned at bottom-right of icon area */\n  /* Icon is 24x24 centered in 48x48 container: icon spans 12px-36px both axes */\n  /* Dot overlaps icon's bottom-right corner */\n  .fab-status-dot {\n    position: absolute;\n    bottom: 11px;\n    left: 40px;\n    width: 10px;\n    height: 10px;\n    border-radius: 50%;\n    border: 2px solid var(--fab-bg);\n    background: var(--fab-text-muted);\n    transition: background 0.2s, box-shadow 0.2s;\n    z-index: 1;\n  }\n\n  .fab[data-status=\"connected\"] .fab-status-dot {\n    background: var(--fab-success);\n    box-shadow: 0 0 6px var(--fab-success);\n  }\n\n  .fab[data-status=\"disconnected\"] .fab-status-dot {\n    background: var(--fab-text-muted);\n  }\n\n  .fab[data-status=\"reconnecting\"] .fab-status-dot {\n    background: var(--fab-warning);\n    animation: pulse 1s ease-in-out infinite;\n  }\n\n  .fab[data-status=\"error\"] .fab-status-dot {\n    background: var(--fab-error);\n    box-shadow: 0 0 6px var(--fab-error);\n  }\n\n  @keyframes pulse {\n    0%, 100% { opacity: 1; }\n    50% { opacity: 0.4; }\n  }\n\n  /* Expanded state - counters */\n  .fab-expanded {\n    display: flex;\n    align-items: center;\n    gap: 12px;\n    padding-right: 16px;\n    max-width: 0;\n    opacity: 0;\n    overflow: hidden;\n    transition: all 0.25s cubic-bezier(0.4, 0, 0.2, 1);\n  }\n\n  .fab:hover .fab-expanded,\n  .fab.is-hovered .fab-expanded {\n    max-width: 300px;\n    opacity: 1;\n    padding-left: 4px;\n  }\n\n  .fab-counter {\n    display: flex;\n    flex-direction: column;\n    align-items: center;\n    min-width: 36px;\n    padding: 4px 8px;\n    border-radius: 8px;\n    background: rgba(255, 255, 255, 0.05);\n    transition: background 0.15s;\n  }\n\n  .fab-counter.has-items {\n    background: rgba(137, 180, 250, 0.15);\n  }\n\n  .fab-counter.has-slow {\n    background: rgba(249, 226, 175, 0.15);\n  }\n\n  .fab-counter.has-errors {\n    background: rgba(243, 139, 168, 0.15);\n  }\n\n  .counter-value {\n    font-size: 14px;\n    font-weight: 600;\n    color: var(--fab-text);\n    font-variant-numeric: tabular-nums;\n  }\n\n  .fab-counter.has-items .counter-value {\n    color: var(--fab-accent);\n  }\n\n  .fab-counter.has-slow .counter-value {\n    color: var(--fab-warning);\n  }\n\n  .fab-counter.has-errors .counter-value {\n    color: var(--fab-error);\n  }\n\n  .counter-label {\n    font-size: 9px;\n    color: var(--fab-text-muted);\n    text-transform: uppercase;\n    letter-spacing: 0.05em;\n  }\n\n  /* Responsive */\n  @media (max-width: 480px) {\n    :host {\n      bottom: 12px;\n      right: 12px;\n    }\n\n    .fab {\n      height: 44px;\n      min-width: 44px;\n    }\n\n    .fab-collapsed {\n      width: 44px;\n      height: 44px;\n    }\n\n    .fab-icon {\n      width: 20px;\n      height: 20px;\n    }\n\n    .fab-status-dot {\n      width: 8px;\n      height: 8px;\n      bottom: 11px;\n      left: 40px;\n    }\n\n    .fab-counter {\n      min-width: 32px;\n      padding: 3px 6px;\n    }\n\n    .counter-value {\n      font-size: 12px;\n    }\n\n    .counter-label {\n      font-size: 8px;\n    }\n  }\n`;\n","// Debug FAB (Floating Action Button) Component\n// A minimized debug indicator that expands on hover and opens the toolbar on click\n\nimport { DebugStream, type DebugEvent, type DebugStreamStatus } from '../debug-stream.js';\nimport { getCounts, type DebugSnapshot } from './panel-renderers.js';\nimport { fabStyles } from './fab-styles.js';\n\n// Panel configuration for events\nconst panelEventMap: Record<string, string> = {\n  template: 'template',\n  session: 'session',\n  requests: 'request',\n  sql: 'sql',\n  logs: 'log',\n  custom: 'custom',\n};\n\nconst eventToPanel: Record<string, string> = {\n  request: 'requests',\n  sql: 'sql',\n  log: 'logs',\n  template: 'template',\n  session: 'session',\n  custom: 'custom',\n};\n\nconst defaultPanels = ['requests', 'sql', 'logs', 'routes', 'config'];\n\nexport class DebugFab extends HTMLElement {\n  private shadow: ShadowRoot;\n  private stream: DebugStream | null = null;\n  private snapshot: DebugSnapshot = {};\n  private connectionStatus: DebugStreamStatus = 'disconnected';\n  private isHovered = false;\n  private toolbarExpanded = false;\n\n  static get observedAttributes(): string[] {\n    return ['debug-path', 'panels', 'toolbar-expanded'];\n  }\n\n  constructor() {\n    super();\n    this.shadow = this.attachShadow({ mode: 'open' });\n  }\n\n  connectedCallback(): void {\n    this.render();\n    this.initWebSocket();\n    this.fetchInitialSnapshot();\n    this.loadState();\n  }\n\n  disconnectedCallback(): void {\n    this.stream?.close();\n  }\n\n  attributeChangedCallback(name: string, oldValue: string | null, newValue: string | null): void {\n    if (oldValue === newValue) return;\n\n    if (name === 'toolbar-expanded') {\n      this.toolbarExpanded = newValue === 'true' || newValue === '';\n      this.render();\n    }\n  }\n\n  // Public API\n  public setToolbarExpanded(expanded: boolean): void {\n    this.toolbarExpanded = expanded;\n    this.saveState();\n    this.render();\n  }\n\n  public getSnapshot(): DebugSnapshot {\n    return this.snapshot;\n  }\n\n  public getConnectionStatus(): DebugStreamStatus {\n    return this.connectionStatus;\n  }\n\n  public getStream(): DebugStream | null {\n    return this.stream;\n  }\n\n  // Attribute getters\n  private get debugPath(): string {\n    return this.getAttribute('debug-path') || '/admin/debug';\n  }\n\n  private get panels(): string[] {\n    const attr = this.getAttribute('panels');\n    if (attr) {\n      const parsed = attr\n        .split(',')\n        .map((p) => p.trim().toLowerCase())\n        .filter(Boolean);\n      return parsed.length ? parsed : defaultPanels;\n    }\n    return defaultPanels;\n  }\n\n  // State persistence\n  private loadState(): void {\n    try {\n      const stored = localStorage.getItem('debug-toolbar-expanded');\n      if (stored !== null) {\n        this.toolbarExpanded = stored === 'true';\n        this.render();\n      }\n    } catch {\n      // Ignore localStorage errors\n    }\n  }\n\n  private saveState(): void {\n    try {\n      localStorage.setItem('debug-toolbar-expanded', String(this.toolbarExpanded));\n    } catch {\n      // Ignore localStorage errors\n    }\n  }\n\n  // WebSocket initialization\n  private initWebSocket(): void {\n    this.stream = new DebugStream({\n      basePath: this.debugPath,\n      onEvent: (event) => this.handleEvent(event),\n      onStatusChange: (status) => this.handleStatusChange(status),\n    });\n\n    this.stream.connect();\n    this.stream.subscribe(this.panels.map((panel) => panelEventMap[panel] || panel));\n  }\n\n  // Fetch initial snapshot via HTTP\n  private async fetchInitialSnapshot(): Promise<void> {\n    try {\n      const response = await fetch(`${this.debugPath}/api/snapshot`, {\n        credentials: 'same-origin',\n      });\n      if (response.ok) {\n        const data = await response.json();\n        this.applySnapshot(data);\n      }\n    } catch {\n      // Ignore fetch errors - WebSocket will provide data\n    }\n  }\n\n  // Event handlers\n  private handleEvent(event: DebugEvent): void {\n    if (!event || !event.type) return;\n\n    if (event.type === 'snapshot') {\n      this.applySnapshot(event.payload as DebugSnapshot);\n      return;\n    }\n\n    // Apply incremental updates\n    switch (event.type) {\n      case 'request':\n        this.snapshot.requests = this.snapshot.requests || [];\n        this.snapshot.requests.push(event.payload);\n        this.trimArray(this.snapshot.requests, 500);\n        break;\n      case 'sql':\n        this.snapshot.sql = this.snapshot.sql || [];\n        this.snapshot.sql.push(event.payload);\n        this.trimArray(this.snapshot.sql, 200);\n        break;\n      case 'log':\n        this.snapshot.logs = this.snapshot.logs || [];\n        this.snapshot.logs.push(event.payload);\n        this.trimArray(this.snapshot.logs, 500);\n        break;\n      case 'template':\n        this.snapshot.template = event.payload || {};\n        break;\n      case 'session':\n        this.snapshot.session = event.payload || {};\n        break;\n      case 'custom':\n        this.handleCustomEvent(event.payload);\n        break;\n    }\n\n    this.updateCounters();\n  }\n\n  private handleCustomEvent(payload: unknown): void {\n    if (!payload || typeof payload !== 'object') return;\n    this.snapshot.custom = this.snapshot.custom || { data: {}, logs: [] };\n\n    const p = payload as Record<string, unknown>;\n    if ('key' in p && 'value' in p) {\n      this.snapshot.custom.data = this.snapshot.custom.data || {};\n      this.snapshot.custom.data[String(p.key)] = p.value;\n    } else if ('category' in p || 'message' in p) {\n      this.snapshot.custom.logs = this.snapshot.custom.logs || [];\n      this.snapshot.custom.logs.push(payload as { category?: string; message?: string });\n      this.trimArray(this.snapshot.custom.logs, 500);\n    }\n  }\n\n  private handleStatusChange(status: DebugStreamStatus): void {\n    this.connectionStatus = status;\n    this.updateConnectionStatus();\n    // Dispatch event for toolbar to listen\n    this.dispatchEvent(new CustomEvent('debug-status-change', {\n      detail: { status },\n      bubbles: true,\n      composed: true,\n    }));\n  }\n\n  private applySnapshot(data: DebugSnapshot): void {\n    this.snapshot = data || {};\n    this.updateCounters();\n    // Dispatch event for toolbar to listen\n    this.dispatchEvent(new CustomEvent('debug-snapshot', {\n      detail: { snapshot: this.snapshot },\n      bubbles: true,\n      composed: true,\n    }));\n  }\n\n  private trimArray<T>(arr: T[], max: number): void {\n    while (arr.length > max) {\n      arr.shift();\n    }\n  }\n\n  // Rendering\n  private render(): void {\n    const counts = getCounts(this.snapshot);\n    const hasErrors = counts.errors > 0;\n    const hasSlowQueries = counts.slowQueries > 0;\n\n    // Hide FAB when toolbar is expanded\n    const hiddenClass = this.toolbarExpanded ? 'hidden' : '';\n\n    this.shadow.innerHTML = `\n      <style>${fabStyles}</style>\n      <div class=\"fab ${hiddenClass}\" data-status=\"${this.connectionStatus}\">\n        <span class=\"fab-status-dot\"></span>\n        <div class=\"fab-collapsed\">\n          <span class=\"fab-icon\">\n            <svg viewBox=\"0 0 24 24\" stroke-width=\"1.5\" fill=\"none\" xmlns=\"http://www.w3.org/2000/svg\">\n              <path fill-rule=\"evenodd\" clip-rule=\"evenodd\" d=\"M12 2.25C15.4148 2.25 18.157 4.93659 19.2445 8.53907L20.6646 7.82902C21.0351 7.64377 21.4856 7.79394 21.6709 8.16443C21.8561 8.53491 21.7059 8.98541 21.3355 9.17066L19.5919 10.0425C19.6958 10.6789 19.75 11.3341 19.75 12C19.75 12.4216 19.7283 12.839 19.6859 13.25H22C22.4142 13.25 22.75 13.5858 22.75 14C22.75 14.4142 22.4142 14.75 22 14.75H19.4347C19.2438 15.5659 18.9699 16.3431 18.6235 17.0629L20.5303 18.9697C20.8232 19.2626 20.8232 19.7374 20.5303 20.0303C20.2374 20.3232 19.7626 20.3232 19.4697 20.0303L17.8463 18.4069C16.4519 20.4331 14.3908 21.75 12 21.75C9.60921 21.75 7.54809 20.4331 6.15371 18.4069L4.53033 20.0303C4.23744 20.3232 3.76256 20.3232 3.46967 20.0303C3.17678 19.7374 3.17678 19.2626 3.46967 18.9697L5.37647 17.0629C5.03008 16.3431 4.7562 15.5659 4.56527 14.75H2C1.58579 14.75 1.25 14.4142 1.25 14C1.25 13.5858 1.58579 13.25 2 13.25H4.31407C4.27174 12.839 4.25 12.4216 4.25 12C4.25 11.3341 4.30423 10.6789 4.40814 10.0425L2.66455 9.17066C2.29406 8.98541 2.1439 8.53491 2.32914 8.16443C2.51438 7.79394 2.96488 7.64377 3.33537 7.82902L4.75547 8.53907C5.84297 4.93659 8.58522 2.25 12 2.25ZM11.25 19C11.25 19.4142 11.5858 19.75 12 19.75C12.4142 19.75 12.75 19.4142 12.75 19V9.73117C14.005 9.6696 15.2088 9.46632 16.1588 9.26042C16.5636 9.17268 16.8207 8.77339 16.7329 8.36857C16.6452 7.96376 16.2459 7.70672 15.8411 7.79445C14.7597 8.02883 13.3718 8.25 12 8.25C10.6281 8.25 9.24022 8.02883 8.15882 7.79445C7.75401 7.70672 7.35472 7.96376 7.26698 8.36857C7.17924 8.77339 7.43629 9.17268 7.8411 9.26042C8.79115 9.46632 9.99494 9.6696 11.25 9.73117V19Z\" fill=\"currentColor\"></path>\n            </svg>\n          </span>\n        </div>\n        <div class=\"fab-expanded\">\n          <div class=\"fab-counter ${counts.requests > 0 ? 'has-items' : ''}\">\n            <span class=\"counter-value\">${counts.requests}</span>\n            <span class=\"counter-label\">Req</span>\n          </div>\n          <div class=\"fab-counter ${counts.sql > 0 ? 'has-items' : ''} ${hasSlowQueries ? 'has-slow' : ''}\">\n            <span class=\"counter-value\">${counts.sql}</span>\n            <span class=\"counter-label\">SQL</span>\n          </div>\n          <div class=\"fab-counter ${counts.logs > 0 ? 'has-items' : ''} ${hasErrors ? 'has-errors' : ''}\">\n            <span class=\"counter-value\">${counts.logs}</span>\n            <span class=\"counter-label\">Logs</span>\n          </div>\n          ${hasErrors ? `\n            <div class=\"fab-counter has-errors\">\n              <span class=\"counter-value\">${counts.errors}</span>\n              <span class=\"counter-label\">Err</span>\n            </div>\n          ` : ''}\n        </div>\n      </div>\n    `;\n\n    this.attachEventListeners();\n  }\n\n  private updateCounters(): void {\n    const counts = getCounts(this.snapshot);\n    const hasErrors = counts.errors > 0;\n    const hasSlowQueries = counts.slowQueries > 0;\n\n    // Update request counter\n    const reqCounter = this.shadow.querySelector('.fab-counter:nth-child(1)');\n    if (reqCounter) {\n      const reqValue = reqCounter.querySelector('.counter-value');\n      if (reqValue) reqValue.textContent = String(counts.requests);\n      reqCounter.classList.toggle('has-items', counts.requests > 0);\n    }\n\n    // Update SQL counter\n    const sqlCounter = this.shadow.querySelector('.fab-counter:nth-child(2)');\n    if (sqlCounter) {\n      const sqlValue = sqlCounter.querySelector('.counter-value');\n      if (sqlValue) sqlValue.textContent = String(counts.sql);\n      sqlCounter.classList.toggle('has-items', counts.sql > 0);\n      sqlCounter.classList.toggle('has-slow', hasSlowQueries);\n    }\n\n    // Update logs counter\n    const logsCounter = this.shadow.querySelector('.fab-counter:nth-child(3)');\n    if (logsCounter) {\n      const logsValue = logsCounter.querySelector('.counter-value');\n      if (logsValue) logsValue.textContent = String(counts.logs);\n      logsCounter.classList.toggle('has-items', counts.logs > 0);\n      logsCounter.classList.toggle('has-errors', hasErrors);\n    }\n\n    // Update or add error counter\n    const errorCounter = this.shadow.querySelector('.fab-counter:nth-child(4)');\n    if (hasErrors) {\n      if (errorCounter) {\n        const errValue = errorCounter.querySelector('.counter-value');\n        if (errValue) errValue.textContent = String(counts.errors);\n      }\n    }\n  }\n\n  private updateConnectionStatus(): void {\n    const fab = this.shadow.querySelector('.fab');\n    if (fab) {\n      fab.setAttribute('data-status', this.connectionStatus);\n    }\n  }\n\n  private attachEventListeners(): void {\n    const fab = this.shadow.querySelector('.fab');\n    if (!fab) return;\n\n    // Click to expand toolbar\n    fab.addEventListener('click', () => {\n      this.toolbarExpanded = true;\n      this.saveState();\n      this.render();\n      this.dispatchEvent(new CustomEvent('debug-expand', {\n        detail: { expanded: true },\n        bubbles: true,\n        composed: true,\n      }));\n    });\n\n    // Hover state (for CSS transitions)\n    fab.addEventListener('mouseenter', () => {\n      this.isHovered = true;\n      fab.classList.add('is-hovered');\n    });\n\n    fab.addEventListener('mouseleave', () => {\n      this.isHovered = false;\n      fab.classList.remove('is-hovered');\n    });\n  }\n}\n\n// Register the custom element\nif (!customElements.get('debug-fab')) {\n  customElements.define('debug-fab', DebugFab);\n}\n","// Debug Manager\n// Coordinates the FAB and Toolbar components, sharing WebSocket connection and state\n\nimport { DebugFab } from './debug-fab.js';\nimport { DebugToolbar } from './debug-toolbar.js';\nimport type { DebugSnapshot } from './panel-renderers.js';\n\nexport interface DebugManagerOptions {\n  debugPath?: string;\n  panels?: string[];\n  slowThresholdMs?: number;\n  container?: HTMLElement;\n}\n\nexport class DebugManager {\n  private fab: DebugFab | null = null;\n  private toolbar: DebugToolbar | null = null;\n  private options: DebugManagerOptions;\n  private initialized = false;\n\n  constructor(options: DebugManagerOptions = {}) {\n    this.options = {\n      debugPath: '/admin/debug',\n      panels: ['requests', 'sql', 'logs', 'routes', 'config'],\n      slowThresholdMs: 50,\n      container: document.body,\n      ...options,\n    };\n  }\n\n  /**\n   * Initialize the debug UI with FAB and Toolbar\n   */\n  public init(): void {\n    if (this.initialized) return;\n    this.initialized = true;\n\n    this.createFab();\n    this.createToolbar();\n    this.wireEvents();\n  }\n\n  /**\n   * Destroy the debug UI\n   */\n  public destroy(): void {\n    if (this.fab) {\n      this.fab.remove();\n      this.fab = null;\n    }\n    if (this.toolbar) {\n      this.toolbar.remove();\n      this.toolbar = null;\n    }\n    this.initialized = false;\n  }\n\n  /**\n   * Expand the toolbar programmatically\n   */\n  public expand(): void {\n    if (!this.toolbar || !this.fab) return;\n    this.fab.setToolbarExpanded(true);\n    this.toolbar.setExpanded(true);\n  }\n\n  /**\n   * Collapse the toolbar programmatically\n   */\n  public collapse(): void {\n    if (!this.toolbar || !this.fab) return;\n    this.fab.setToolbarExpanded(false);\n    this.toolbar.setExpanded(false);\n  }\n\n  /**\n   * Toggle the toolbar state\n   */\n  public toggle(): void {\n    if (!this.toolbar) return;\n    if (this.toolbar.isExpanded()) {\n      this.collapse();\n    } else {\n      this.expand();\n    }\n  }\n\n  private createFab(): void {\n    this.fab = document.createElement('debug-fab') as DebugFab;\n    this.fab.setAttribute('debug-path', this.options.debugPath || '/admin/debug');\n    if (this.options.panels) {\n      this.fab.setAttribute('panels', this.options.panels.join(','));\n    }\n    this.options.container?.appendChild(this.fab);\n  }\n\n  private createToolbar(): void {\n    this.toolbar = document.createElement('debug-toolbar') as DebugToolbar;\n    this.toolbar.setAttribute('debug-path', this.options.debugPath || '/admin/debug');\n    this.toolbar.setAttribute('use-fab', 'true');\n    if (this.options.panels) {\n      this.toolbar.setAttribute('panels', this.options.panels.join(','));\n    }\n    if (this.options.slowThresholdMs) {\n      this.toolbar.setAttribute('slow-threshold-ms', String(this.options.slowThresholdMs));\n    }\n    this.options.container?.appendChild(this.toolbar);\n  }\n\n  private wireEvents(): void {\n    if (!this.fab || !this.toolbar) return;\n\n    // FAB dispatches expand event when clicked\n    this.fab.addEventListener('debug-expand', ((e: CustomEvent) => {\n      if (e.detail?.expanded && this.toolbar) {\n        // Share the FAB's stream with the toolbar\n        const stream = this.fab?.getStream();\n        if (stream) {\n          this.toolbar.setStream(stream);\n        }\n        // Share the snapshot\n        const snapshot = this.fab?.getSnapshot();\n        if (snapshot) {\n          this.toolbar.setSnapshot(snapshot);\n        }\n        // Share the connection status\n        const status = this.fab?.getConnectionStatus();\n        if (status) {\n          this.toolbar.setConnectionStatus(status);\n        }\n        this.toolbar.setExpanded(true);\n      }\n    }) as EventListener);\n\n    // FAB dispatches status changes\n    this.fab.addEventListener('debug-status-change', ((e: CustomEvent) => {\n      if (this.toolbar && e.detail?.status) {\n        this.toolbar.setConnectionStatus(e.detail.status);\n      }\n    }) as EventListener);\n\n    // FAB dispatches snapshot updates\n    this.fab.addEventListener('debug-snapshot', ((e: CustomEvent) => {\n      if (this.toolbar && e.detail?.snapshot) {\n        this.toolbar.setSnapshot(e.detail.snapshot);\n      }\n    }) as EventListener);\n\n    // Toolbar dispatches collapse event\n    this.toolbar.addEventListener('debug-expand', ((e: CustomEvent) => {\n      if (!e.detail?.expanded && this.fab) {\n        this.fab.setToolbarExpanded(false);\n      }\n    }) as EventListener);\n  }\n}\n\n/**\n * Initialize debug UI from window config or data attributes\n */\nexport function initDebugManager(): DebugManager | null {\n  // Check for window config\n  const windowConfig = (window as any).DEBUG_CONFIG;\n\n  // Check for existing debug element with config\n  const existingElement = document.querySelector('[data-debug-path]');\n\n  let options: DebugManagerOptions = {};\n\n  if (windowConfig) {\n    options = {\n      debugPath: windowConfig.debugPath || windowConfig.basePath,\n      panels: windowConfig.panels,\n      slowThresholdMs: windowConfig.slowThresholdMs,\n    };\n  } else if (existingElement) {\n    options = {\n      debugPath: existingElement.getAttribute('data-debug-path') || undefined,\n      panels: existingElement.getAttribute('data-panels')?.split(','),\n      slowThresholdMs: parseInt(existingElement.getAttribute('data-slow-threshold-ms') || '50', 10),\n    };\n  }\n\n  // Only initialize if we have a debug path configured\n  if (!options.debugPath && !windowConfig && !existingElement) {\n    return null;\n  }\n\n  const manager = new DebugManager(options);\n  manager.init();\n  return manager;\n}\n\n// Export for global access\n(window as any).DebugManager = DebugManager;\n(window as any).initDebugManager = initDebugManager;\n"],"names":["toolbarStyles","styles","renderPanel","panel","snapshot","slowThresholdMs","options","newestFirst","threshold","renderRequestsPanel","renderSQLPanel","renderLogsPanel","renderJSONPanel","renderRoutesPanel","renderJSErrorsPanel","renderCustomPanel","panelData","label","c","escapeHTML","getCounts","requests","sql","logs","jserrors","requestErrors","r","sqlErrors","q","logErrors","l","level","slowQueries","isSlowDuration","replPanelIDs","replPanelLabels","getDefaultToolbarPanels","toolbarPanels","panelRegistry","p","getPanelLabel","panelId","def","getPanelEventTypes","normalizeEventTypes","buildEventToPanel","mapping","eventType","normalizeReplCommands","value","commands","item","raw","command","description","tags","tag","aliases","alias","mutates","_DebugToolbar","e","event","stream","eventTypes","name","oldValue","newValue","expanded","status","stored","storedHeight","height","storedSortOrder","parsed","sortOrderObj","key","attr","DebugStream","response","data","snapshotKey","getSnapshotKey","currentData","newData","current","payload","defaultHandleEvent","arr","max","counts","panelTabs","count","expandedClass","hiddenClass","toolbarHeight","heightStyle","container","attachRequestDetailListeners","tab","summary","countEl","headerDot","summaryDot","summaryText","custom","t","btn","action","activeStream","replPanel","DebugReplPanel","resizeHandle","mouseEvent","touchEvent","startY","toolbar","handleMouseMove","handleTouchMove","handleEnd","currentY","delta","maxHeight","newHeight","attachExpandableRowListeners","attachCopyListeners","attachSortToggleListeners","attachSQLSelectionListeners","DebugToolbar","fabStyles","panelEventMap","defaultPanels","DebugFab","hasErrors","hasSlowQueries","reqCounter","reqValue","sqlCounter","sqlValue","logsCounter","logsValue","errorCounter","errValue","fab","DebugManager","initDebugManager","windowConfig","existingElement","manager"],"mappings":";;AAGO,MAAMA,IAAgB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;A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"}