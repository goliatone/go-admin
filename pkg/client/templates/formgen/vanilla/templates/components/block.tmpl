{% set sortable = sortable or false -%}
{% if not add_label %}{% set add_label = "Add block" %}{% endif -%}
{% if not empty_label %}{% set empty_label = "No blocks added yet." %}{% endif -%}

<div class="space-y-3" data-block-editor="true" data-block-field="{{ field.name }}"{% if sortable %} data-block-sortable="true"{% endif %}{% if config_json %} data-component-config='{{ config_json }}'{% endif %}>
    {% if blocks and blocks|length > 0 %}
    <div class="flex flex-wrap items-center gap-2">
        <select class="py-2 px-3 rounded-md border border-gray-200 text-sm bg-white text-gray-900 dark:bg-slate-900 dark:border-gray-700 dark:text-white" data-block-add-select="true"></select>
        <button type="button" class="py-2 px-3 rounded-md border border-gray-200 text-sm font-medium bg-white text-gray-900 hover:bg-gray-50 dark:bg-slate-900 dark:border-gray-700 dark:text-white dark:hover:bg-slate-800" data-block-add="true" data-block-add-label="{{ add_label }}">{{ add_label }}</button>
    </div>
    {% endif %}

    <div class="space-y-3" data-block-list="true"></div>

    <p class="text-xs text-gray-500 dark:text-gray-400" data-block-empty="true" data-block-empty-label="{{ empty_label }}">{{ empty_label }}</p>

    <input type="hidden" name="{{ field.name }}" data-block-output="true"{% if serialized %} value="{{ serialized }}"{% endif %}>

    {% if blocks and blocks|length > 0 %}
        {% for block in blocks %}
        <template data-block-template="true" data-block-type="{{ block.type }}"{% if block.label %} data-block-label="{{ block.label }}"{% endif %}{% if block.icon %} data-block-icon="{{ block.icon }}"{% endif %}{% if block.collapsed %} data-block-collapsed="true"{% endif %}{% if block.schema %} data-block-schema-version="{{ block.schema }}"{% endif %}>
            <div class="space-y-4" data-block-fields="true">
                {{ block.html|safe }}
            </div>
        </template>
        {% endfor %}
    {% else %}
        <p class="text-xs text-gray-500 dark:text-gray-400">Block editor requires block definitions.</p>
    {% endif %}
</div>
