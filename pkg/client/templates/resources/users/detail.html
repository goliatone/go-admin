{% extends "resources/shared/detail-base.html" %}

{% set avatar_type = "person" %}

{% block detail_head_extra %}
<link rel="stylesheet" href="{{ base_path }}/assets/dist/styles/widgets.css">
<link rel="stylesheet" href="{{ base_path }}/assets/dist/styles/activity.css">
{% endblock %}

{% block identity_title %}{{ resource_item.username|default:resource_item.display_name|default:resource_item.id }}{% endblock %}

{% block identity_subtitle %}
  {% if resource_item.email %}
    <p class="text-sm text-gray-500 truncate">{{ resource_item.email }}</p>
  {% endif %}
{% endblock %}

{% block content_data_attrs %}
  data-tab-panel-container
  data-panel="{{ resource }}"
  data-record-id="{{ resource_item.id }}"
  data-base-path="{{ base_path }}"
  data-api-base-path="{{ api_base_path }}"
  data-active-tab="{{ active_tab }}"
  data-default-tab="details"
{% endblock %}

{% block detail_content %}
  {% if tab_panel %}
    {% include "partials/tab-panel.html" with tab_panel=tab_panel fields=fields resource_item=resource_item resource_label=resource_label %}
  {% else %}
    <div class="max-w-4xl bg-white border border-gray-200 rounded-xl overflow-hidden">
      <div class="p-6">
        <div class="text-xs uppercase tracking-wider text-gray-500 mb-4 font-semibold">Details</div>
        <div class="grid grid-cols-2 gap-6">
          {% for field in fields %}
            <div class="flex flex-col">
              <div class="text-sm text-gray-500 mb-1">{{ field.label }}</div>
              <div class="text-base font-medium text-gray-900">{{ field.value|default:"-" }}</div>
            </div>
          {% endfor %}
        </div>
      </div>
    </div>
  {% endif %}

  {% if assigned_roles and assigned_roles|length > 0 %}
    <div class="mt-6 max-w-4xl bg-white border border-gray-200 rounded-xl overflow-hidden">
      <div class="p-6">
        <div class="text-xs uppercase tracking-wider text-gray-500 mb-4 font-semibold">Assigned Roles</div>
        <div class="flex flex-wrap gap-2">
          {% for role in assigned_roles %}
            <span class="inline-flex items-center gap-2 px-3 py-1.5 rounded-lg bg-purple-50 border border-purple-200 text-sm">
              <i class="iconoir-shield text-purple-600"></i>
              <span class="font-medium text-purple-800">{{ role.name|default:role.id }}</span>
              {% if role.role_key %}
                <span class="text-xs text-purple-500">{{ role.role_key }}</span>
              {% endif %}
            </span>
          {% endfor %}
        </div>
      </div>
    </div>
  {% endif %}
{% endblock %}

{% block detail_scripts %}
<script type="module">
  import { initTabsController } from '{{ base_path }}/assets/dist/tabs/index.js';
  initTabsController();
</script>
{% endblock %}
